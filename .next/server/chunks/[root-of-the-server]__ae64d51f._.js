module.exports=[18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,r,t)=>{r.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},31584,e=>{"use strict";var r=e.i(22493);class t{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this.setNotificationHandler(r.CancelledNotificationSchema,e=>{let r=this._requestHandlerAbortControllers.get(e.params.requestId);null==r||r.abort(e.params.reason)}),this.setNotificationHandler(r.ProgressNotificationSchema,e=>{this._onprogress(e)}),this.setRequestHandler(r.PingRequestSchema,e=>({}))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=e=>{this._onerror(e)},this._transport.onmessage=e=>{"method"in e?"id"in e?this._onrequest(e):this._onnotification(e):this._onresponse(e)},await this._transport.start()}_onclose(){var e;let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,null==(e=this.onclose)||e.call(this);let s=new r.McpError(r.ErrorCode.ConnectionClosed,"Connection closed");for(let e of t.values())e(s)}_onerror(e){var r;null==(r=this.onerror)||r.call(this,e)}_onnotification(e){var r;let t=null!=(r=this._notificationHandlers.get(e.method))?r:this.fallbackNotificationHandler;void 0!==t&&Promise.resolve().then(()=>t(e)).catch(e=>this._onerror(Error(`Uncaught error in notification handler: ${e}`)))}_onrequest(e){var t,s;let o=null!=(t=this._requestHandlers.get(e.method))?t:this.fallbackRequestHandler;if(void 0===o){null==(s=this._transport)||s.send({jsonrpc:"2.0",id:e.id,error:{code:r.ErrorCode.MethodNotFound,message:"Method not found"}}).catch(e=>this._onerror(Error(`Failed to send an error response: ${e}`)));return}let n=new AbortController;this._requestHandlerAbortControllers.set(e.id,n),Promise.resolve().then(()=>o(e,{signal:n.signal})).then(r=>{var t;if(!n.signal.aborted)return null==(t=this._transport)?void 0:t.send({result:r,jsonrpc:"2.0",id:e.id})},t=>{var s,o;if(!n.signal.aborted)return null==(s=this._transport)?void 0:s.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(t.code)?t.code:r.ErrorCode.InternalError,message:null!=(o=t.message)?o:"Internal error"}})}).catch(e=>this._onerror(Error(`Failed to send response: ${e}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progress:r,total:t,progressToken:s}=e.params,o=this._progressHandlers.get(Number(s));void 0===o?this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`)):o({progress:r,total:t})}_onresponse(e){let t=e.id,s=this._responseHandlers.get(Number(t));void 0===s?this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`)):(this._responseHandlers.delete(Number(t)),this._progressHandlers.delete(Number(t)),s("result"in e?e:new r.McpError(e.error.code,e.error.message,e.error.data)))}get transport(){return this._transport}async close(){var e;await (null==(e=this._transport)?void 0:e.close())}request(e,r,t){return new Promise((s,o)=>{var n,i,a;if(!this._transport)return void o(Error("Not connected"));(null==(n=this._options)?void 0:n.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),null==(i=null==t?void 0:t.signal)||i.throwIfAborted();let l=this._requestMessageId++,c={...e,jsonrpc:"2.0",id:l};(null==t?void 0:t.onprogress)&&(this._progressHandlers.set(l,t.onprogress),c.params={...e.params,_meta:{progressToken:l}}),this._responseHandlers.set(l,e=>{var n;if(null==(n=null==t?void 0:t.signal)||!n.aborted){if(e instanceof Error)return o(e);try{let t=r.parse(e.result);s(t)}catch(e){o(e)}}}),null==(a=null==t?void 0:t.signal)||a.addEventListener("abort",()=>{var e,r;let s=null==(e=null==t?void 0:t.signal)?void 0:e.reason;this._responseHandlers.delete(l),this._progressHandlers.delete(l),null==(r=this._transport)||r.send({jsonrpc:"2.0",method:"cancelled",params:{requestId:l,reason:String(s)}}),o(s)}),this._transport.send(c).catch(o)})}async notification(e){if(!this._transport)throw Error("Not connected");this.assertNotificationCapability(e.method);let r={...e,jsonrpc:"2.0"};await this._transport.send(r)}setRequestHandler(e,r){let t=e.shape.method.value;this.assertRequestHandlerCapability(t),this._requestHandlers.set(t,(t,s)=>Promise.resolve(r(e.parse(t),s)))}removeRequestHandler(e){this._requestHandlers.delete(e)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,t=>Promise.resolve(r(e.parse(t))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}class s extends t{constructor(e,r){super(r),this._clientInfo=e,this._capabilities=r.capabilities}assertCapability(e,r){var t;if(!(null==(t=this._serverCapabilities)?void 0:t[e]))throw Error(`Server does not support ${e} (required for ${r})`)}async connect(e){await super.connect(e);try{let e=await this.request({method:"initialize",params:{protocolVersion:r.LATEST_PROTOCOL_VERSION,capabilities:this._capabilities,clientInfo:this._clientInfo}},r.InitializeResultSchema);if(void 0===e)throw Error(`Server sent invalid initialize result: ${e}`);if(!r.SUPPORTED_PROTOCOL_VERSIONS.includes(e.protocolVersion))throw Error(`Server's protocol version is not supported: ${e.protocolVersion}`);this._serverCapabilities=e.capabilities,this._serverVersion=e.serverInfo,await this.notification({method:"notifications/initialized"})}catch(e){throw this.close(),e}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}assertCapabilityForMethod(e){var r,t,s,o,n;switch(e){case"logging/setLevel":if(!(null==(r=this._serverCapabilities)?void 0:r.logging))throw Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(null==(t=this._serverCapabilities)?void 0:t.prompts))throw Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(null==(s=this._serverCapabilities)?void 0:s.resources))throw Error(`Server does not support resources (required for ${e})`);if("resources/subscribe"===e&&!this._serverCapabilities.resources.subscribe)throw Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(null==(o=this._serverCapabilities)?void 0:o.tools))throw Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(null==(n=this._serverCapabilities)?void 0:n.prompts))throw Error(`Server does not support prompts (required for ${e})`)}}assertNotificationCapability(e){var r;if("notifications/roots/list_changed"===e&&!(null==(r=this._capabilities.roots)?void 0:r.listChanged))throw Error(`Client does not support roots list changed notifications (required for ${e})`)}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw Error(`Client does not support sampling capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw Error(`Client does not support roots capability (required for ${e})`)}}async ping(){return this.request({method:"ping"},r.EmptyResultSchema)}async complete(e,t){return this.request({method:"completion/complete",params:e},r.CompleteResultSchema,t)}async setLoggingLevel(e){return this.request({method:"logging/setLevel",params:{level:e}},r.EmptyResultSchema)}async getPrompt(e,t){return this.request({method:"prompts/get",params:e},r.GetPromptResultSchema,t)}async listPrompts(e,t){return this.request({method:"prompts/list",params:e},r.ListPromptsResultSchema,t)}async listResources(e,t){return this.request({method:"resources/list",params:e},r.ListResourcesResultSchema,t)}async listResourceTemplates(e,t){return this.request({method:"resources/templates/list",params:e},r.ListResourceTemplatesResultSchema,t)}async readResource(e,t){return this.request({method:"resources/read",params:e},r.ReadResourceResultSchema,t)}async subscribeResource(e){return this.request({method:"resources/subscribe",params:e},r.EmptyResultSchema)}async unsubscribeResource(e){return this.request({method:"resources/unsubscribe",params:e},r.EmptyResultSchema)}async callTool(e,t=r.CallToolResultSchema,s){return this.request({method:"tools/call",params:e},t,s)}async listTools(e,t){return this.request({method:"tools/list",params:e},r.ListToolsResultSchema,t)}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}e.s(["Client",()=>s],31584)},2913,e=>{"use strict";var r=e.i(22493);class t{constructor(e){this._url=e}start(){if(this._eventSource)throw Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,t)=>{this._eventSource=new EventSource(this._url.href),this._abortController=new AbortController,this._eventSource.onerror=e=>{var r;let s=Error(`SSE error: ${JSON.stringify(e)}`);t(s),null==(r=this.onerror)||r.call(this,s)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",r=>{var s;try{if(this._endpoint=new URL(r.data,this._url),this._endpoint.origin!==this._url.origin)throw Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(e){t(e),null==(s=this.onerror)||s.call(this,e),this.close();return}e()}),this._eventSource.onmessage=e=>{var t,s;let o;try{o=r.JSONRPCMessageSchema.parse(JSON.parse(e.data))}catch(e){null==(t=this.onerror)||t.call(this,e);return}null==(s=this.onmessage)||s.call(this,o)}})}async close(){var e,r,t;null==(e=this._abortController)||e.abort(),null==(r=this._eventSource)||r.close(),null==(t=this.onclose)||t.call(this)}async send(e){var r,t;if(!this._endpoint)throw Error("Not connected");try{let t=await fetch(this._endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:null==(r=this._abortController)?void 0:r.signal});if(!t.ok){let e=await t.text().catch(()=>null);throw Error(`Error POSTing to endpoint (HTTP ${t.status}): ${e}`)}}catch(e){throw null==(t=this.onerror)||t.call(this,e),e}}}e.s(["SSEClientTransport",()=>t])},74533,(e,r,t)=>{r.exports=e.x("node:child_process",()=>require("node:child_process"))},59639,(e,r,t)=>{r.exports=e.x("node:process",()=>require("node:process"))},97831,e=>{"use strict";var r=e.i(74533),t=e.i(59639),s=e.i(22493);class o{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){var e;if(!this._buffer)return null;let r=this._buffer.indexOf("\n");if(-1===r)return null;let t=this._buffer.toString("utf8",0,r);return this._buffer=this._buffer.subarray(r+1),e=t,s.JSONRPCMessageSchema.parse(JSON.parse(e))}clear(){this._buffer=void 0}}let n="win32"===t.default.platform?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function i(){let e={};for(let r of n){let s=t.default.env[r];void 0!==s&&(s.startsWith("()")||(e[r]=s))}return e}class a{constructor(e){this._abortController=new AbortController,this._readBuffer=new o,this._serverParams=e}async start(){if(this._process)throw Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,t)=>{var s,o,n,a,l,c;this._process=(0,r.spawn)(this._serverParams.command,null!=(s=this._serverParams.args)?s:[],{env:null!=(o=this._serverParams.env)?o:i(),stdio:["pipe","pipe",null!=(n=this._serverParams.stderr)?n:"inherit"],shell:!1,signal:this._abortController.signal}),this._process.on("error",e=>{var r,s;if("AbortError"===e.name){null==(r=this.onclose)||r.call(this);return}t(e),null==(s=this.onerror)||s.call(this,e)}),this._process.on("spawn",()=>{e()}),this._process.on("close",e=>{var r;this._process=void 0,null==(r=this.onclose)||r.call(this)}),null==(a=this._process.stdin)||a.on("error",e=>{var r;null==(r=this.onerror)||r.call(this,e)}),null==(l=this._process.stdout)||l.on("data",e=>{this._readBuffer.append(e),this.processReadBuffer()}),null==(c=this._process.stdout)||c.on("error",e=>{var r;null==(r=this.onerror)||r.call(this,e)})})}processReadBuffer(){for(var e,r;;)try{let r=this._readBuffer.readMessage();if(null===r)break;null==(e=this.onmessage)||e.call(this,r)}catch(e){null==(r=this.onerror)||r.call(this,e)}}async close(){this._abortController.abort(),this._process=void 0,this._readBuffer.clear()}send(e){return new Promise(r=>{var t;if(!(null==(t=this._process)?void 0:t.stdin))throw Error("Not connected");let s=JSON.stringify(e)+"\n";this._process.stdin.write(s)?r():this._process.stdin.once("drain",r)})}}e.s(["DEFAULT_INHERITED_ENV_VARS",0,n,"StdioClientTransport",()=>a,"getDefaultEnvironment",()=>i],97831)},14747,(e,r,t)=>{r.exports=e.x("path",()=>require("path"))},22734,(e,r,t)=>{r.exports=e.x("fs",()=>require("fs"))},69249,e=>{"use strict";var r=e.i(50820),t=e.i(14813),s=e.i(45637),o=e.i(54554),n=e.i(28638),i=e.i(63491),a=e.i(87089),l=e.i(92687),c=e.i(27486),u=e.i(90620),d=e.i(87386),p=e.i(39271),h=e.i(29558),f=e.i(95727),m=e.i(13230),v=e.i(17143),_=e.i(93695);e.i(59715);var g=e.i(26753),E=e.i(61056),b=e.i(22734),R=e.i(14747),w=e.i(31584),y=e.i(97831),S=e.i(2913);let C=R.default.join(process.cwd(),"data","mcp-configs","configs.json");async function x(e){try{let r=await b.promises.readFile(C,"utf-8");return JSON.parse(r).find(r=>r.id===e)}catch(e){if("ENOENT"===e.code)throw Error("配置文件不存在");throw e}}function P(){return globalThis.__mcpProxySessions||(globalThis.__mcpProxySessions=new Map),globalThis.__mcpProxySessions}async function T(e,r){console.log(`[Proxy Prompts] 创建临时会话，configId: ${e}`);let t=new w.Client({name:"mcp-proxy-server",version:"1.0.0"},{capabilities:{tools:{},prompts:{},resources:{}}}),s=r.connectionConfig||{},o=null;if("url"===r.connectionType&&s.url){let e=new URL(s.url);o=new S.SSEClientTransport(e)}else if("command"===r.connectionType&&s.command)o=new y.StdioClientTransport({command:s.command,args:s.args||[]});else if("script"===r.connectionType&&s.script){let e="string"==typeof s.script?JSON.parse(s.script):s.script,r=e.url||e.sse||e.server&&e.server.url;if(r)o=new S.SSEClientTransport(new URL(r));else throw Error("脚本中未找到有效的URL")}else throw Error(`不支持的连接类型: ${r.connectionType}`);if(!o)throw Error("无法创建传输层");await t.connect(o),console.log(`[Proxy Prompts] 临时会话连接成功，configId: ${e}`);let n=`temp_${e}_${Date.now()}`;return P().set(n,{configId:e,mcpClient:t,transport:o,messageQueue:[]}),t}async function q(e,{params:r}){try{let{configId:e}=r instanceof Promise?await r:r;if(!e)return E.NextResponse.json({success:!1,error:"缺少配置ID"},{status:400});let t=await x(e);if(!t)return E.NextResponse.json({success:!1,error:"配置不存在"},{status:404});let s=P(),o=null;for(let[r,t]of s.entries())if(t.configId===e&&t.mcpClient){o=t.mcpClient;break}if(!o)try{console.log(`[Proxy Prompts] 未找到现有会话，尝试创建临时会话，configId: ${e}`),o=await T(e,t)}catch(e){return console.error(`[Proxy Prompts] 创建临时会话失败:`,e),E.NextResponse.json({success:!1,error:"代理会话不存在，且无法创建临时会话",message:e.message},{status:500})}let n=await o.listPrompts();return E.NextResponse.json({success:!0,prompts:n.prompts||[]})}catch(e){if(console.error("[Proxy Prompts] 获取提示词列表失败:",e),-32601===e.code||e.message?.includes("Method not found"))return E.NextResponse.json({success:!0,prompts:[],message:"该 MCP 服务器不支持提示词功能"});return E.NextResponse.json({success:!1,error:"获取提示词列表失败",message:e.message},{status:500})}}e.s(["GET",()=>q],60904);var N=e.i(60904);let H=new r.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/proxy/[configId]/prompts/route",pathname:"/api/proxy/[configId]/prompts",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/new-flow/AINO/app/api/proxy/[configId]/prompts/route.ts",nextConfigOutput:"",userland:N}),{workAsyncStorage:O,workUnitAsyncStorage:A,serverHooks:I}=H;function M(){return(0,s.patchFetch)({workAsyncStorage:O,workUnitAsyncStorage:A})}async function $(e,r,s){H.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let E="/api/proxy/[configId]/prompts/route";E=E.replace(/\/index$/,"")||"/";let b=await H.prepare(e,r,{srcPage:E,multiZoneDraftMode:!1});if(!b)return r.statusCode=400,r.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:R,params:w,nextConfig:y,parsedUrl:S,isDraftMode:C,prerenderManifest:x,routerServerContext:P,isOnDemandRevalidate:T,revalidateOnlyGenerated:q,resolvedPathname:N,clientReferenceManifest:O,serverActionsManifest:A}=b,I=(0,l.normalizeAppPath)(E),M=!!(x.dynamicRoutes[I]||x.routes[N]),$=async()=>((null==P?void 0:P.render404)?await P.render404(e,r,S,!1):r.end("This page could not be found"),null);if(M&&!C){let e=!!x.routes[N],r=x.dynamicRoutes[I];if(r&&!1===r.fallback&&!e){if(y.experimental.adapterPath)return await $();throw new _.NoFallbackError}}let k=null;!M||H.isDev||C||(k="/index"===(k=N)?"/":k);let j=!0===H.isDev||!M,L=M&&!j;A&&O&&(0,i.setReferenceManifestsSingleton)({page:E,clientReferenceManifest:O,serverActionsManifest:A,serverModuleMap:(0,a.createServerModuleMap)({serverActionsManifest:A})});let U=e.method||"GET",D=(0,n.getTracer)(),F=D.getActiveScopeSpan(),V={params:w,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!y.experimental.authInterrupts},cacheComponents:!!y.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:y.cacheLife,waitUntil:s.waitUntil,onClose:e=>{r.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(r,t,s)=>H.onRequestError(e,r,s,P)},sharedContext:{buildId:R}},B=new c.NodeNextRequest(e),J=new c.NodeNextResponse(r),K=u.NextRequestAdapter.fromNodeNextRequest(B,(0,u.signalFromNodeResponse)(r));try{let i=async e=>H.handle(K,V).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let t=D.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=t.get("next.route");if(s){let r=`${U} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":r}),e.updateName(r)}else e.updateName(`${U} ${E}`)}),a=!!(0,o.getRequestMeta)(e,"minimalMode"),l=async o=>{var n,l;let c=async({previousCacheEntry:t})=>{try{if(!a&&T&&q&&!t)return r.statusCode=404,r.setHeader("x-nextjs-cache","REVALIDATED"),r.end("This page could not be found"),null;let n=await i(o);e.fetchMetrics=V.renderOpts.fetchMetrics;let l=V.renderOpts.pendingWaitUntil;l&&s.waitUntil&&(s.waitUntil(l),l=void 0);let c=V.renderOpts.collectedTags;if(!M)return await (0,h.sendResponse)(B,J,n,V.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),r=(0,f.toNodeOutgoingHttpHeaders)(n.headers);c&&(r[v.NEXT_CACHE_TAGS_HEADER]=c),!r["content-type"]&&e.type&&(r["content-type"]=e.type);let t=void 0!==V.renderOpts.collectedRevalidate&&!(V.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&V.renderOpts.collectedRevalidate,s=void 0===V.renderOpts.collectedExpire||V.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:V.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:r},cacheControl:{revalidate:t,expire:s}}}}catch(r){throw(null==t?void 0:t.isStale)&&await H.onRequestError(e,r,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:T})},P),r}},u=await H.handleResponse({req:e,nextConfig:y,cacheKey:k,routeKind:t.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:q,responseGenerator:c,waitUntil:s.waitUntil,isMinimalMode:a});if(!M)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});a||r.setHeader("x-nextjs-cache",T?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&r.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,f.fromNodeOutgoingHttpHeaders)(u.value.headers);return a&&M||d.delete(v.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||r.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,m.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(B,J,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};F?await l(F):await D.withPropagatedContext(e.headers,()=>D.trace(d.BaseServerSpan.handleRequest,{spanName:`${U} ${E}`,kind:n.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},l))}catch(r){if(r instanceof _.NoFallbackError||await H.onRequestError(e,r,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:T})}),M)throw r;return await (0,h.sendResponse)(B,J,new Response(null,{status:500})),null}}e.s(["handler",()=>$,"patchFetch",()=>M,"routeModule",()=>H,"serverHooks",()=>I,"workAsyncStorage",()=>O,"workUnitAsyncStorage",()=>A],69249)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ae64d51f._.js.map