"use strict";exports.id=658,exports.ids=[658],exports.modules={60658:(a,b,c)=>{c.d(b,{I:()=>p});var d=c(80742),e=c(93531),f=c(30311),g=c(84336),h=c(88810);let i=(0,c(3208).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var j=c(83119),k=c(33371),l=c(62670),m=c(49454),n=c(2799),o=c(66497);function p({onRegister:a,onLogin:b,className:c}){let p=(0,g.usePathname)(),[q,r]=(0,f.useState)(null),s=q?.titleColor?{color:q.titleColor}:void 0,t=q?.bodyColor?{color:q.bodyColor}:void 0,u=(0,f.useMemo)(()=>p?.startsWith("/en")?"en":"zh",[p]),v=(0,f.useMemo)(()=>{let a=q?.introTitle;return a?"string"==typeof a?a:a[u]||a.zh||a.en||null:null},[q,u]),w=(0,f.useMemo)(()=>{let a=q?.introText;return a?"string"==typeof a?a:a[u]||a.zh||a.en||null:null},[q,u]),[x,y]=(0,f.useState)("phone"),[z,A]=(0,f.useState)("+86"),[B,C]=(0,f.useState)(()=>{try{return new URLSearchParams("").get("phone")||""}catch{return""}}),[D,E]=(0,f.useState)(""),[F,G]=(0,f.useState)(""),[H,I]=(0,f.useState)(""),[J,K]=(0,f.useState)(!1),[L,M]=(0,f.useState)(!1),[N,O]=(0,f.useState)(!1),[P,Q]=(0,f.useState)(!1),[R,S]=(0,f.useState)({}),T=()=>{"phone"===x&&(()=>{let a={};return B||(a.phone="请输入手机号"),D||(a.code="请输入验证码"),S(a),0===Object.keys(a).length})()?y("verify"):"verify"===x?y("password"):"password"===x&&(()=>{let a={};return F?F.length<6&&(a.password="密码至少6位"):a.password="请输入密码",H?F!==H&&(a.confirmPassword="两次密码不一致"):a.confirmPassword="请确认密码",N||(a.agreeTerms="请同意用户协议和隐私政策"),S(a),0===Object.keys(a).length})()&&U()},U=async()=>{Q(!0);try{await new Promise(a=>setTimeout(a,1e3));let b=window.localStorage.getItem("APP_ID"),c=new URLSearchParams(window.location.search).get("appId"),d=b||process.env.NEXT_PUBLIC_DEFAULT_APP_ID||c||"";if(!d)return void alert("缺少应用ID，请通过预览链接附带 appId 或先写入 localStorage.APP_ID");let f=await e.A.post(`http://47.94.52.142:3007/api/application-users/register?applicationId=${d}`,{password:F,phone_number:B}),g=f.data?.data;a?.({phone:g.phone,countryCode:z,code:g.userId,password:F,confirmPassword:H,agreeTerms:N}),y("success")}catch(c){let a=c?.response?.data?.error||c?.response?.data?.message,b="string"==typeof a?a:"";console.error("注册失败:",b||c),b.includes("用户已注册")||b.includes("手机号已存在")?alert("该手机号已注册，请直接登录"):b.includes("缺少应用ID")?alert("缺少应用ID，请通过预览链接附带 appId 或先写入 localStorage.APP_ID"):b?alert(b):alert("注册失败，请稍后再试")}finally{Q(!1)}};return(0,d.jsx)("div",{className:"min-h-screen pb-24",children:(0,d.jsx)("div",{className:"pt-12",children:(0,d.jsx)("div",{className:"container mx-auto px-4",children:(0,d.jsxs)("div",{className:"max-w-sm mx-auto",children:["phone"===x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-2",style:s,children:v||("en"===u?"Sign up":"注册账号")}),(0,d.jsx)("p",{className:"text-muted-foreground",style:t,children:w||("en"===u?"Enter your phone number":"请输入您的手机号码")})]}),(0,d.jsxs)("div",{className:"mb-6 flex items-stretch gap-3 w-full",children:[(0,d.jsx)(m.d,{value:z,onChange:A,className:"shrink-0 w-28 sm:w-32"}),(0,d.jsx)(m.L,{value:B,onChange:a=>{C(a),R.phone&&S(a=>({...a,phone:void 0}))},error:R.phone,placeholder:"请输入手机号",className:"flex-1 min-w-0"})]}),(0,d.jsx)("div",{className:"mb-6",children:(0,d.jsx)(o.$,{type:"button",variant:"secondary",className:"w-full rounded-full h-11",disabled:!B,onClick:()=>y("verify"),children:"发送验证码"})}),(0,d.jsx)(o.$,{type:"button",onClick:T,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:"下一步"})]}),"verify"===x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"text-center mb-6",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-2",style:s,children:"输入验证码"}),(0,d.jsxs)("p",{className:"text-muted-foreground text-sm",style:t,children:["已发送至 ",z,B]})]}),(0,d.jsx)("div",{className:"mb-6",children:(0,d.jsx)(n.P,{value:D,onChange:a=>{E(a),R.code&&S(a=>({...a,code:void 0}))},error:R.code,onComplete:a=>E(a),size:"sm"})}),(0,d.jsx)("div",{className:"text-center mb-6",children:(0,d.jsx)(o.$,{type:"button",variant:"link",className:"text-sm",onClick:()=>y("phone"),children:"修改手机号"})}),(0,d.jsx)(o.$,{type:"button",onClick:T,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:"继续"})]}),"password"===x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-2",style:s,children:"设置密码"}),(0,d.jsx)("p",{className:"text-muted-foreground",style:t,children:"请设置您的登录密码"})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10",children:(0,d.jsx)(i,{className:"w-5 h-5 text-gray-400"})}),(0,d.jsx)("input",{type:J?"text":"password",value:F,onChange:a=>{G(a.target.value),R.password&&S(a=>({...a,password:void 0}))},placeholder:"请设置密码（至少6位）",className:(0,h.cn)("w-full pl-12 pr-12 py-4","bg-background border border-border","rounded-lg","text-foreground placeholder-muted-foreground","text-base font-medium","outline-none transition-all duration-300","focus:border-primary focus:bg-accent",R.password&&"border-red-300")}),(0,d.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>K(!J),className:"absolute right-4 top-1/2 transform -translate-y-1/2 z-10 h-auto w-auto p-1",children:J?(0,d.jsx)(j.A,{className:"w-5 h-5 text-muted-foreground"}):(0,d.jsx)(k.A,{className:"w-5 h-5 text-muted-foreground"})})]}),R.password&&(0,d.jsx)("div",{className:"mt-2 text-sm text-red-600",children:R.password})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10",children:(0,d.jsx)(i,{className:"w-5 h-5 text-gray-400"})}),(0,d.jsx)("input",{type:L?"text":"password",value:H,onChange:a=>{I(a.target.value),R.confirmPassword&&S(a=>({...a,confirmPassword:void 0}))},placeholder:"请再次输入密码",className:(0,h.cn)("w-full pl-12 pr-12 py-4","bg-background border border-border","rounded-lg","text-foreground placeholder-muted-foreground","text-base font-medium","outline-none transition-all duration-300","focus:border-primary focus:bg-accent",R.confirmPassword&&"border-red-300")}),(0,d.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>M(!L),className:"absolute right-4 top-1/2 transform -translate-y-1/2 z-10 h-auto w-auto p-1",children:L?(0,d.jsx)(j.A,{className:"w-5 h-5 text-muted-foreground"}):(0,d.jsx)(k.A,{className:"w-5 h-5 text-muted-foreground"})})]}),R.confirmPassword&&(0,d.jsx)("div",{className:"mt-2 text-sm text-red-600",children:R.confirmPassword})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("input",{type:"checkbox",checked:N,onChange:a=>O(a.target.checked),className:"sr-only"}),(0,d.jsx)("div",{className:(0,h.cn)("w-5 h-5 rounded border-2 flex items-center justify-center","transition-all duration-200",N?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-gray-400"),children:N&&(0,d.jsx)(l.A,{className:"w-3 h-3 text-white"})})]}),(0,d.jsxs)("span",{className:"text-sm text-gray-600 leading-relaxed",children:["我已阅读并同意",(0,d.jsx)("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mx-1",children:"《用户协议》"}),"和",(0,d.jsx)("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mx-1",children:"《隐私政策》"})]})]}),R.agreeTerms&&(0,d.jsx)("div",{className:"mt-2 text-sm text-red-600",children:R.agreeTerms})]}),(0,d.jsx)(o.$,{type:"button",onClick:T,disabled:P,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:P?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"注册中..."]}):"完成注册"})]}),"success"===x&&(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,d.jsx)(l.A,{className:"w-10 h-10 text-green-600"})}),(0,d.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"注册成功！"}),(0,d.jsx)("p",{className:"text-gray-600 mb-8",children:"欢迎加入我们，现在可以开始使用了"}),(0,d.jsx)(o.$,{type:"button",onClick:b,size:"lg",className:"w-full",children:"立即登录"})]})})]})})})})}}};