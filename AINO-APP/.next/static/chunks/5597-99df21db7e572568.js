"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5597],{25597:(e,t,s)=>{s.d(t,{S:()=>h});var l=s(89835),n=s(55931),a=s(12680),r=s(79588),o=s(15496),i=s(59445),d=s(32937),c=s(55098),u=s(89407),x=s(92475),m=s(58590);function h(e){let{onLogin:t,onRegister:s,onForgotPassword:h,className:p}=e,[b,f]=(0,n.useState)("phone"),[y,g]=(0,n.useState)("phone"),[j,v]=(0,n.useState)(""),[w,N]=(0,n.useState)(""),[k,C]=(0,n.useState)(""),[A,S]=(0,n.useState)(!1),[P,z]=(0,n.useState)(!1),[_,I]=(0,n.useState)(!1),[L,M]=(0,n.useState)({}),O=e=>{v(e),L.phone&&M(e=>({...e,phone:void 0}))},D=async()=>{if(!j)return void M(e=>({...e,phone:"请输入手机号"}));console.log("发送验证码到:",j),I(!0),g("verify")},E=async()=>{z(!0),M({});try{let e={};if(j||(e.phone="请输入手机号"),"phone"===b?w||(e.code="请输入验证码"):k||(e.password="请输入密码"),Object.keys(e).length>0)return void M(e);let s=window.localStorage.getItem("APPLICATION_CONFIG"),l=JSON.parse(s),n=null==l?void 0:l.id,r=await a.L.post("/api/modules/system/user/login?applicationId=".concat(n),{password:k,phone_number:j}),o=null==r?void 0:r.data;null==t||t(o)}catch(e){console.error("登录失败:",e),M(e=>({...e,..."password"===b?{password:"登录失败，请检查手机号或密码"}:{code:"登录失败，请检查验证码"}}))}finally{z(!1)}},F=(0,r.usePathname)(),[T,G]=(0,n.useState)(null);(0,n.useEffect)(()=>{try{let e=new URLSearchParams(window.location.search).get("authCfg");if(e){let t=JSON.parse(e);G(t);return}let t=window.localStorage.getItem("APP_AUTH_CONFIG");t&&G(JSON.parse(t))}catch(e){}},[]);let J=(0,n.useMemo)(()=>T&&Array.isArray(T.providers)?[{key:"phone",enabled:!0},...T.providers.filter(e=>e&&e.key&&["phone","wechat","bytedance","google","apple"].includes(e.key)).filter(e=>"phone"!==e.key)]:[{key:"phone",enabled:!0},{key:"wechat",enabled:!1},{key:"bytedance",enabled:!1},{key:"google",enabled:!1},{key:"apple",enabled:!1}],[T]),R=(null==T?void 0:T.titleColor)?{color:T.titleColor}:void 0,$=(null==T?void 0:T.bodyColor)?{color:T.bodyColor}:void 0,B=(0,n.useMemo)(()=>(null==F?void 0:F.startsWith("/en"))?"en":"zh",[F]),U=(0,n.useMemo)(()=>{let e=null==T?void 0:T.introTitle;return e?"string"==typeof e?e:e[B]||e.zh||e.en||null:null},[T,B]),V=(0,n.useMemo)(()=>{let e=null==T?void 0:T.introText;return e?"string"==typeof e?e:e[B]||e.zh||e.en||null:null},[T,B]),H=()=>{var e,t,s,n;return(0,l.jsxs)("div",{className:"flex items-center justify-center gap-6 pt-10",children:[(null==(e=J.find(e=>"wechat"===e.key))?void 0:e.enabled)&&(0,l.jsx)("button",{"aria-label":"wechat",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"微"}),(null==(t=J.find(e=>"bytedance"===e.key))?void 0:t.enabled)&&(0,l.jsx)("button",{"aria-label":"bytedance",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"字"}),(null==(s=J.find(e=>"google"===e.key))?void 0:s.enabled)&&(0,l.jsx)("button",{"aria-label":"google",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"G"}),(null==(n=J.find(e=>"apple"===e.key))?void 0:n.enabled)&&(0,l.jsx)("button",{"aria-label":"apple",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:""})]})};return(0,l.jsx)("div",{className:"min-h-screen pb-8",children:(0,l.jsx)("div",{className:"pt-6",children:(0,l.jsxs)("div",{className:"container mx-auto px-4",children:["phone"===y?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:R,children:U||("en"===B?"Sign in or register":"手机号登录或注册")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:$,children:V||("en"===B?"The code will be sent to your phone":"验证码将发送至你的手机")})]}),(0,l.jsx)("div",{className:"mb-5",children:(0,l.jsx)(c.L,{value:j,onChange:O,error:L.phone,placeholder:"请输入手机号"})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(x.$,{type:"button",variant:"secondary",className:"w-full rounded-full h-11",disabled:!j,onClick:D,children:"获取验证码"})}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{f("password"),g("password")},children:"使用密码登录"})}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-2",children:(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:text-blue-700 hover:underline font-medium",onClick:s,children:"en"===B?"Create Account":"创建账户"})}),H()]})}):null,"verify"===y?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-2",style:R,children:U||("en"===B?"Verify code":"输入验证码")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:$,children:V||("en"===B?"The code will be sent to your phone":"验证码将发送至你的手机")})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(u.P,{value:w,onChange:e=>{N(e),L.code&&M(e=>({...e,code:void 0}))},error:L.code,onComplete:e=>N(e),size:"sm"})}),(0,l.jsx)(x.$,{type:"button",onClick:E,disabled:P||w.length<4,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:P?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"继续中..."]}):"en"===B?"Continue":"继续"}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-4",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{f("password"),g("password")},children:"使用密码登录"})}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-2",children:(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:text-blue-700 hover:underline font-medium",onClick:s,children:"en"===B?"Create Account":"创建账户"})}),H()]})}):null,"password"===y?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:R,children:U||("en"===B?"Sign in with password":"手机号 + 密码登录")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:$,children:V||("en"===B?"Enter your phone and password":"请输入你的手机号与密码")})]}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)(c.L,{value:j,onChange:O,error:L.phone,placeholder:"请输入手机号"})}),(0,l.jsx)("div",{className:"mb-1",children:(0,l.jsxs)("div",{className:"w-full max-w-sm",children:[(0,l.jsx)("label",{htmlFor:"password",className:"block text-xs font-medium text-gray-600 mb-1.5",children:"密码"}),(0,l.jsxs)("div",{className:(0,o.cn)("group bg-white/70 backdrop-blur-lg rounded-xl shadow-sm border border-white/80 transition-all duration-300","focus-within:ring-2 focus-within:shadow-lg","flex items-center"),children:[(0,l.jsx)("input",{id:"password",type:A?"text":"password",className:"flex-1 px-3.5 py-2.5 bg-transparent outline-none text-gray-900 placeholder:text-gray-400 text-sm",placeholder:"请输入密码",value:k,onChange:e=>{C(e.target.value),L.password&&M(e=>({...e,password:void 0}))}}),(0,l.jsx)("button",{type:"button","aria-label":A?"隐藏密码":"显示密码",className:"pr-3 text-gray-500 hover:text-gray-700",onClick:()=>S(e=>!e),children:A?(0,l.jsx)(i.A,{className:"w-4 h-4"}):(0,l.jsx)(d.A,{className:"w-4 h-4"})})]}),L.password?(0,l.jsx)("p",{className:"mt-1 text-xs text-red-500",children:L.password}):null]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{f("phone"),g("phone")},children:"使用验证码登录"})}),(0,l.jsx)("div",{className:"text-sm",children:(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:underline",onClick:h,children:"忘记密码？"})})]}),(0,l.jsx)(x.$,{type:"button",onClick:E,disabled:P||!j||!k,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:P?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"登录中..."]}):"登录"}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-4",children:(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:text-blue-700 hover:underline font-medium",onClick:s,children:"en"===B?"Create Account":"创建账户"})}),H()]})}):null]})})})}},49101:(e,t,s)=>{s.d(t,{A:()=>l});let l=(0,s(51894).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},89407:(e,t,s)=>{s.d(t,{P:()=>d});var l=s(89835),n=s(55931),a=s(15496),r=s(43251),o=s(77908),i=s(49101);function d(e){let{value:t,onChange:s,onComplete:d,length:c=6,className:u,disabled:x=!1,error:m,success:h=!1,autoFocus:p=!0,size:b="md"}=e,[f,y]=(0,n.useState)(null),g=(0,n.useRef)([]),[j,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(p&&g.current[0]){var e;null==(e=g.current[0])||e.focus()}},[p]),(0,n.useEffect)(()=>{t.length===c?(v(!0),null==d||d(t)):v(!1)},[t,c,d]);let w=(e,l)=>{let n=t.split("");if(n[e]=l,s(n.join("").slice(0,c)),l&&e<c-1){var a;null==(a=g.current[e+1])||a.focus()}},N=e=>{var t;e.preventDefault();let l=e.clipboardData.getData("text").replace(/\D/g,"").slice(0,c);s(l);let n=Math.min(l.length,c-1);null==(t=g.current[n])||t.focus()},k=(()=>{switch(b){case"sm":return{box:"w-10 h-10 text-base",icon:"w-4 h-4",gap:"space-x-2"};case"lg":return{box:"w-14 h-14 text-2xl",icon:"w-6 h-6",gap:"space-x-4"};default:return{box:"w-12 h-12 text-lg",icon:"w-5 h-5",gap:"space-x-3"}}})();return(0,l.jsxs)("div",{className:(0,a.cn)("relative",u),children:[(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-1 mb-4",children:[(0,l.jsx)("span",{className:(0,a.cn)(k.icon),children:m?(0,l.jsx)(r.A,{className:"w-5 h-5 text-red-500"}):h||j?(0,l.jsx)(o.A,{className:"w-5 h-5 text-green-500"}):(0,l.jsx)(i.A,{className:"w-5 h-5 text-gray-400"})}),(0,l.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"验证码"})]}),(0,l.jsx)("div",{className:(0,a.cn)("flex justify-center",k.gap),children:Array.from({length:c},(e,s)=>(0,l.jsx)("input",{ref:e=>{g.current[s]=e},type:"text",inputMode:"numeric",maxLength:1,value:t[s]||"",onChange:e=>((e,t)=>{let s=t.replace(/\D/g,"");s.length>1?w(e,s.slice(-1)):w(e,s)})(s,e.target.value),onKeyDown:e=>{var l,n,a;"Backspace"===e.key?!t[s]&&s>0?null==(l=g.current[s-1])||l.focus():w(s,""):"ArrowLeft"===e.key&&s>0?null==(n=g.current[s-1])||n.focus():"ArrowRight"===e.key&&s<c-1&&(null==(a=g.current[s+1])||a.focus())},onPaste:N,onFocus:()=>y(s),onBlur:()=>y(null),disabled:x,className:(0,a.cn)("text-center font-bold",k.box,"bg-background border border-border","rounded-lg","transition-all duration-300 ease-in-out","focus:outline-none focus:ring-2 focus:ring-primary/50","focus:border-primary focus:bg-accent","disabled:opacity-50 disabled:cursor-not-allowed",m&&"border-red-300 bg-red-50/20",h&&"border-green-300 bg-green-50/20",f===s&&"scale-105 shadow-lg")},s))}),m&&(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-center space-x-1",children:[(0,l.jsx)(r.A,{className:"w-4 h-4 text-red-500"}),(0,l.jsx)("span",{className:"text-sm text-red-600",children:m})]}),h&&!m&&(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-center space-x-1",children:[(0,l.jsx)(o.A,{className:"w-4 h-4 text-green-500"}),(0,l.jsx)("span",{className:"text-sm text-green-600",children:"验证码正确"})]}),j&&!m&&!h&&(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-center space-x-1",children:[(0,l.jsx)(o.A,{className:"w-4 h-4 text-blue-500"}),(0,l.jsx)("span",{className:"text-sm text-blue-600",children:"验证码输入完成"})]})]})}s(92475)}}]);