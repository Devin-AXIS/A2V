"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5597],{25597:(e,t,s)=>{s.d(t,{S:()=>x});var l=s(89835),n=s(77455),a=s(55931),r=s(79588),o=s(15496),i=s(59445),d=s(32937),c=s(55098),u=s(89407),h=s(92475),m=s(58590);function x(e){let{onLogin:t,onRegister:s,onForgotPassword:x,className:p}=e,[b,y]=(0,a.useState)("phone"),[f,v]=(0,a.useState)("phone"),[w,j]=(0,a.useState)(""),[g,N]=(0,a.useState)(""),[k,C]=(0,a.useState)(""),[S,z]=(0,a.useState)(!1),[P,A]=(0,a.useState)(!1),[_,I]=(0,a.useState)(!1),[O,T]=(0,a.useState)({}),F=e=>{j(e),O.phone&&T(e=>({...e,phone:void 0}))},E=async()=>{if(!w)return void T(e=>({...e,phone:"请输入手机号"}));console.log("发送验证码到:",w),I(!0),v("verify")},L=async()=>{A(!0),T({});try{var e;let s={};if(w||(s.phone="请输入手机号"),"phone"===b?g||(s.code="请输入验证码"):k||(s.password="请输入密码"),Object.keys(s).length>0)return void T(s);let l=window.localStorage.getItem("APPLICATION_CONFIG"),a=JSON.parse(l),r=null==a?void 0:a.id,o=null==(e=(await n.A.post("http://47.94.52.142:3007/api/modules/system/user/login?applicationId=".concat(r),{password:k,phone_number:w})).data)?void 0:e.data;null==t||t(o)}catch(e){console.error("登录失败:",e),T(e=>({...e,..."password"===b?{password:"登录失败，请检查手机号或密码"}:{code:"登录失败，请检查验证码"}}))}finally{A(!1)}},M=(0,r.usePathname)(),[G,J]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{let e=new URLSearchParams(window.location.search).get("authCfg");if(e){let t=JSON.parse(e);J(t);return}let t=window.localStorage.getItem("APP_AUTH_CONFIG");t&&J(JSON.parse(t))}catch(e){}},[]);let $=(0,a.useMemo)(()=>G&&Array.isArray(G.providers)?[{key:"phone",enabled:!0},...G.providers.filter(e=>e&&e.key&&["phone","wechat","bytedance","google","apple"].includes(e.key)).filter(e=>"phone"!==e.key)]:[{key:"phone",enabled:!0},{key:"wechat",enabled:!1},{key:"bytedance",enabled:!1},{key:"google",enabled:!1},{key:"apple",enabled:!1}],[G]),U=(null==G?void 0:G.titleColor)?{color:G.titleColor}:void 0,H=(null==G?void 0:G.bodyColor)?{color:G.bodyColor}:void 0,R=(0,a.useMemo)(()=>(null==M?void 0:M.startsWith("/en"))?"en":"zh",[M]),V=(0,a.useMemo)(()=>{let e=null==G?void 0:G.introTitle;return e?"string"==typeof e?e:e[R]||e.zh||e.en||null:null},[G,R]),W=(0,a.useMemo)(()=>{let e=null==G?void 0:G.introText;return e?"string"==typeof e?e:e[R]||e.zh||e.en||null:null},[G,R]),q=()=>{var e,t,s,n;return(0,l.jsxs)("div",{className:"flex items-center justify-center gap-6 pt-10",children:[(null==(e=$.find(e=>"wechat"===e.key))?void 0:e.enabled)&&(0,l.jsx)("button",{"aria-label":"wechat",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"微"}),(null==(t=$.find(e=>"bytedance"===e.key))?void 0:t.enabled)&&(0,l.jsx)("button",{"aria-label":"bytedance",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"字"}),(null==(s=$.find(e=>"google"===e.key))?void 0:s.enabled)&&(0,l.jsx)("button",{"aria-label":"google",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:"G"}),(null==(n=$.find(e=>"apple"===e.key))?void 0:n.enabled)&&(0,l.jsx)("button",{"aria-label":"apple",className:"size-14 rounded-full bg-white/80 shadow border flex items-center justify-center",children:""})]})};return(0,l.jsx)("div",{className:"min-h-screen pb-8",children:(0,l.jsx)("div",{className:"pt-6",children:(0,l.jsxs)("div",{className:"container mx-auto px-4",children:["phone"===f?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:U,children:V||("en"===R?"Sign in or register":"手机号登录或注册")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:H,children:W||("en"===R?"The code will be sent to your phone":"验证码将发送至你的手机")})]}),(0,l.jsx)("div",{className:"mb-5",children:(0,l.jsx)(c.L,{value:w,onChange:F,error:O.phone,placeholder:"请输入手机号"})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(h.$,{type:"button",variant:"secondary",className:"w-full rounded-full h-11",disabled:!w,onClick:E,children:"获取验证码"})}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{y("password"),v("password")},children:"使用密码登录"})}),q()]})}):null,"verify"===f?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-2",style:U,children:V||("en"===R?"Verify code":"输入验证码")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:H,children:W||("en"===R?"The code will be sent to your phone":"验证码将发送至你的手机")})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(u.P,{value:g,onChange:e=>{N(e),O.code&&T(e=>({...e,code:void 0}))},error:O.code,onComplete:e=>N(e),size:"sm"})}),(0,l.jsx)(h.$,{type:"button",onClick:L,disabled:P||g.length<4,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:P?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"继续中..."]}):"en"===R?"Continue":"继续"}),(0,l.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-4",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{y("password"),v("password")},children:"使用密码登录"})}),q()]})}):null,"password"===f?(0,l.jsx)(m.P.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto pt-8 pb-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:U,children:V||("en"===R?"Sign in with password":"手机号 + 密码登录")}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",style:H,children:W||("en"===R?"Enter your phone and password":"请输入你的手机号与密码")})]}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)(c.L,{value:w,onChange:F,error:O.phone,placeholder:"请输入手机号"})}),(0,l.jsx)("div",{className:"mb-1",children:(0,l.jsxs)("div",{className:"w-full max-w-sm",children:[(0,l.jsx)("label",{htmlFor:"password",className:"block text-xs font-medium text-gray-600 mb-1.5",children:"密码"}),(0,l.jsxs)("div",{className:(0,o.cn)("group bg-white/70 backdrop-blur-lg rounded-xl shadow-sm border border-white/80 transition-all duration-300","focus-within:ring-2 focus-within:shadow-lg","flex items-center"),children:[(0,l.jsx)("input",{id:"password",type:S?"text":"password",className:"flex-1 px-3.5 py-2.5 bg-transparent outline-none text-gray-900 placeholder:text-gray-400 text-sm",placeholder:"请输入密码",value:k,onChange:e=>{C(e.target.value),O.password&&T(e=>({...e,password:void 0}))}}),(0,l.jsx)("button",{type:"button","aria-label":S?"隐藏密码":"显示密码",className:"pr-3 text-gray-500 hover:text-gray-700",onClick:()=>z(e=>!e),children:S?(0,l.jsx)(i.A,{className:"w-4 h-4"}):(0,l.jsx)(d.A,{className:"w-4 h-4"})})]}),O.password?(0,l.jsx)("p",{className:"mt-1 text-xs text-red-500",children:O.password}):null]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,l.jsx)("button",{type:"button",className:"underline underline-offset-4 hover:text-foreground",onClick:()=>{y("phone"),v("phone")},children:"使用验证码登录"})}),(0,l.jsx)("div",{className:"text-sm",children:(0,l.jsx)("button",{type:"button",className:"text-blue-600 hover:underline",onClick:x,children:"忘记密码？"})})]}),(0,l.jsx)(h.$,{type:"button",onClick:L,disabled:P||!w||!k,size:"lg",className:"w-full rounded-full h-12 text-base",variant:"default",children:P?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"登录中..."]}):"登录"}),q()]})}):null]})})})}}}]);