(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{16938:e=>{e.exports={style:{fontFamily:"'GeistMono', ui-monospace, SFMono-Regular, Roboto Mono, Menlo, Monaco, Liberation Mono, DejaVu Sans Mono, Courier New, monospace"},className:"__className_f910ec",variable:"__variable_f910ec"}},18418:e=>{e.exports={style:{fontFamily:"'GeistSans', 'GeistSans Fallback'"},className:"__className_fb8f2c",variable:"__variable_fb8f2c"}},24680:()=>{},47044:(e,t,o)=>{Promise.resolve().then(o.bind(o,79514)),Promise.resolve().then(o.t.bind(o,18418,23)),Promise.resolve().then(o.t.bind(o,16938,23)),Promise.resolve().then(o.t.bind(o,24680,23))},79514:(e,t,o)=>{"use strict";o.d(t,{A:()=>l,AuthProvider:()=>i});var a=o(55931);let n=(0,a.createContext)(void 0),r={USER:"aino_user",AUTH_TOKEN:"aino_auth_token",APP_ID:"CURRENT_APP_ID"},s=[{id:"1",phone:"13800138000",name:"iPollo 用户",avatar:"/generic-user-avatar.png",points:2323,followers:22,following:334,posts:3434,createdAt:new Date().toISOString()},{id:"2",phone:"13900139000",name:"测试用户",avatar:"/generic-user-avatar.png",points:1500,followers:15,following:200,posts:100,createdAt:new Date().toISOString()}];function i(e){let{children:t}=e,[o,i]=(0,a.useState)({user:null,isAuthenticated:!1,isLoading:!0});(0,a.useEffect)(()=>{try{let e=localStorage.getItem(r.USER),t=localStorage.getItem(r.AUTH_TOKEN);if(e&&t){let t=JSON.parse(e);i({user:t,isAuthenticated:!0,isLoading:!1})}else i({user:null,isAuthenticated:!1,isLoading:!1})}catch(e){console.error("初始化认证状态失败:",e),i({user:null,isAuthenticated:!1,isLoading:!1})}},[]);let l=async e=>{try{let t;i(e=>({...e,isLoading:!0})),await new Promise(e=>setTimeout(e,1e3));let o={};Object.keys(e).forEach(t=>{t.indexOf("followers")>-1&&(o.followers=e[t]),t.indexOf("following")>-1&&(o.following=e[t]),t.indexOf("posts")>-1&&(o.posts=e[t]),t.indexOf("points")>-1&&(o.points=e[t])}),console.log(o),t={id:Date.now().toString(),phone:e.phone,name:e.profile.name,avatar:e.profile.avatar,points:o.points||0,followers:o.followers||0,following:o.following||0,posts:o.posts||0,createdAt:new Date().toISOString()},s.push(t);let a="mock_token_".concat(Date.now());{localStorage.setItem(r.USER,JSON.stringify(t)),localStorage.setItem(r.AUTH_TOKEN,a);let e=localStorage.getItem(r.APP_ID);e&&(localStorage.setItem("".concat(r.USER,":").concat(e),JSON.stringify(t)),localStorage.setItem("".concat(r.AUTH_TOKEN,":").concat(e),a))}return i({user:t,isAuthenticated:!0,isLoading:!1}),!0}catch(e){return console.error("登录失败:",e),i(e=>({...e,isLoading:!1})),!1}},c=async e=>{try{if(i(e=>({...e,isLoading:!0})),await new Promise(e=>setTimeout(e,1500)),s.find(t=>t.phone===e.phone))throw Error("该手机号已注册");let t={id:Date.now().toString(),phone:e.phone,name:"用户".concat(e.phone.slice(-4)),avatar:"/generic-user-avatar.png",points:100,followers:0,following:0,posts:0,createdAt:new Date().toISOString()};s.push(t);let o="mock_token_".concat(Date.now());{localStorage.setItem(r.USER,JSON.stringify(t)),localStorage.setItem(r.AUTH_TOKEN,o);let e=localStorage.getItem(r.APP_ID);e&&(localStorage.setItem("".concat(r.USER,":").concat(e),JSON.stringify(t)),localStorage.setItem("".concat(r.AUTH_TOKEN,":").concat(e),o))}return i({user:t,isAuthenticated:!0,isLoading:!1}),!0}catch(e){return console.error("注册失败:",e),i(e=>({...e,isLoading:!1})),!1}},g={...o,login:l,register:c,logout:()=>{localStorage.removeItem(r.USER),localStorage.removeItem(r.AUTH_TOKEN),i({user:null,isAuthenticated:!1,isLoading:!1})},updateUser:e=>{if(o.user){let t={...o.user,...e};i(e=>({...e,user:t})),localStorage.setItem(r.USER,JSON.stringify(t))}}};return a.createElement(n.Provider,{value:g},t)}function l(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[881,6965,9900,7341,7358],()=>e(e.s=47044)),_N_E=e.O()}]);