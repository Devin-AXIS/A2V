(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{11798:(e,t,o)=>{Promise.resolve().then(o.bind(o,79514)),Promise.resolve().then(o.bind(o,22841)),Promise.resolve().then(o.t.bind(o,18418,23)),Promise.resolve().then(o.t.bind(o,16938,23)),Promise.resolve().then(o.t.bind(o,24680,23))},16938:e=>{e.exports={style:{fontFamily:"'GeistMono', ui-monospace, SFMono-Regular, Roboto Mono, Menlo, Monaco, Liberation Mono, DejaVu Sans Mono, Courier New, monospace"},className:"__className_f910ec",variable:"__variable_f910ec"}},18418:e=>{e.exports={style:{fontFamily:"'GeistSans', 'GeistSans Fallback'"},className:"__className_fb8f2c",variable:"__variable_fb8f2c"}},22841:(e,t,o)=>{"use strict";o.d(t,{FavoritesProvider:()=>i,r:()=>s});var r=o(89835),a=o(55931);let n=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[o,i]=(0,a.useState)([]),[s,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{u(!0);{let e=localStorage.getItem("aino-likes"),t=localStorage.getItem("aino-favorites");if(e)try{i(JSON.parse(e))}catch(e){console.error("Failed to parse saved likes:",e)}if(t)try{l(JSON.parse(t))}catch(e){console.error("Failed to parse saved favorites:",e)}}},[]),(0,r.jsx)(n.Provider,{value:{likedItems:o,favoritedItems:s,isLiked:e=>o.some(t=>t.url===e),isFavorited:e=>s.some(t=>t.url===e),toggleLike:e=>{let t={...e,type:"like",timestamp:Date.now()};i(o=>{var r;let a;return r=a=o.find(t=>t.url===e.url)?o.filter(t=>t.url!==e.url):[t,...o],localStorage.setItem("aino-likes",JSON.stringify(r)),a})},toggleFavorite:e=>{let t={...e,type:"favorite",timestamp:Date.now()};l(o=>{var r;let a;return r=a=o.find(t=>t.url===e.url)?o.filter(t=>t.url!==e.url):[t,...o],localStorage.setItem("aino-favorites",JSON.stringify(r)),a})},getLikedCount:()=>o.length,getFavoritedCount:()=>s.length},children:t})}function s(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useFavorites must be used within a FavoritesProvider");return e}},24680:()=>{},79514:(e,t,o)=>{"use strict";o.d(t,{A:()=>l,AuthProvider:()=>s});var r=o(55931);let a=(0,r.createContext)(void 0),n={USER:"aino_user",AUTH_TOKEN:"aino_auth_token",APP_ID:"CURRENT_APP_ID"},i=[];function s(e){let{children:t}=e,[o,s]=(0,r.useState)({user:null,isAuthenticated:!1,isLoading:!0});(0,r.useEffect)(()=>{try{let e=localStorage.getItem(n.USER),t=localStorage.getItem(n.AUTH_TOKEN);if(e&&t){let t=JSON.parse(e);s({user:t,isAuthenticated:!0,isLoading:!1})}else s({user:null,isAuthenticated:!1,isLoading:!1})}catch(e){console.error("初始化认证状态失败:",e),s({user:null,isAuthenticated:!1,isLoading:!1})}},[]);let l=async e=>{try{var t,o;let r;s(e=>({...e,isLoading:!0})),await new Promise(e=>setTimeout(e,1e3));let a={};Object.keys(e).forEach(t=>{t.indexOf("followers")>-1&&(a.followers=e[t]),t.indexOf("following")>-1&&(a.following=e[t]),t.indexOf("posts")>-1&&(a.posts=e[t]),t.indexOf("points")>-1&&(a.points=e[t])}),r={id:Date.now().toString(),phone:e.phone,name:e.name,avatar:e.avatar,points:a.points||0,followers:a.followers||0,following:a.following||0,posts:a.posts||0,createdAt:new Date().toISOString(),extends:{...e}},i.push(r);let l=null==r||null==(t=r.extends)?void 0:t.token;null==r||null==(o=r.extends)||delete o.token;{localStorage.setItem(n.USER,JSON.stringify(r)),localStorage.setItem(n.AUTH_TOKEN,l);let e=localStorage.getItem(n.APP_ID);e&&(localStorage.setItem("".concat(n.USER,":").concat(e),JSON.stringify(r)),localStorage.setItem("".concat(n.AUTH_TOKEN,":").concat(e),l))}return s({user:r,isAuthenticated:!0,isLoading:!1}),!0}catch(e){return console.error("登录失败:",e),s(e=>({...e,isLoading:!1})),!1}},c=async e=>{try{if(s(e=>({...e,isLoading:!0})),i.find(t=>t.phone===e.phone))throw Error("该手机号已注册");let t={id:Date.now().toString(),phone:e.phone,name:e.name||"用户".concat(e.phone.slice(-4)),avatar:"/generic-user-avatar.png",points:100,followers:0,following:0,posts:0,createdAt:new Date().toISOString()};i.push(t);let o="mock_token_".concat(Date.now());{localStorage.setItem(n.USER,JSON.stringify(t)),localStorage.setItem(n.AUTH_TOKEN,o);let e=localStorage.getItem(n.APP_ID);e&&(localStorage.setItem("".concat(n.USER,":").concat(e),JSON.stringify(t)),localStorage.setItem("".concat(n.AUTH_TOKEN,":").concat(e),o))}return s({user:t,isAuthenticated:!0,isLoading:!1}),!0}catch(e){return console.error("注册失败:",e),s(e=>({...e,isLoading:!1})),!1}},u={...o,login:l,register:c,logout:()=>{localStorage.removeItem(n.USER),localStorage.removeItem(n.AUTH_TOKEN),s({user:null,isAuthenticated:!1,isLoading:!1})},updateUser:e=>{if(o.user){let t={...o.user,...e};s(e=>({...e,user:t})),localStorage.setItem(n.USER,JSON.stringify(t))}}};return r.createElement(a.Provider,{value:u},t)}function l(){let e=(0,r.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[881,6965,9900,7341,7358],()=>e(e.s=11798)),_N_E=e.O()}]);