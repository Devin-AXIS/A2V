(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3340],{6768:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var l=a(89835),r=a(55931),i=a(79588),n=a(33378),s=a(92475),o=a(17409),c=a(26077),h=a(6195);function u(){let e=(0,i.useParams)();(0,i.useSearchParams)();let t=(0,i.useRouter)(),a=new URLSearchParams(window.location.search),u=a.get("appId");window.localStorage.setItem("APP_ID",u||"");let d=a.get("origin")||a.get("parentOrigin")||"*",f=a.get("data");if(f)try{let e=JSON.parse(f);window.localStorage.setItem("PREVIEW_SELECTED_DATA",JSON.stringify(e))}catch(e){window.localStorage.setItem("PREVIEW_SELECTED_DATA_RAW",f)}let[g,m]=(0,r.useState)(!0),[p,y]=(0,r.useState)(null),[A,v]=(0,r.useState)(null),x=(0,r.useMemo)(()=>(0,h.CV)({targetOrigin:d,channel:u||void 0}),[d,u]),b=e.locale||"zh",N=e.id;(0,r.useEffect)(()=>{(0,c.a)()},[]),(0,r.useEffect)(()=>{let e=(0,h.zU)(x);return x.post("aino:ready",{appId:u,id:N,locale:b}),()=>{"function"==typeof e&&e()}},[x,u,N,b]),(0,r.useEffect)(()=>{let e=!1;return async function(){m(!0),y(null);try{let l=await fetch("http://47.94.52.142:3007/api/preview-manifests/".concat(N)),r=await l.json();if(!l.ok||!(null==r?void 0:r.success))throw Error((null==r?void 0:r.message)||"failed");if(!e){var t,a;let e=(null==(t=r.data)?void 0:t.manifest)||{};try{(null==e||null==(a=e.app)?void 0:a.appKey)&&localStorage.setItem("CURRENT_APP_ID",String(e.app.appKey))}catch(e){}v(e);try{x.post("aino:manifest",{manifest:e})}catch(e){}}}catch(t){e||y((null==t?void 0:t.message)||"error")}finally{e||m(!1)}}(),()=>{e=!0}},[N]),(0,r.useEffect)(()=>{if(p)try{x.post("aino:error",{message:p})}catch(e){}},[p,x]);let[w,S]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(A)try{var e,t,a,l,r;let i=(null==A||null==(t=A.pages)||null==(e=t.home)?void 0:e.category)||"workspace",n="dynamic_page_layout_".concat(i,"_").concat(b),s=localStorage.getItem(n);if(s)try{let e=JSON.parse(s),t=Array.isArray(null==e?void 0:e.cards)?e.cards.length:0;if(t>0){let a=e.cards.filter(e=>"mobile-navigation"!==((null==e?void 0:e.type)||e));if(a.length!==t){let t={...e,cards:a,updatedAt:Date.now()};localStorage.setItem(n,JSON.stringify(t)),S(e=>e+1)}}}catch(e){}else{let e={cards:((null==A||null==(l=A.pages)||null==(a=l.home)?void 0:a.cardsDefault)&&A.pages.home.cardsDefault.length>0?A.pages.home.cardsDefault:[]).map(e=>({type:e})),themes:{},updatedAt:Date.now()};localStorage.setItem(n,JSON.stringify(e)),S(e=>e+1)}try{let e=(null==A||null==(r=A.app)?void 0:r.bottomNav)||[],t=Array.isArray(e)?e.map(e=>{let t=e.route||"/";return"/me"===t&&(t="/profile"),{href:t,label:e.label||e.key,iconName:e.icon}}):[];localStorage.setItem("CURRENT_APP_NAV_ITEMS",JSON.stringify(t))}catch(e){}}catch(e){}},[A,b]);let _=(0,r.useMemo)(()=>{var e,t;let a=(null==A||null==(t=A.pages)||null==(e=t.home)?void 0:e.category)||"workspace";return"string"==typeof a?a:"workspace"},[A]);return g?(0,l.jsx)("main",{className:"min-h-[100dvh] flex items-center justify-center text-muted-foreground",children:"Loading..."}):p?(0,l.jsxs)("main",{className:"min-h-[100dvh] flex flex-col items-center justify-center gap-3",children:[(0,l.jsx)("div",{className:"text-sm text-red-600",children:p}),(0,l.jsx)(s.$,{variant:"outline",onClick:()=>t.refresh(),children:"Retry"})]}):(0,l.jsxs)("main",{className:"min-h-[100dvh] bg-transparent",children:[(0,l.jsx)(n.M3,{category:_,locale:b,layout:"mobile"},w),(0,l.jsx)(o.BottomNavigation,{})]})}},13391:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(51894).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},17409:(e,t,a)=>{"use strict";a.d(t,{BottomNavigation:()=>b});var l=a(89835),r=a(79588),i=a(75123),n=a.n(i),s=a(35749),o=a(13391),c=a(92126),h=a(79644),u=a(42039),d=a(77796),f=a(97909),g=a(59213),m=a(8892),p=a(70368),y=a(92475),A=a(96037),v=a(41657),x=a(55931);function b(e){let{dict:t,items:a}=e,i=(0,r.usePathname)(),{theme:b}=(0,v.b)(),N=i.split("/")[1],w=i.endsWith("/chat"),S=(0,x.useMemo)(()=>!function(e){if(!e.startsWith("#"))return!1;let t=Number.parseInt(e.substring(1),16);return .2126*(t>>16&255)+.7152*(t>>8&255)+.0722*((0|t)&255)<128}(b.background)?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.1)",[b.background]);if(w)return null;let _=t||{browseComponents:"组件",dashboard:"仪表板",chat:"AI",search:"搜索",profile:"我的"},E=[{href:"/",label:_.browseComponents,icon:s.A},{href:"/dashboard",label:_.dashboard,icon:o.A},{href:"/chat",label:_.chat,icon:c.A},{href:"/search",label:_.search,icon:h.A},{href:"/profile",label:_.profile,icon:u.A}],I=i.includes("/preview/")||i.includes("/app/"),k=[];if(a&&a.length>0)k=a;else try{{let e=localStorage.getItem("APPLICATION_CONFIG"),t=JSON.parse(e);if(e){var j,C,P;let e=Array.isArray(null==t||null==(P=t.config)||null==(C=P.clientManifest)||null==(j=C.app)?void 0:j.bottomNav)?t.config.clientManifest.app.bottomNav:[];e.length>0&&(k=e.filter(e=>(null==e?void 0:e.visible)!==!1).map(e=>{var t,a,l;return{href:e.route||"/",label:(null==(t=e.label)?void 0:t[N])||(null==(a=e.label)?void 0:a.zh)||(null==(l=e.label)?void 0:l.en)||e.id||"",iconName:e.icon||"grid"}}))}if(0===k.length){let e=localStorage.getItem("CURRENT_APP_NAV_ITEMS");if(e){let t=JSON.parse(e);Array.isArray(t)&&t.length>0&&(k=t.filter(e=>e&&!1!==e.visible).map(e=>{let t=e.route||e.href||"/";return"/me"===t&&(t="/profile"),{href:t,label:e.label||e.key||"",iconName:e.icon||e.iconName}}))}}}}catch(e){}if(0!==k.length||I||(k=E),0===k.length)return null;let O={home:d.A,user:u.A,profile:u.A,search:h.A,dashboard:o.A,grid:s.A,menu:s.A,chat:c.A,message:c.A,settings:f.A,bell:g.A,star:m.A,heart:p.A},R=localStorage.getItem("QUERY_STRING");return(0,l.jsx)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40",children:(0,l.jsx)(A.AppCard,{className:"px-4 py-1",children:(0,l.jsx)("div",{className:"flex items-center space-x-2 md:space-x-3",children:k.map(e=>{var t;let{href:a,icon:r,iconName:o,label:c}=e,h="/".concat(N).concat("/"===a?"":a).concat(R),u=i===h||"/"===a&&i==="/".concat(N),d=null!=(t=null!=r?r:o?O[o]:void 0)?t:s.A;return(0,l.jsx)(n(),{href:h,children:(0,l.jsxs)(y.$,{variant:"ghost",className:"rounded-2xl w-12 h-12 flex flex-col items-center justify-center transition-all duration-300 group",style:{backgroundColor:u?S:"transparent"},children:[(0,l.jsx)(d,{className:"w-6 h-6 transition-colors",style:{color:b.fontColor,opacity:u?1:.7}}),(0,l.jsx)("span",{className:"sr-only",children:c})]})},c)})})})})}},18358:(e,t,a)=>{Promise.resolve().then(a.bind(a,6768))},35749:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(51894).A)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])},92126:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(51894).A)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])}},e=>{e.O(0,[3739,8290,5022,8244,5123,3660,8607,4730,3419,7455,6396,3031,6037,3953,9770,721,7020,9300,9900,7341,7358],()=>e(e.s=18358)),_N_E=e.O()}]);