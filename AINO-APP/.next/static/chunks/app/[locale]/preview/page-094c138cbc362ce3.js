(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9318],{11614:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var l=a(89835),r=a(55931),o=a(79588),n=a(33378),i=a(34745),s=a(92475),c=a(17409),d=a(65794),u=a(6195),h=a(12680);function f(){let e=(0,o.useParams)(),t=(0,o.useSearchParams)(),a=(0,o.useRouter)(),[f,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!f){try{let l=window.localStorage.getItem("QUERY_STRING");if(!l)return void g(!0);let r=l.startsWith("?")?l.slice(1):l,o=new URLSearchParams(r);if(0==[...o.keys()].length)return void g(!0);let n=new URLSearchParams(t.toString()),i=!1;if(o.forEach((e,t)=>{n.get(t)!==e&&(n.set(t,e),i=!0)}),i){let t=e.locale||"zh";n.toString();let r="/".concat(t,"/preview").concat(l);a.replace(r)}}catch(e){}g(!0)}},[t,e,a,f]);let p=(0,r.useMemo)(()=>new URLSearchParams(window.location.search),[]),m=p.get("appId"),y=p.get("origin")||p.get("parentOrigin")||"*",v=p.get("data");(0,r.useEffect)(()=>{if(window.localStorage.setItem("APP_ID",m||""),v)try{let e=JSON.parse(v);window.localStorage.setItem("PREVIEW_SELECTED_DATA",JSON.stringify(e))}catch(e){window.localStorage.setItem("PREVIEW_SELECTED_DATA_RAW",v)}},[m,v]);let[w,b]=(0,r.useState)(!0),[A,N]=(0,r.useState)(null),[x,S]=(0,r.useState)(null),I=(0,r.useMemo)(()=>(0,u.CV)({targetOrigin:y,channel:m||void 0}),[y,m]),E=p.get("device")||"mobile",_=e.locale||"zh",k=p.get("previewId"),j=p.get("cfgId");(0,r.useEffect)(()=>{(0,d.a)()},[]),(0,r.useEffect)(()=>{let e=(0,u.zU)(I);return I.post("aino:ready",{appId:m,id:k,locale:_}),()=>{"function"==typeof e&&e()}},[I,m,k,_]),(0,r.useEffect)(()=>{let e=!1;return async function(){b(!0),N(null);try{var t,a;let l={};if(j){let e=await h.L.get("/api/page-configs/".concat(encodeURIComponent(j)));if(!(null==e?void 0:e.success))throw Error((null==e?void 0:e.message)||"failed to load page config");let t=e.data||e;l={app:{appKey:m||"default",defaultLanguage:_,locale:_,theme:"default",bottomNav:[{key:"home",label:"zh"===_?"首页":"Home",route:"/preview"},{key:"me",label:"zh"===_?"我的":"Me",route:"/profile"}]},pages:{home:{category:"workspace",...t}}}}else if(k){let e=await h.L.get("/api/preview-manifests/".concat(k));if(!(null==e?void 0:e.success))throw Error((null==e?void 0:e.message)||"failed");l=(null==(t=e.data)?void 0:t.manifest)||{}}else throw Error("No previewId or cfgId provided");if(!e){try{(null==l||null==(a=l.app)?void 0:a.appKey)&&localStorage.setItem("CURRENT_APP_ID",String(l.app.appKey))}catch(e){}S(l);try{I.post("aino:manifest",{manifest:l})}catch(e){}}}catch(t){e||N((null==t?void 0:t.message)||"error")}finally{e||b(!1)}}(),()=>{e=!0}},[k,j,m,_]),(0,r.useEffect)(()=>{if(A)try{I.post("aino:error",{message:A})}catch(e){}},[A,I]);let[P,C]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(x)try{var e,t,a,l,r;let o=(null==x||null==(t=x.pages)||null==(e=t.home)?void 0:e.category)||"workspace",n="dynamic_page_layout_".concat(o,"_").concat(_),i=localStorage.getItem(n);if(i)try{let e=JSON.parse(i),t=Array.isArray(null==e?void 0:e.cards)?e.cards.length:0;if(t>0){let a=e.cards.filter(e=>"mobile-navigation"!==((null==e?void 0:e.type)||e));if(a.length!==t){let t={...e,cards:a,updatedAt:Date.now()};localStorage.setItem(n,JSON.stringify(t)),C(e=>e+1)}}}catch(e){}else{let e={cards:((null==x||null==(l=x.pages)||null==(a=l.home)?void 0:a.cardsDefault)&&x.pages.home.cardsDefault.length>0?x.pages.home.cardsDefault:[]).map(e=>({type:e})),themes:{},updatedAt:Date.now()};localStorage.setItem(n,JSON.stringify(e)),C(e=>e+1)}try{let e=(null==x||null==(r=x.app)?void 0:r.bottomNav)||[],t=Array.isArray(e)?e.map(e=>{let t=e.route||"/";return"/me"===t&&(t="/profile"),{href:t,label:e.label||e.key,iconName:e.icon}}):[];localStorage.setItem("CURRENT_APP_NAV_ITEMS",JSON.stringify(t))}catch(e){}}catch(e){}},[x,_]);let R=(0,r.useMemo)(()=>{var e,t;let a=(null==x||null==(t=x.pages)||null==(e=t.home)?void 0:e.category)||"workspace";return"string"==typeof a?a:"workspace"},[x]);return w?(0,l.jsx)("main",{className:"min-h-[100dvh] flex items-center justify-center text-muted-foreground",children:"Loading..."}):A?(0,l.jsxs)("main",{className:"min-h-[100dvh] flex flex-col items-center justify-center gap-3",children:[(0,l.jsx)("div",{className:"text-sm text-red-600",children:A}),(0,l.jsx)(s.$,{variant:"outline",onClick:()=>a.refresh(),children:"Retry"})]}):"pc"===E?(0,l.jsx)("main",{className:"min-h-screen bg-transparent",children:(0,l.jsx)(i.PCDynamicPageComponent,{category:R,locale:_,layout:"pc"},P)}):(0,l.jsxs)("main",{className:"min-h-[100dvh] bg-transparent",children:[(0,l.jsx)(n.M3,{category:R,locale:_,layout:"mobile"},P),(0,l.jsx)(c.BottomNavigation,{})]})}function g(){return(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)("main",{className:"min-h-[100dvh] flex items-center justify-center text-muted-foreground",children:"Loading..."}),children:(0,l.jsx)(f,{})})}},13391:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(51894).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},17409:(e,t,a)=>{"use strict";a.d(t,{BottomNavigation:()=>w});var l=a(89835),r=a(79588),o=a(35749),n=a(13391),i=a(92126),s=a(79644),c=a(42039),d=a(77796),u=a(97909),h=a(59213),f=a(8892),g=a(70368),p=a(92475),m=a(96037),y=a(41657),v=a(55931);function w(e){let{dict:t,items:a}=e,w=(0,r.usePathname)(),{theme:b}=(0,y.b)(),A=w.split("/")[1],N=w.endsWith("/chat"),x=(0,v.useMemo)(()=>!function(e){if(!e.startsWith("#"))return!1;let t=Number.parseInt(e.substring(1),16);return .2126*(t>>16&255)+.7152*(t>>8&255)+.0722*((0|t)&255)<128}(b.background)?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.1)",[b.background]);if(N)return null;let S=t||{browseComponents:"组件",dashboard:"仪表板",chat:"AI",search:"搜索",profile:"我的"},I=[{href:"/",label:S.browseComponents,icon:o.A},{href:"/dashboard",label:S.dashboard,icon:n.A},{href:"/chat",label:S.chat,icon:i.A},{href:"/search",label:S.search,icon:s.A},{href:"/profile",label:S.profile,icon:c.A}],E=w.includes("/preview/")||w.includes("/app/"),_=[];if(a&&a.length>0)_=a;else try{{let e=localStorage.getItem("APPLICATION_CONFIG");if(e){var k,j,P;let t=JSON.parse(e),a=Array.isArray(null==t||null==(P=t.config)||null==(j=P.clientManifest)||null==(k=j.app)?void 0:k.bottomNav)?t.config.clientManifest.app.bottomNav:[];a.length>0&&(_=a.filter(e=>(null==e?void 0:e.visible)!==!1).map(e=>{var t,a,l;return{href:e.route||"/",label:(null==(t=e.label)?void 0:t[A])||(null==(a=e.label)?void 0:a.zh)||(null==(l=e.label)?void 0:l.en)||e.id||"",iconName:e.icon||"grid"}}))}if(0===_.length){let e=localStorage.getItem("CURRENT_APP_NAV_ITEMS");if(e){let t=JSON.parse(e);Array.isArray(t)&&t.length>0&&(_=t.filter(e=>e&&!1!==e.visible).map(e=>{let t=e.route||e.href||"/";return"/me"===t&&(t="/profile"),{href:t,label:e.label||e.key||"",iconName:e.icon||e.iconName}}))}}}}catch(e){}if(0!==_.length||E||(_=I),0===_.length)return null;let C=_.find(e=>"/profile"===e.href);_[1]={href:"/jobs",iconName:"grid",label:""},_.push(C);let R={home:d.A,user:c.A,profile:c.A,search:s.A,dashboard:n.A,grid:o.A,menu:o.A,chat:i.A,message:i.A,settings:u.A,bell:h.A,star:f.A,heart:g.A},L=localStorage.getItem("QUERY_STRING");return(0,l.jsx)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40",children:(0,l.jsx)(m.AppCard,{className:"px-4 py-1",children:(0,l.jsx)("div",{className:"flex items-center space-x-2 md:space-x-3",children:_.map((e,t)=>{var a;let{href:r,icon:n,iconName:i,label:s}=e,c="/".concat(A).concat("/"===r?"":r);if("/preview"===r){let e=new URLSearchParams(window.location.search),t=e.get("cfgId"),a=e.get("previewId"),l=e.get("appId"),r=window.localStorage.getItem("MAIN_PATH");c=t?"/".concat(A,"/preview?cfgId=").concat(t,"&device=mobile&isEdite=true"):a&&l?"/".concat(A,"/preview?previewId=").concat(a,"&device=mobile&appId=").concat(l):r||"/".concat(A)}else c+=L||"";let d=w===c||"/"===r&&w==="/".concat(A),u=null!=(a=null!=n?n:i?R[i]:void 0)?a:o.A;return(0,l.jsxs)(p.$,{onClick:()=>{window.location.href=c},variant:"ghost",className:"rounded-2xl w-12 h-12 flex flex-col items-center justify-center transition-all duration-300 group",style:{backgroundColor:d?x:"transparent"},children:[(0,l.jsx)(u,{className:"w-6 h-6 transition-colors",style:{color:b.fontColor,opacity:d?1:.7}}),(0,l.jsx)("span",{className:"sr-only",children:s})]})})})})})}},30132:(e,t,a)=>{Promise.resolve().then(a.bind(a,11614))},92126:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(51894).A)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])}},e=>{e.O(0,[6416,8290,5022,6497,69,7938,1390,7455,4755,3031,6037,7414,7746,721,3378,5144,4745,9900,7341,7358],()=>e(e.s=30132)),_N_E=e.O()}]);