(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5451],{7504:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8892:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},30301:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},34745:(e,t,a)=>{"use strict";a.d(t,{PCDynamicPageComponent:()=>H});var r=a(89835),s=a(55931),l=a(68232),n=a(84212),o=a(97909),i=a(30301),c=a(8892),d=a(46393),h=a(70368),u=a(58812),m=a(19453),x=a(26941),y=a(9716),f=a(7504),p=a(35749),g=a(15496),w=a(93974),v=a(61165),j=a(96037),M=a(60267),N=a(92475),b=a(15764),A=a(27426),k=a(91603),S=a(61138);function z(e){let{onResize:t,direction:a,onResizeStart:l,onResizeEnd:n}=e,[o,i]=(0,s.useState)(!1),[c,d]=(0,s.useState)({x:0,y:0});return(0,s.useEffect)(()=>{if(!o)return;let e=e=>{t(e.clientX-c.x,e.clientY-c.y)},a=()=>{i(!1),null==n||n()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",a),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",a)}},[o,c,t]),(0,r.jsx)("div",{className:(0,g.cn)((()=>{switch(a){case"se":return"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize bg-primary/20 hover:bg-primary/40 rounded-tl-lg";case"e":return"absolute top-1/2 right-0 w-2 h-8 -translate-y-1/2 cursor-e-resize bg-primary/20 hover:bg-primary/40 rounded-l-lg";case"s":return"absolute bottom-0 left-1/2 w-8 h-2 -translate-x-1/2 cursor-s-resize bg-primary/20 hover:bg-primary/40 rounded-t-lg";default:return""}})(),"z-50 pointer-events-auto"),onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),i(!0),d({x:e.clientX,y:e.clientY}),null==l||l()}})}function E(e){let{card:t,isEditing:a,onRemove:n,onResize:o,onScale:i,gridSize:c=120,layoutMode:d="freeform"}=e,[h,u]=(0,s.useState)(!1),m=(0,s.useRef)(null),[x,y]=(0,s.useState)(null),{attributes:f,listeners:p,setNodeRef:w,transform:v,isDragging:j}=(0,A.PM)({id:t.id,disabled:!a||h}),M=t.layout.scale||1,b="freeform"===d?Math.max(1,Math.round(t.layout.w)):t.layout.w*c-8,k="freeform"===d?Math.max(1,Math.round(t.layout.h)):t.layout.h*c-8,S=(0,s.useRef)(null),E=(e,t)=>(0,s.isValidElement)(e)?(0,s.cloneElement)(e,{id:t,"data-theme-key":t}):e,C={transform:v?"translate3d(".concat(v.x,"px, ").concat(v.y,"px, 0)"):void 0,position:"absolute",left:"freeform"===d?t.layout.x:t.layout.x*c,top:"freeform"===d?t.layout.y:t.layout.y*c,width:h&&x?x.w:b,height:h&&x?x.h:k,minWidth:"freeform"===d?260:2*c-8,minHeight:"freeform"===d?180:2*c-8,zIndex:j?1e3:1,opacity:+!j,willChange:"transform",transition:j?"none":void 0,touchAction:"none"};(0,s.useEffect)(()=>{if(!S.current||h)return;let e=0,a=()=>{if(!S.current)return;let e=S.current.getBoundingClientRect();if("freeform"!==d){let a=Math.max(1,Math.round(e.width)),r=Math.max(1,Math.round(e.height)),s=Math.max(2,Math.ceil((a+8)/c)),l=Math.max(2,Math.ceil((r+8)/c));(s!==t.layout.w||l!==t.layout.h)&&o(t.id,s,l)}},r=new ResizeObserver(()=>{e=requestAnimationFrame(a)});return r.observe(S.current),a(),()=>{e&&cancelAnimationFrame(e),r.disconnect()}},[t.id,t.layout.w,t.layout.h,c,o,d,M,h]);let P=(e,t)=>{let a=m.current;if(a)if("freeform"===d)y({w:Math.max(260,Math.round(a.baseW+e)),h:Math.max(180,Math.round(a.baseH+t))});else{let r=a.baseW*c-8,s=a.baseH*c-8;y({w:Math.max(2*c-8,Math.round(r+e)),h:Math.max(2*c-8,Math.round(s+t))})}};return(0,r.jsxs)("div",{ref:w,style:C,className:(0,g.cn)("group rounded-lg border-2 border-transparent",a&&"hover:shadow-lg",j&&"border-primary/50"),children:[a&&(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 h-6 z-50 cursor-move pointer-events-auto",...f,...p}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"absolute -top-12 left-0 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-10 bg-white rounded-lg shadow-lg p-1",children:[(0,r.jsx)(N.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e=>{e.stopPropagation(),n(t.id)},children:(0,r.jsx)(l.A,{className:"w-4 h-4"})}),(0,r.jsxs)(N.$,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs",onClick:e=>{e.stopPropagation();let a=1===t.layout.w?2:2===t.layout.w?3:1,r=1===t.layout.h?2:2===t.layout.h?3:1;o(t.id,a,r)},children:[t.layout.w,"\xd7",t.layout.h]}),(0,r.jsxs)(N.$,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs",onClick:e=>{var a;e.stopPropagation(),a=.5===M?1:1===M?1.5:1.5===M?2:.5,i(t.id,Math.max(.5,Math.min(2,a)))},children:[Math.round(100*M),"%"]})]}),(0,r.jsx)(z,{direction:"se",onResize:P,onResizeStart:()=>{u(!0),m.current={baseW:"freeform"===d?b:t.layout.w,baseH:"freeform"===d?k:t.layout.h},y({w:"freeform"===d?b:t.layout.w*c-8,h:"freeform"===d?k:t.layout.h*c-8})},onResizeEnd:()=>{if(u(!1),m.current=null,x)if("freeform"===d)o(t.id,x.w,x.h);else{let e=Math.max(2,Math.round((x.w+8)/c)),a=Math.max(2,Math.round((x.h+8)/c));o(t.id,e,a)}y(null)}}),(0,r.jsx)(z,{direction:"e",onResize:e=>P(e,0),onResizeStart:()=>{u(!0),m.current={baseW:"freeform"===d?b:t.layout.w,baseH:"freeform"===d?k:t.layout.h},y({w:"freeform"===d?b:t.layout.w*c-8,h:"freeform"===d?k:t.layout.h*c-8})},onResizeEnd:()=>{if(u(!1),m.current=null,x)if("freeform"===d)o(t.id,x.w,k);else{let e=Math.max(2,Math.round((x.w+8)/c)),a=t.layout.h;o(t.id,e,a)}y(null)}}),(0,r.jsx)(z,{direction:"s",onResize:e=>P(0,e),onResizeStart:()=>{u(!0),m.current={baseW:"freeform"===d?b:t.layout.w,baseH:"freeform"===d?k:t.layout.h},y({w:"freeform"===d?b:t.layout.w*c-8,h:"freeform"===d?k:t.layout.h*c-8})},onResizeEnd:()=>{if(u(!1),m.current=null,x)if("freeform"===d)o(t.id,b,x.h);else{let e=t.layout.w,a=Math.max(2,Math.round((x.h+8)/c));o(t.id,e,a)}y(null)}})]}),"freeform"===d?(0,r.jsx)("div",{ref:S,className:"rounded-lg",style:{width:"100%",height:"100%",minWidth:260,minHeight:180},children:(0,r.jsx)("div",{style:{width:"100%",height:"100%",transform:"scale(".concat(M,")"),transformOrigin:"top left"},children:(0,r.jsx)("div",{className:"h-full w-full flex flex-col min-h-0",children:E(t.component,t.id)})})}):(0,r.jsx)("div",{ref:S,className:"rounded-lg",style:{width:"100%",height:"100%",minWidth:2*c-8,minHeight:2*c-8},children:(0,r.jsx)("div",{style:{width:"100%",height:"100%",transform:"scale(".concat(M,")"),transformOrigin:"top left"},children:(0,r.jsx)("div",{className:"h-full w-full flex flex-col min-h-0",children:E(t.component,t.id)})})})]})}function C(e){let{children:t,gridCols:a,gridRows:s,gridSize:l=120,layoutMode:n="freeform",containerWidth:o,containerHeight:i}=e,{setNodeRef:c}=(0,A.zM)({id:"grid-container"});return(0,r.jsx)("div",{ref:c,className:(0,g.cn)("relative bg-gray-50/30 rounded-xl","freeform"===n?"p-0":"p-4"),style:"freeform"===n?{width:o||0,height:i||0}:{width:a*l+32,height:s*l+32},children:t})}let P=[{id:"user-info",name:"用户信息",category:"基础",defaultSize:{w:2,h:2},component:(0,r.jsx)(j.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300 h-full",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,r.jsx)(n.A,{className:"w-5 h-5 text-primary"}),(0,r.jsx)("h4",{className:"text-lg font-bold",children:"用户信息"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"查看和编辑用户基本信息"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:"/generic-user-avatar.png",alt:"用户头像",className:"w-12 h-12 rounded-full object-cover border-2 border-primary/20"}),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-background"})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium",children:"张三"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"zhang.san@example.com"}),(0,r.jsx)(b.E,{variant:"secondary",className:"mt-1 text-xs",children:"活跃用户"})]})]}),(0,r.jsxs)(N.$,{variant:"outline",className:"w-full hover:bg-primary hover:text-primary-foreground transition-colors mt-4 bg-transparent",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"编辑资料"]})]})})},{id:"sales-data",name:"销售数据",category:"基础",defaultSize:{w:2,h:2},component:(0,r.jsx)(j.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300 h-full",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,r.jsx)(i.A,{className:"w-5 h-5 text-green-600"}),(0,r.jsx)("h4",{className:"text-lg font-bold",children:"今日销售"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"实时销售数据统计"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-3xl font-bold",children:"\xa512,345"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-green-600",children:[(0,r.jsx)(i.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"font-medium",children:"+15.2%"}),(0,r.jsx)("span",{className:"text-muted-foreground",children:"较昨日"})]}),(0,r.jsx)(b.E,{variant:"outline",className:"text-green-600 border-green-600/30",children:"增长中"})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:"75%"}})})]})]})})},{id:"quick-actions",name:"快速操作",category:"基础",defaultSize:{w:2,h:2},component:(0,r.jsx)(j.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300 h-full",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,r.jsx)(c.A,{className:"w-5 h-5 text-primary"}),(0,r.jsx)("h4",{className:"text-lg font-bold",children:"快速操作"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"常用功能快捷入口"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)(N.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-primary hover:text-primary-foreground transition-colors bg-transparent",children:[(0,r.jsx)(d.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs",children:"订单"})]}),(0,r.jsxs)(N.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-red-500 hover:text-white transition-colors bg-transparent",children:[(0,r.jsx)(h.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs",children:"收藏"})]}),(0,r.jsxs)(N.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-blue-500 hover:text-white transition-colors bg-transparent",children:[(0,r.jsx)(u.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs",children:"分享"})]}),(0,r.jsxs)(N.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-yellow-500 hover:text-white transition-colors bg-transparent",children:[(0,r.jsx)(c.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs",children:"评价"})]})]})]})})}],R={"media-editor":{title:"媒体内容编辑",coverImage:"",actors:["演员A","演员B"],language:"中文",prompt:"萨达说的是v v呈现出萨达说的是大叔大叔是大叔东西啊是大叔萨达说大叔 萨达的爱上大是大叔"},"ecommerce-product":{id:"1",name:"iPhone 15 Pro",price:"\xa57,999",image:"/iphone-15-pro-hands.png",rating:4.8,inStock:!0},"news-article":{id:"1",title:"人工智能技术的最新发展趋势",summary:"探讨AI技术在各个领域的应用前景，以及对未来社会发展的深远影响。",author:"张三",publishTime:"2024-01-15",category:"科技",image:"/ai-technology.png",readTime:"5分钟",comments:23}};function H(e){let{category:t="workspace",locale:a="zh",className:n}=e,[o,i]=(0,s.useState)([]),[c,d]=(0,s.useState)("freeform"),[h,u]=(0,s.useState)(12),[j,z]=(0,s.useState)(10),[H,D]=(0,s.useState)(!1),[O,$]=(0,s.useState)("全部"),[F,I]=(0,s.useState)(!0),[L,W]=(0,s.useState)(null),_=(0,s.useRef)(null),J="pc-dynamic-cards-".concat(t,"-").concat(a);(0,s.useEffect)(()=>{if("grid"!==c||0===o.length)return;let e=o.reduce((e,t)=>Math.max(e,t.layout.y+t.layout.h),0);e>j&&z(e)},[o,j,c]);let V=(0,A.FR)((0,A.MS)(A.AN,{activationConstraint:{distance:2}}),(0,A.MS)(A.uN)),q=(e,t)=>e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.y+e.h>t.y,U=(e,t,a)=>{for(let r=0;r<=j-a;r++)for(let s=0;s<=h-t;s++){let l={x:s,y:r,w:t,h:a};if(!e.some(e=>q(l,e)))return{x:s,y:r}}return{x:0,y:0}},B=(()=>{let e=[];return e.push(...P),w.U.getAll().forEach(t=>{let a=R[t.name];e.push({id:t.name,name:t.displayName||t.name,category:t.category,defaultSize:{w:2,h:2},component:(0,r.jsx)(v._,{cardName:t.name,data:a,onAction:(e,t)=>console.log("Card action:",e,t)})})}),e})(),T="全部"===O?B:B.filter(e=>e.category===O),K=["全部",...Array.from(new Set(B.map(e=>e.category)))];(0,s.useEffect)(()=>{if(!(o.length>0))try{let e=localStorage.getItem(J);if(e){let t=JSON.parse(e);if(t&&Array.isArray(t.cards)){let e=t.cards.map(e=>{let t=B.find(t=>t.id===e.type);return t?{id:e.id||"".concat(t.id,"-").concat(Date.now()),type:t.id,name:t.name,category:t.category,component:t.component,layout:e.layout||{x:0,y:0,w:2,h:2,scale:1}}:null}).filter(Boolean);e.length>0&&(t.themes&&Object.entries(t.themes).forEach(e=>{let[t,a]=e;try{localStorage.setItem(t,JSON.stringify(a))}catch(e){}}),i(e),I(!1))}}}catch(e){console.error("Failed to load saved cards:",e)}},[J,B.length]);let X=e=>{i(o.filter(t=>t.id!==e))},Y=(e,t,a)=>{i(o.map(r=>{if(r.id!==e)return r;let s="freeform"===c?{w:Math.max(260,Math.round(t)),h:Math.max(180,Math.round(a))}:{w:Math.max(2,Math.round(t)),h:Math.max(2,Math.round(a))};return{...r,layout:{...r.layout,...s}}}))},G=(e,t)=>{i(o.map(a=>a.id===e?{...a,layout:{...a.layout,scale:t}}:a))},Z=o.find(e=>e.id===L),Q="freeform"===c?{width:o.reduce((e,t)=>Math.max(e,(t.layout.x||0)+Math.max(1,Math.round(t.layout.w||0))),0),height:o.reduce((e,t)=>Math.max(e,(t.layout.y||0)+Math.max(1,Math.round(t.layout.h||0))),0)}:{width:120*h,height:120*j};return(0,r.jsx)(k.J,{visible:F,children:(0,r.jsxs)("div",{className:(0,g.cn)("min-h-screen bg-background p-6",n),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"PC自定义工作台"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[F&&o.length>0&&(0,r.jsxs)(N.$,{variant:"outline",onClick:()=>{i(o.map((e,t)=>({...e,layout:{x:t%h*2,y:2*Math.floor(t/h),w:2,h:2,scale:1}})))},children:[(0,r.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"重置布局"]}),(0,r.jsx)(N.$,{variant:F?"default":"outline",onClick:()=>{F&&(()=>{try{let e={cards:o.map(e=>({id:e.id,type:e.type,layout:e.layout})),themes:o.reduce((e,t)=>{try{let a=t.id,r=localStorage.getItem(a);r&&(e[t.id]=JSON.parse(r))}catch(e){}return e},{}),updatedAt:Date.now()};localStorage.setItem(J,JSON.stringify(e))}catch(e){console.error("Failed to save layout:",e)}})(),I(!F)},children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"保存布局"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"编辑布局"]})}),F&&(0,r.jsxs)(M.K,{onClick:()=>D(!0),className:"flex items-center gap-2",children:[(0,r.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"添加卡片"]})]})]}),(0,r.jsx)("div",{className:"",children:0===o.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)(p.A,{className:"w-8 h-8 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"开始构建您的PC工作台"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:'点击右上角的"添加卡片"按钮来添加功能模块'}),F&&(0,r.jsxs)(M.K,{onClick:()=>D(!0),children:[(0,r.jsx)(f.A,{className:"w-4 h-4 mr-2",style:{display:"inline-block"}}),"添加第一个卡片"]})]}):(0,r.jsxs)(A.Mp,{sensors:V,collisionDetection:A.fp,onDragStart:e=>{let t=e.active.id;W(t);let a=o.find(e=>e.id===t);a?_.current={x:a.layout.x,y:a.layout.y}:_.current=null},onDragEnd:e=>{let{active:t,delta:a}=e;W(null);let r=t.id,s=_.current,l=o.find(e=>e.id===r);if(!l||!s||!a){_.current=null;return}if("freeform"===c){let e=Math.max(0,Math.round(s.x+a.x)),t=Math.max(0,Math.round(s.y+a.y)),n={x:e,y:t,w:Math.round(l.layout.w),h:Math.round(l.layout.h)},c=o.filter(e=>e.id!==r&&q(n,{x:e.layout.x,y:e.layout.y,w:Math.round(e.layout.w),h:Math.round(e.layout.h)}));if(0===c.length){i(a=>a.map(a=>a.id===r?{...a,layout:{...a.layout,x:e,y:t}}:a)),_.current=null;return}let d=o.filter(e=>e.id!==r).map(e=>({x:e.layout.x,y:e.layout.y,w:Math.round(e.layout.w),h:Math.round(e.layout.h),id:e.id})),h={x:e,y:t,w:Math.round(l.layout.w),h:Math.round(l.layout.h)},u=new Map;for(let e of c){let t=d.findIndex(t=>t.id===e.id);-1!==t&&d.splice(t,1);let a=e.layout.y,r=e.layout.x;for(;d.some(t=>q({x:r,y:a,w:Math.round(e.layout.w),h:Math.round(e.layout.h)},t))||q({x:r,y:a,w:Math.round(e.layout.w),h:Math.round(e.layout.h)},h);)a+=16;u.set(e.id,{x:r,y:a}),d.push({x:r,y:a,w:Math.round(e.layout.w),h:Math.round(e.layout.h),id:e.id})}i(a=>a.map(a=>{if(a.id===r)return{...a,layout:{...a.layout,x:e,y:t}};let s=u.get(a.id);return s?{...a,layout:{...a.layout,x:s.x,y:s.y}}:a})),_.current=null;return}let n=Math.max(0,Math.min(h-l.layout.w,s.x+Math.round(a.x/120))),d=Math.max(0,Math.min(j-l.layout.h,s.y+Math.round(a.y/120))),u={x:n,y:d,w:l.layout.w,h:l.layout.h},m=o.filter(e=>e.id!==r&&q(u,e.layout));if(0===m.length){i(e=>e.map(e=>e.id===r?{...e,layout:{...e.layout,x:n,y:d}}:e)),_.current=null;return}let x=o.filter(e=>e.id!==r).map(e=>({x:e.layout.x,y:e.layout.y,w:e.layout.w,h:e.layout.h,id:e.id})),y={x:n,y:d,w:l.layout.w,h:l.layout.h},f=new Map;for(let e of m){let t=x.findIndex(t=>t.id===e.id);-1!==t&&x.splice(t,1);let a=U([...x,y],e.layout.w,e.layout.h);f.set(e.id,{x:a.x,y:a.y}),x.push({x:a.x,y:a.y,w:e.layout.w,h:e.layout.h,id:e.id})}i(e=>e.map(e=>{if(e.id===r)return{...e,layout:{...e.layout,x:n,y:d}};let t=f.get(e.id);return t?{...e,layout:{...e.layout,x:t.x,y:t.y}}:e})),_.current=null},children:[(0,r.jsx)(C,{gridCols:h,gridRows:j,gridSize:120,layoutMode:c,containerWidth:Q.width,containerHeight:Q.height,children:o.map(e=>(0,r.jsx)(S.x,{value:e.id,children:(0,r.jsx)(E,{card:e,isEditing:F,onRemove:X,onResize:Y,onScale:G,gridSize:120,layoutMode:c})},e.id))}),(0,r.jsx)(A.Hd,{dropAnimation:null,children:Z?(0,r.jsx)("div",{className:"shadow-2xl",children:(0,r.jsx)("div",{style:{width:"freeform"===c?Math.max(260,Math.round(Z.layout.w)):Math.max(232,120*Z.layout.w-8),height:"freeform"===c?Math.max(180,Math.round(Z.layout.h)):Math.max(232,120*Z.layout.h-8)},children:Z.component})}):null})]})}),H&&F&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>D(!1)}),(0,r.jsxs)("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"选择功能卡片"}),(0,r.jsx)(N.$,{variant:"ghost",size:"sm",onClick:()=>D(!1),children:(0,r.jsx)(l.A,{className:"w-5 h-5"})})]}),(0,r.jsx)("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2",children:K.map(e=>(0,r.jsx)(N.$,{variant:O===e?"default":"outline",size:"sm",className:"whitespace-nowrap text-sm h-9",onClick:()=>$(e),children:e},e))})]}),(0,r.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-160px)]",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(e=>{let t=o.some(t=>t.type===e.id);return(0,r.jsx)("div",{className:"cursor-pointer transition-all border rounded-xl p-4 ".concat(t?"bg-gray-50 border-gray-200 opacity-50":"hover:shadow-lg hover:scale-[1.02] border-gray-200 hover:border-primary/30"),onClick:()=>!t&&(e=>{let t=e.defaultSize||{w:2,h:2};if("freeform"===c){let a=Math.max(260,120*(t.w||2)-8),r=Math.max(180,120*(t.h||2)-8),s=o.reduce((e,t)=>Math.max(e,(t.layout.y||0)+Math.max(1,Math.round(t.layout.h||0))),0),l={id:"".concat(e.id,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e.id,name:e.name,category:e.category,component:e.component,layout:{x:0,y:s+16,w:a,h:r,scale:1}};i(e=>[...e,l]),D(!1);return}let a=((e,t)=>{for(let a=0;a<=j-t;a++)for(let r=0;r<=h-e;r++)if(!o.some(s=>!(r>=s.layout.x+s.layout.w||r+e<=s.layout.x||a>=s.layout.y+s.layout.h||a+t<=s.layout.y)))return{x:r,y:a};return{x:0,y:0}})(Math.max(2,t.w),Math.max(2,t.h)),r={id:"".concat(e.id,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e.id,name:e.name,category:e.category,component:e.component,layout:{x:a.x,y:a.y,w:Math.max(2,t.w),h:Math.max(2,t.h),scale:1}};i(e=>[...e,r]),D(!1)})(e),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h5",{className:"font-semibold text-base mb-1",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[e.category,"分类"]}),(0,r.jsx)(b.E,{variant:"outline",className:"text-xs",children:e.category})]}),t&&(0,r.jsx)(b.E,{variant:"secondary",className:"text-xs ml-2",children:"已添加"})]})},e.id)})})})]})]})]})})}},35749:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])},36924:(e,t,a)=>{Promise.resolve().then(a.bind(a,34745))},42039:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},44260:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},46393:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},49277:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},63916:(e,t,a)=>{"use strict";var r=a(55931),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},l=r.useState,n=r.useEffect,o=r.useLayoutEffect,i=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!s(e,a)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),r=l({inst:{value:a,getSnapshot:t}}),s=r[0].inst,d=r[1];return o(function(){s.value=a,s.getSnapshot=t,c(s)&&d({inst:s})},[e,a,t]),n(function(){return c(s)&&d({inst:s}),e(function(){c(s)&&d({inst:s})})},[e]),i(a),a};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},68812:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]])},70368:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},72497:(e,t,a)=>{"use strict";e.exports=a(63916)},79588:(e,t,a)=>{"use strict";var r=a(95604);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},80130:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},88014:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]])},97909:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},e=>{e.O(0,[3739,8290,5022,5123,1457,8607,4730,3419,6396,6037,9770,721,1165,9900,7341,7358],()=>e(e.s=36924)),_N_E=e.O()}]);