(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2663],{12680:(e,t,a)=>{"use strict";a.d(t,{L:()=>n});var r=a(77455),o=a(29088);let l=(()=>{let e=r.A.create({baseURL:o.env.NEXT_PUBLIC_API_BASE_URL||"http://47.94.52.142::3007",timeout:1e4,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use(e=>{let t=window.localStorage.getItem("aino_auth_token")||window.localStorage.getItem("aino_token")||"";return t&&(e.headers.Authorization="Bearer ".concat(t)),"get"===e.method&&(e.params={...e.params,_t:Date.now()}),e},e=>Promise.reject(e)),e.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("aino_auth_token"),window.location.href="/auth/login"),Promise.reject(e)}),e})(),s=async e=>{try{return(await l(e)).data}catch(r){var t;if(!r.response)throw Error("Network error - please check your connection");let e=r.response.status,a=(null==(t=r.response.data)?void 0:t.message)||r.message;throw Error("Request failed (".concat(e,"): ").concat(a))}},n={get:(e,t)=>s({...t,method:"GET",url:e}),post:(e,t,a)=>s({...a,method:"POST",url:e,data:t}),put:(e,t,a)=>s({...a,method:"PUT",url:e,data:t}),patch:(e,t,a)=>s({...a,method:"PATCH",url:e,data:t}),delete:(e,t)=>s({...t,method:"DELETE",url:e}),upload:(e,t,a)=>{let r=new FormData;return r.append("file",t),s({...a,method:"POST",url:e,data:r,headers:{"Content-Type":"multipart/form-data",...null==a?void 0:a.headers}})},download:async(e,t,a)=>{try{let r=await l({...a,method:"GET",url:e,responseType:"blob"}),o=new Blob([r.data]),s=window.URL.createObjectURL(o),n=document.createElement("a");n.href=s,n.download=t||"download",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s)}catch(e){throw Error("Download failed")}}}},40895:(e,t,a)=>{Promise.resolve().then(a.bind(a,42575))},42575:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(89835),o=a(55931),l=a(79588),s=a(12680),n=a(96037),c=a(54890);function d(){let{locale:e}=(0,l.useParams)(),t=(0,l.useRouter)(),[a,d]=(0,o.useState)(""),[i,u]=(0,o.useState)(""),[p,h]=(0,o.useState)(""),[m,w]=(0,o.useState)(!1),[x,g]=(0,o.useState)(null),[v,b]=(0,o.useState)(null),f=(0,o.useMemo)(()=>{try{let e=window.localStorage.getItem("APPLICATION_CONFIG"),t=e?JSON.parse(e):null;return(null==t?void 0:t.id)||""}catch(e){return""}},[]),y=(0,o.useMemo)(()=>{try{let e=window.localStorage.getItem("aino_user"),t=e?JSON.parse(e):null;return(null==t?void 0:t.phone)||""}catch(e){return""}},[]),j=async r=>{if(r.preventDefault(),g(null),b(null),!a||!i||!p)return void g("请完整填写所有字段");if(i!==p)return void g("新密码与确认密码不一致");if(!y)return void g("未获取到当前用户手机号，请重新登录后再试");if(!f)return void g("未获取到应用ID，请检查应用配置");try{w(!0);let r=f?"aino_auth_token:".concat(f):null,o=(r?window.localStorage.getItem(r):null)||window.localStorage.getItem("aino_auth_token")||window.localStorage.getItem("aino_token")||"",l=await s.L.post("/api/application-users/change-password?applicationId=".concat(f),{phone_number:y,old_password:a,new_password:i},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}});(null==l?void 0:l.success)?(b("密码修改成功"),d(""),u(""),h(""),setTimeout(()=>{t.push("/".concat(e,"/profile/settings"))},800)):g((null==l?void 0:l.error)||"修改密码失败")}catch(e){var o,l;g((null==e||null==(l=e.response)||null==(o=l.data)?void 0:o.error)||(null==e?void 0:e.message)||"修改密码失败")}finally{w(!1)}};return(0,r.jsxs)("main",{className:"min-h-screen",style:{backgroundColor:"var(--background-secondary, #f8fafc)"},children:[(0,r.jsx)(c.AppHeader,{title:"修改密码",showBackButton:!0}),(0,r.jsx)("div",{className:"p-4 space-y-4 pt-20",children:(0,r.jsx)(n.AppCard,{children:(0,r.jsxs)("form",{onSubmit:j,className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--card-title-color)"},children:"原密码"}),(0,r.jsx)("input",{type:"password",value:a,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 rounded-lg border text-sm bg-white/70",placeholder:"请输入原密码"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--card-title-color)"},children:"新密码"}),(0,r.jsx)("input",{type:"password",value:i,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 rounded-lg border text-sm bg-white/70",placeholder:"请输入新密码（至少6位）"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--card-title-color)"},children:"确认新密码"}),(0,r.jsx)("input",{type:"password",value:p,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 rounded-lg border text-sm bg-white/70",placeholder:"请再次输入新密码"})]}),x?(0,r.jsx)("p",{className:"text-xs text-red-500",children:x}):null,v?(0,r.jsx)("p",{className:"text-xs text-green-600",children:v}):null,(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full h-11 rounded-full bg-black text-white text-sm disabled:opacity-60",children:m?"提交中...":"确认修改"})]})})})]})}},54890:(e,t,a)=>{"use strict";a.d(t,{AppHeader:()=>d});var r=a(89835),o=a(55931),l=a(15496),s=a(76539),n=a(18959),c=a(79588);function d(e){let{title:t,showBackButton:a=!1,className:d}=e,[i,u]=(0,o.useState)(!1),p=(0,c.useRouter)();return(0,o.useEffect)(()=>{let e=()=>{u(window.scrollY>10)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),(0,r.jsxs)("header",{className:(0,l.cn)("fixed top-0 left-0 right-0 z-30 flex items-center justify-between p-3 h-14 transition-all duration-300",{"bg-white/80 backdrop-blur-lg shadow-sm":i,"bg-transparent shadow-none":!i},d),children:[(0,r.jsx)("div",{className:"flex-1",children:a&&(0,r.jsx)("button",{onClick:()=>p.back(),className:"p-2 rounded-full hover:bg-gray-100/50",children:(0,r.jsx)(s.A,{className:"w-6 h-6 text-gray-800"})})}),(0,r.jsx)("div",{className:"flex-1 text-center",children:(0,r.jsx)("h1",{className:"text-lg font-semibold text-gray-900 whitespace-nowrap inline-block",children:t})}),(0,r.jsx)("div",{className:"flex-1 flex justify-end items-center space-x-1",children:(0,r.jsx)("button",{className:(0,l.cn)("p-2 rounded-full hover:bg-gray-100/50 transition-opacity duration-300",{"opacity-100":i,"opacity-0 pointer-events-none":!i}),children:(0,r.jsx)(n.A,{className:"w-6 h-6 text-gray-800"})})})]})}},76539:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(51894).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])}},e=>{e.O(0,[6416,8290,5022,6497,7455,6037,9900,7341,7358],()=>e(e.s=40895)),_N_E=e.O()}]);