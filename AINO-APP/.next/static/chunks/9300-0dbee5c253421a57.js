"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9300],{6195:(e,t,a)=>{a.d(t,{CV:()=>s,zU:()=>n});class l{setTarget(e){this.target=e}setTargetOrigin(e){this.targetOrigin=e}setChannel(e){this.channel=e}post(e,t,a){if(!this.target)return;let l={type:e,payload:t,correlationId:a,channel:this.channel};try{this.target.postMessage(l,this.targetOrigin)}catch(e){}}constructor(e,t){var a;this.target=null!=e?e:window.parent,this.targetOrigin=null!=(a=null==t?void 0:t.targetOrigin)?a:"*",this.channel=null==t?void 0:t.channel}}function n(e,t){let a=document,l=t?a.querySelector(t):a.body;if(!l)return()=>{};let n=0,r=()=>{let t=Math.max(l.scrollHeight,l.offsetHeight,l.clientHeight);t!==n&&(n=t,e.post("aino:height",{height:t}))};r();let s=new ResizeObserver(()=>r());s.observe(l);let i=()=>r();window.addEventListener("resize",i),document.fonts&&document.fonts.addEventListener&&document.fonts.addEventListener("loadingdone",r);let c=new MutationObserver(()=>r());return c.observe(l,{subtree:!0,childList:!0,attributes:!0,characterData:!0}),()=>{try{s.disconnect()}catch(e){}try{c.disconnect()}catch(e){}window.removeEventListener("resize",i)}}let r=null;function s(e){return r?((null==e?void 0:e.targetOrigin)&&r.setTargetOrigin(e.targetOrigin),(null==e?void 0:e.channel)&&r.setChannel(e.channel)):r=new l(void 0,e),r}},7504:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8892:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},11226:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]])},15156:(e,t,a)=>{a.d(t,{F:()=>d});var l=a(89835),n=a(55931),r=a(27426),s=a(33031),i=a(69140),c=a(15496);function o(e){let{id:t,children:a,className:r}=e,{attributes:o,listeners:d,setNodeRef:m,transform:h,transition:u,isDragging:p}=(0,s.gl)({id:t}),g={transform:i.Ks.Transform.toString(h),transition:u,opacity:p?.5:1,zIndex:p?1e3:1};return(0,l.jsx)("div",{ref:m,style:g,...o,...d,className:(0,c.cn)("relative cursor-grab active:cursor-grabbing transition-all duration-200",p&&"shadow-2xl scale-105",r),children:n.isValidElement(a)?n.cloneElement(a,{id:t,"data-theme-key":t}):a})}function d(e){let{items:t,onReorder:a,className:i="space-y-4",layout:d="vertical",disabled:m=!1,gridCols:h=3}=e,[u,p]=n.useState(t),[g,f]=n.useState(null),y=(0,r.FR)((0,r.MS)(r.AN,{activationConstraint:{distance:8}}),(0,r.MS)(r.uN,{coordinateGetter:s.JR}));n.useEffect(()=>{p(t)},[t]);let x="grid"===d?s.kL:s._G,v="grid"===d?(0,c.cn)("grid grid-cols-1 md:grid-cols-2 lg:grid-cols-".concat(h," gap-6"),i):i,b=u.find(e=>e.id===g);return m?(0,l.jsx)("div",{className:v,children:u.map(e=>(0,l.jsx)("div",{className:e.className,children:n.isValidElement(e.content)?n.cloneElement(e.content,{id:e.id,"data-theme-key":e.id}):e.content},e.id))}):(0,l.jsxs)(r.Mp,{sensors:y,collisionDetection:r.fp,onDragStart:function(e){f(e.active.id)},onDragEnd:function(e){let{active:t,over:l}=e;if(f(null),l&&t.id!==l.id){let e=u.findIndex(e=>e.id===t.id),n=u.findIndex(e=>e.id===l.id),r=(0,s.be)(u,e,n);p(r),null==a||a(r.map(e=>e.id))}},children:[(0,l.jsx)(s.gB,{items:u.map(e=>e.id),strategy:x,children:(0,l.jsx)("div",{className:v,children:u.map(e=>(0,l.jsx)(o,{id:e.id,className:(0,c.cn)("transition-all duration-200",e.className),children:e.content},e.id))})}),(0,l.jsx)(r.Hd,{children:b?(0,l.jsx)("div",{className:"transform rotate-3 shadow-2xl",children:n.isValidElement(b.content)?n.cloneElement(b.content,{id:String(b.id),"data-theme-key":String(b.id)}):b.content}):null})]})}},26077:(e,t,a)=>{a.d(t,{a:()=>s,g:()=>r});var l=a(77455),n=a(67089);let r={"job-position":{id:"String",title:"String",salary:"String",location:"String",demandGrowth:"String",salaryGrowth:"String",locale:"String"},"job-posting":{title:"String",company:"String",location:"String",salary:"String",experience:"String",education:"String",tags:"String[]"},"related-jobs-list":{title:"String",avgSalary:"String",location:"String",education:"String",experience:"String",jobType:"String"},"job-experience-ratio":{title:"String",description:"String",list:[{name:"String",value:"Number",jobs:"Number"}]},"job-header":{title:"String",salary:"String",location_province:"String",location_city:"String",location_district:"String",education:"String",experience:"String",employmentType:"String"},"job-benefits":{title:"String",benefits:"String[]"},"job-requirements":{title:"String",requirements:"String[]"},"apply-resume":{buttonText:"String"},"job-detail-intro":{title:"String",description:"String",avgMonthlySalary:"String",dataSource:"String"},"education-salary-requirements":{title:"String",description:"String",data:[{label:"String",value:"String",percentage:"Number",color:"String"}]},"job-prospect-trend":{title:"String",monthlyNewJobs:"String",monthlyLabel:"String",rankText:"String",chartData:[{month:"String",value:"Number"}]},"job-city-ranking":{title:"String",description:"String",data:[{label:"String",value:"String|Number",percentage:"Number"}]},"monthly-job-growth":{title:"String",chartData:[{month:"String",jobs:"Number"}]},"ability-requirements-radar":{title:"String",chartData:[{subject:"String",value:"Number",fullMark:"Number"}]},"company-info":{name:"String",logo:"String",description:"String"}},s=async()=>{var e,t;let a=localStorage.getItem("APPLICATION_CONFIG"),r=(null==(t=(a?JSON.parse(a):{}).config)||null==(e=t.clientManifest)?void 0:e.dataMappings)||{},s=[];Object.keys(r).forEach(async e=>{let[t,a]=e.split("::"),[i,c,o]=a.split("_");s.push(new Promise(async(a,s)=>{let d,m,h=r[e];if("table"===i){let{data:e}=await l.A.get("http://localhost:3007/api/records/".concat(c,"?noAuth=true"));d=e.data,m=[],d.forEach(e=>{let t={};Object.keys(h).forEach(a=>{t[a]=e[h[a]]}),m.push(t)})}else if("record"===i){let{data:e}=await l.A.get("http://localhost:3007/api/records/".concat(c,"/").concat(o,"?noAuth=true"));d=e.data,m={},Object.keys(h).forEach(e=>{if(e.indexOf("[].")>-1){let t=e.split("[].");m[t[0]]||(m[t[0]]=[]);let a=h[e].split(".");d[a[0]].forEach((e,l)=>{let n={};e.images.concat(e.numbers).concat(e.texts).forEach(e=>{n[e.id]=e}),m[t[0]][l]||(m[t[0]][l]={}),m[t[0]][l][t[1]]=n[a[1]].value})}else m[e]=d[h[e]]})}n.U.setData(t,m,d),a(!0)}))}),await Promise.all(s)}},30301:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},33378:(e,t,a)=>{a.d(t,{M3:()=>W,Zd:()=>$});var l=a(89835),n=a(55931),r=a(54890),s=a(92475),i=a(15764),c=a(67089),o=a(96037),d=a(15156),m=a(2794),h=a(15496),u=a(84212),p=a(97909),g=a(30301),f=a(8892),y=a(46393),x=a(70368),v=a(58812),b=a(77796),w=a(6533),j=a(42039),N=a(26941),S=a(9716),A=a(51894);let k=(0,A.A)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var E=a(11226);let I=(0,A.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var C=a(68736);let _=(0,A.A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var O=a(17553),M=a(76865);let R=(0,A.A)("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);var D=a(64684),P=a(26443),T=a(68232),z=a(7504),L=a(91603),J=a(61138),U=a(73607);let V=e=>{let{code:t,props:a,data:r,theme:s,ui:i,className:c}=e,o=(0,n.useRef)(null),d=(0,n.useMemo)(()=>"<!doctype html><html><head><meta charset=\"utf-8\"><style>html,body,#root{height:100%;margin:0}</style>\n  <script crossorigin src=\"https://unpkg.com/react@18/umd/react.production.min.js\"><\/script>\n  <script crossorigin src=\"https://unpkg.com/react-dom@18/umd/react-dom.production.min.js\"><\/script>\n  <script crossorigin src=\"https://unpkg.com/@babel/standalone/babel.min.js\"><\/script>\n  </head><body><div id=\"root\"></div>\n  <script>\n  const render = (payload) => {\n    try {\n      const { code, props, data, theme, ui } = payload\n      const transformed = Babel.transform(code, { presets: ['react'] }).code\n      const exports = {}\n      const module = { exports }\n      const req = () => ({})\n      const fn = new Function('exports','module','require','React','props','data','theme','ui', transformed + '; return module.exports || exports.default || exports')\n      const Comp = fn(exports, module, req, window.React, props, data, theme, ui)\n      const el = React.createElement(Comp.default || Comp, { props, data, theme, ui })\n      ReactDOM.createRoot(document.getElementById('root')).render(el)\n    } catch (e) {\n      document.getElementById('root').innerText = 'Sandbox error: ' + (e && e.message ? e.message : e)\n    }\n  }\n  window.addEventListener('message', (e)=>{ if (e.data && e.data.type==='RUN'){ render(e.data) } })\n  <\/script>\n  </body></html>",[]);return(0,n.useEffect)(()=>{var e;let l=null==(e=o.current)?void 0:e.contentWindow;l&&l.postMessage({type:"RUN",code:t,props:a,data:r,theme:s,ui:i},"*")},[t,a,r,s,i]),(0,l.jsx)("iframe",{ref:o,className:c,sandbox:"allow-scripts",srcDoc:d})};var G=a(3833),H=a(62780),B=a(6195),F=a(26077),q=a(79588);let $={workspace:{id:"workspace",name:"工作台",description:"可拖拽的工作台卡片系统",type:"workspace",config:{showHeader:!0,showBottomNav:!1,allowEdit:!0,layout:"mobile"}},content:{id:"content",name:"内容管理",description:"内容管理平台界面",type:"content",config:{showHeader:!0,showBottomNav:!0,allowEdit:!1,layout:"mobile"}},education:{id:"education",name:"在线教育",description:"在线教育移动应用",type:"education",config:{showHeader:!0,showBottomNav:!1,allowEdit:!0,layout:"mobile"}},"pc-workspace":{id:"pc-workspace",name:"PC工作台",description:"PC版可拖拽的工作台卡片系统",type:"workspace",config:{showHeader:!1,showBottomNav:!1,allowEdit:!0,layout:"pc"}}},Z=[{id:"user-info",name:"用户信息",category:"基础",component:(0,l.jsx)(o.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(u.A,{className:"w-5 h-5 text-accent"}),(0,l.jsx)("h4",{className:"text-lg font-bold",children:"用户信息"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"查看和编辑用户基本信息"}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("img",{src:"/generic-user-avatar.png",alt:"用户头像",className:"w-12 h-12 rounded-full object-cover border-2 border-accent/20"}),(0,l.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-background"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-medium",children:"张三"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"zhang.san@example.com"}),(0,l.jsx)(i.E,{variant:"secondary",className:"mt-1 text-xs",children:"活跃用户"})]})]}),(0,l.jsxs)(s.$,{variant:"outline",className:"w-full hover:bg-accent hover:text-accent-foreground transition-colors mt-4 bg-transparent",children:[(0,l.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"编辑资料"]})]})})},{id:"sales-data",name:"销售数据",category:"基础",component:(0,l.jsx)(o.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(g.A,{className:"w-5 h-5 text-green-600"}),(0,l.jsx)("h4",{className:"text-lg font-bold",children:"今日销售"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"实时销售数据统计"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"text-3xl font-bold",children:"\xa512,345"}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-green-600",children:[(0,l.jsx)(g.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"font-medium",children:"+15.2%"}),(0,l.jsx)("span",{className:"text-muted-foreground",children:"较昨日"})]}),(0,l.jsx)(i.E,{variant:"outline",className:"text-green-600 border-green-600/30",children:"增长中"})]}),(0,l.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:"75%"}})})]})]})})},{id:"quick-actions",name:"快速操作",category:"基础",component:(0,l.jsx)(o.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(f.A,{className:"w-5 h-5 text-accent"}),(0,l.jsx)("h4",{className:"text-lg font-bold",children:"快速操作"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"常用功能快捷入口"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)(s.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-accent hover:text-accent-foreground transition-colors bg-transparent",children:[(0,l.jsx)(y.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-xs",children:"订单"})]}),(0,l.jsxs)(s.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-red-500 hover:text-white transition-colors bg-transparent",children:[(0,l.jsx)(x.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-xs",children:"收藏"})]}),(0,l.jsxs)(s.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-accent hover:text-accent-foreground transition-colors bg-transparent",children:[(0,l.jsx)(v.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-xs",children:"分享"})]}),(0,l.jsxs)(s.$,{variant:"outline",size:"sm",className:"h-12 flex-col space-y-1 hover:bg-yellow-500 hover:text-white transition-colors bg-transparent",children:[(0,l.jsx)(f.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-xs",children:"评价"})]})]})]})})}];function W(e){let{category:t,locale:a,layout:g,showHeader:y,showBottomNav:x,headerTitle:v,showBack:A,aiOpsUrl:W,aiOpsLabel:Y,topTabsConfig:K,contentNavConfig:Q,initialTabIndex:X,pageId:ee}=e,[et,ea]=(0,n.useState)([]),el=(0,n.useRef)({}),[en,er]=(0,n.useState)(!1),es=(0,q.useSearchParams)();(0,q.useRouter)();let ei=(0,q.usePathname)(),ec="true"===es.get("isEdite")||"true"===es.get("isEdit"),[eo,ed]=(0,n.useState)(ec),[em,eh]=(0,n.useState)("全部"),[eu,ep]=(0,n.useState)(!1),[eg,ef]=(0,n.useState)(null),[ey,ex]=(0,n.useState)([]),[ev,eb]=(0,n.useState)(null),[ew,ej]=(0,n.useState)({}),[eN,eS]=(0,n.useState)(null!=X?X:0),[eA,ek]=(0,n.useState)(0),[eE,eI]=(0,n.useState)(0),[eC,e_]=(0,n.useState)({}),eO=(e,t)=>{try{el.current[e]=t}catch(e){}e===ez&&ea(t)};(0,n.useEffect)(()=>{"number"==typeof X&&eS(X)},[X]);let eM=(0,n.useMemo)(()=>{try{if(!ee)return null;let e=localStorage.getItem("APP_PAGE_".concat(ee));return e?JSON.parse(e):null}catch(e){return null}},[ee,eN,eE]),eR=async()=>{if(void 0!==window){var e,t,a,l,n,r,s,i;let c=window.localStorage.getItem("APP_ID"),o=await fetch("http://localhost:3007/api/applications/".concat(encodeURIComponent(String(c)),"?noAuth=true")),d=null;try{d=await o.json()}catch(e){d=null}if(!o.ok||!d)return;let{config:m}=(d&&"object"==typeof d&&"data"in d?d.data:d)||{},h=new URLSearchParams(window.location.search).get("tab")||0;if(null==m||null==(l=m.clientManifest)||null==(a=l.pages)||null==(t=a["p-".concat(ee)])||null==(e=t.overrides)?void 0:e["tab-".concat(h)]){let e=null==m||null==(i=m.clientManifest)||null==(s=i.pages)||null==(r=s["p-".concat(ee)])||null==(n=r.overrides)?void 0:n["tab-".concat(h)];localStorage.setItem("CARD_DISPLAY_DATA",JSON.stringify(e))}}};(0,n.useEffect)(()=>{eR()},[ee]);let eD=(0,n.useMemo)(()=>{try{if(K&&"text"===K.type&&Array.isArray(K.items)&&K.items.length>0)return K;let e=eM&&eM.topBar||null,t=!!(e&&e.enabled),a=t&&e.tabs||[];if(t&&Array.isArray(a)&&a.length>0)return{type:"text",items:a.map(e=>({title:e&&(e.title||"").trim()||"标签"}))};let l=eM&&eM.contentNav;if(l){let e=l.style;if("text"===e)return{...l,type:"text"};if("text"===l.type)return l}return null}catch(e){return null}},[eM]),eP=(0,n.useMemo)(()=>{let e=e=>{if(!e)return null;let t=e.style;return"text"===t||"icon"===t?{...e,type:"text"===t?"text":"iconText"}:"text"===e.type||"iconText"===e.type?e:null};try{if(eD){let t=eM&&eM.tabContent||{},a=(null==t?void 0:t[eN])||{};return e(null==a?void 0:a.contentNav)||null}return e(eM&&eM.contentNav)||null}catch(e){return null}},[eM,eD,eN]),eT=(0,n.useMemo)(()=>{let e=!!(eD&&"text"===eD.type),a=!!(eP&&"iconText"===eP.type);return e&&a?"".concat(t,"-tab-").concat(eN,"-icon-").concat(eA):e?"".concat(t,"-tab-").concat(eN):a?"".concat(t,"-icon-").concat(eA):t},[t,eD,eP,eN,eA]),ez="dynamic_page_layout_".concat(eT,"_").concat(a),eL=e=>e.map(e=>({id:e.id,type:e.type})),eJ=e=>{let t=eH(),a=Date.now();return e.map((e,l)=>{let n=t.find(t=>t.id===e.type);return n?{id:e.id||"".concat(n.id,"-").concat(a,"-").concat(l),type:n.id,name:n.name,category:n.category,component:n.component,width:n.width}:null}).filter(Boolean)},eU=()=>{try{let e={},t={};et.forEach(a=>{try{let t=localStorage.getItem(a.id),l=localStorage.getItem("card_theme_".concat(a.id)),n=t||l;n&&(e[a.id]=JSON.parse(n))}catch(e){}try{let e=localStorage.getItem("CARD_DS_".concat(a.id));e&&(t[a.id]=JSON.parse(e))}catch(l){let e=localStorage.getItem("CARD_DS_".concat(a.id));e&&(t[a.id]=e)}});let a={cards:eL(et),themes:e,dataSources:t,updatedAt:Date.now()};localStorage.setItem(ez,JSON.stringify(a));try{fetch("http://localhost:3007/api/page-configs/key/".concat(encodeURIComponent(ez)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).catch(()=>{})}catch(e){}}catch(e){console.error("保存布局到本地存储失败",e)}},eV=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(eo){try{eV.current&&window.clearTimeout(eV.current),eV.current=window.setTimeout(()=>{try{eU()}catch(e){}},400)}catch(e){}return()=>{eV.current&&(window.clearTimeout(eV.current),eV.current=null)}}},[et,ew,ez,eo]),(0,n.useEffect)(()=>{let e=e=>{try{if(!eo)return;let t=e.key||"";(ee&&t==="APP_PAGE_".concat(ee)||t.startsWith("CARD_DS_"))&&(eV.current&&window.clearTimeout(eV.current),eV.current=window.setTimeout(()=>{try{eU()}catch(e){}},300))}catch(e){}};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[eo,ee]),(0,n.useEffect)(()=>{let e=e=>{let t=e.data;if(t&&"SET_OVERRIDE"===t.type)try{let{pageId:e,sectionKey:a,cardType:l,props:n,jsx:r,display:s,filters:i}=t;if(!e||e!==ee)return;let c="APP_PAGE_".concat(e),o=localStorage.getItem(c),d=o?JSON.parse(o):{},m={...d.overrides||{}},h={...m[a]||{}},u={...h[l]||{}};void 0!==n&&(u.props=n),void 0!==r&&(u.jsx=r),void 0!==s&&(u.display=s),void 0!==i&&(u.filters=i),h[l]=u,m[a]=h;let p={...d,overrides:m};localStorage.setItem(c,JSON.stringify(p)),eI(e=>e+1);try{fetch("http://localhost:3007/api/page-configs/key/".concat(encodeURIComponent(c)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).catch(()=>{})}catch(e){}}catch(e){console.error("SET_OVERRIDE failed:",e)}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[ee]),(0,n.useEffect)(()=>{let e=e=>{let t=e.data;if(t&&"GET_OVERRIDE"===t.type)try{var a,l,n,r,s,i,c,o,d,m;let{pageId:e,sectionKey:h,cardType:u}=t;if(!e||e!==ee)return;let p=localStorage.getItem("APP_PAGE_".concat(e)),g=p?JSON.parse(p):{},f=null==g||null==(n=g.overrides)||null==(l=n[h])||null==(a=l[u])?void 0:a.props,y=null==g||null==(i=g.overrides)||null==(s=i[h])||null==(r=s[u])?void 0:r.jsx,x=null==g||null==(d=g.overrides)||null==(o=d[h])||null==(c=o[u])?void 0:c.filters;null==(m=window.parent)||m.postMessage({type:"OVERRIDE",pageId:e,sectionKey:h,cardType:u,props:f,jsx:y,filters:x},"*")}catch(e){console.error("GET_OVERRIDE failed:",e)}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[ee]),(0,n.useEffect)(()=>{try{{var e;let t=et.map(e=>({type:e.type,displayName:e.name}));null==(e=window.parent)||e.postMessage({type:"DYN_CARDS",category:eT,cards:t},"*")}}catch(e){}},[et,eT]);let eG=(0,n.useMemo)(()=>{try{var e,t,a,l,n,r,s;if(!ee)return et;let i=localStorage.getItem("APP_PAGE_".concat(ee));if(!i)return et;let c=JSON.parse(i||"{}"),o=null==c||null==(a=c.visibility)||null==(t=a.combined)||null==(e=t[eN])?void 0:e[eA];if(o&&o.length>0)return et.filter(e=>o.includes(e.type));let d=null==c||null==(n=c.visibility)||null==(l=n.icon)?void 0:l[eA];if(d&&d.length>0)return et.filter(e=>d.includes(e.type));let m=null==c||null==(s=c.visibility)||null==(r=s.text)?void 0:r[eN];if(m&&m.length>0)return et.filter(e=>m.includes(e.type));return et}catch(e){return et}},[et,ee,eD,eP,eN,eA]);(0,n.useEffect)(()=>{try{let e=localStorage.getItem(ez);if(!e)return void(async()=>{try{let t=await fetch("http://localhost:3007/api/page-configs/key/".concat(encodeURIComponent(ez)));if(t.ok){var e;let a=await t.json().catch(()=>null),l=a&&(null!=(e=a.data)?e:a);if(l&&Array.isArray(l.cards)){try{localStorage.setItem(ez,JSON.stringify(l))}catch(e){}let e=l.cards.map(e=>"string"==typeof e?{type:e}:{id:e.id,type:e.type});if(l.themes&&"object"==typeof l.themes)try{Object.entries(l.themes).forEach(e=>{let[t,a]=e,l=JSON.stringify(a);try{localStorage.setItem(t,l)}catch(e){}if(t.startsWith("card_theme_")){let e=t.replace(/^card_theme_/,"");try{localStorage.setItem(e,l)}catch(e){}}})}catch(e){}if(l.dataSources&&"object"==typeof l.dataSources){let e={};try{Object.entries(l.dataSources).forEach(t=>{let[a,l]=t;try{localStorage.setItem("CARD_DS_".concat(a),JSON.stringify(l))}catch(e){}let n=l&&l.label||"";n&&(e[a]=String(n))})}catch(e){}Object.keys(e).length>0&&ej(t=>({...t,...e}))}let t=eJ(e);if(t.length>0){eO(ez,t),ed(!1);return}}}}catch(e){}ea([]),ed(!0)})();let t=JSON.parse(e);if(t&&Array.isArray(t.cards)){let e=t.cards.map(e=>"string"==typeof e?{type:e}:{id:e.id,type:e.type});if(t.themes&&"object"==typeof t.themes)try{Object.entries(t.themes).forEach(e=>{let[t,a]=e,l=JSON.stringify(a);try{localStorage.setItem(t,l)}catch(e){}if(t.startsWith("card_theme_")){let e=t.replace(/^card_theme_/,"");try{localStorage.setItem(e,l)}catch(e){}}})}catch(e){}if(t.dataSources&&"object"==typeof t.dataSources){let e={};try{Object.entries(t.dataSources).forEach(t=>{let[a,l]=t;try{localStorage.setItem("CARD_DS_".concat(a),JSON.stringify(l))}catch(e){}let n=l&&l.label||"";n&&(e[a]=String(n))})}catch(e){}Object.keys(e).length>0&&ej(t=>({...t,...e}))}let a=eJ(e);a.length>0&&(eO(ez,a),ed(!1))}}catch(e){console.error("恢复布局失败",e)}},[ez]),(0,n.useEffect)(()=>{try{let e={};et.forEach(t=>{try{let a=localStorage.getItem("CARD_DS_".concat(t.id));if(a){let l=JSON.parse(a),n="string"==typeof l?l:l&&l.label;n&&(e[t.id]=n)}}catch(l){let a=localStorage.getItem("CARD_DS_".concat(t.id));a&&(e[t.id]=a)}}),Object.keys(e).length>0&&ej(t=>({...t,...e}))}catch(e){}},[et]);let eH=()=>{let e=[];return e.push(...Z),c.U.getAll().forEach(t=>{if(t.component){let a=t.component,r=(e=>{switch(e){case"mobile-navigation":return{title:"移动端导航",items:[{id:"home",label:"首页",icon:(0,l.jsx)(b.A,{className:"w-4 h-4"}),href:"/",isActive:!0},{id:"courses",label:"课程",icon:(0,l.jsx)(w.A,{className:"w-4 h-4"}),href:"/courses"},{id:"profile",label:"个人中心",icon:(0,l.jsx)(j.A,{className:"w-4 h-4"}),href:"/profile"},{id:"settings",label:"设置",icon:(0,l.jsx)(p.A,{className:"w-4 h-4"}),href:"/settings"}],showQuickActions:!0};case"pc-toolbar":return{title:"编辑工具栏",showShortcuts:!0,isCollapsed:!1,items:[{id:"save",label:"保存",icon:(0,l.jsx)(N.A,{className:"w-4 h-4"}),shortcut:"Ctrl+S",group:"file"},{id:"edit",label:"编辑",icon:(0,l.jsx)(S.A,{className:"w-4 h-4"}),group:"edit"},{id:"favorite",label:"收藏",icon:(0,l.jsx)(f.A,{className:"w-4 h-4"}),group:"view"}]};case"universal-info":return{title:"平台概况",description:"关键指标总览",showActions:!0,source:"系统统计",items:[{label:"活跃用户",value:12890,type:"number",trend:"up"},{label:"日访问量",value:52340,type:"number",trend:"up"},{label:"转化率",value:3.2,type:"percentage",trend:"stable"},{label:"营收",value:98765,type:"currency",trend:"down"}]};default:return{}}})(t.name);e.push({id:t.name,name:t.displayName||t.name,category:t.category,width:t.width,component:n.createElement(a,{data:r,onAction:(e,t)=>console.log("Card action:",e,t)})})}else{var a;e.push({id:t.name,name:t.displayName||t.name,category:t.category,width:"full",component:(0,l.jsx)(o.AppCard,{className:"p-6 hover:shadow-lg transition-all duration-300",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(k,{className:"w-5 h-5 text-accent"}),(0,l.jsx)("h4",{className:"text-lg font-bold",children:t.displayName||t.name})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"string"==typeof t.businessFlow?t.businessFlow:(null==(a=t.businessFlow)?void 0:a.description)||""}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"状态"}),(0,l.jsx)(i.E,{variant:"outline",className:"text-xs bg-yellow-50 text-yellow-700 border-yellow-200",children:"开发中"})]}),(0,l.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-500",style:{width:"30%"}})}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground",children:["类别：",t.category]}),(0,l.jsx)(s.$,{variant:"outline",size:"sm",className:"w-full bg-transparent",disabled:!0,children:"即将推出"})]})]})})})}}),e},eB=eH(),eF="全部"===em?eB:eB.filter(e=>e.category===em),eq=["全部",...Array.from(new Set(c.U.getAll().map(e=>e.category)))].map(e=>({label:e,icon:({全部:(0,l.jsx)(E.A,{className:"w-4 h-4 mr-2"}),基础:(0,l.jsx)(k,{className:"w-4 h-4 mr-2"}),教育:(0,l.jsx)(w.A,{className:"w-4 h-4 mr-2"}),媒体:(0,l.jsx)(I,{className:"w-4 h-4 mr-2"}),招聘:(0,l.jsx)(C.A,{className:"w-4 h-4 mr-2"}),电商:(0,l.jsx)(_,{className:"w-4 h-4 mr-2"}),内容:(0,l.jsx)(O.A,{className:"w-4 h-4 mr-2"}),社交:(0,l.jsx)(u.A,{className:"w-4 h-4 mr-2"}),数据:(0,l.jsx)(M.A,{className:"w-4 h-4 mr-2"}),零售:(0,l.jsx)(R,{className:"w-4 h-4 mr-2"}),旅行:(0,l.jsx)(D.A,{className:"w-4 h-4 mr-2"}),功能:(0,l.jsx)(P.A,{className:"w-4 h-4 mr-2"})})[e]||(0,l.jsx)(k,{className:"w-4 h-4 mr-2"})})),e$=(0,n.useMemo)(()=>"pc"===g&&"workspace"===t?$["pc-workspace"]:$[t]||$.workspace,[t,g]),eZ=null!=y?y:e$.config.showHeader;return null!=x||e$.config.showBottomNav,(0,l.jsxs)(L.J,{visible:eo,children:[(0,l.jsxs)("div",{className:(0,h.cn)("min-h-screen relative","bg-transparent"),children:[eZ&&"pc"!==g&&(0,l.jsx)(r.AppHeader,{title:v||("education"===e$.type?"教育应用Demo":"/zh/preview"===window.location.pathname?"首页":"自定义动态页面"),showBackButton:A}),eD&&"text"===eD.type&&(0,l.jsx)("div",{className:(0,h.cn)("px-4 mb-2","pc"===g?"hidden":"block",eZ?"pt-16":"pt-2"),children:(0,l.jsx)(G.A,{config:eD,activeIndex:eN,disableNavigate:!0,onSwitchTab:e=>{let{index:t}=e;if("number"==typeof t){var a;try{let e=new URLSearchParams((null==es||null==(a=es.toString)?void 0:a.call(es))||"");0===t?e.delete("tab"):e.set("tab",String(t));let l=e.toString(),n=l?"".concat(ei,"?").concat(l):"".concat(ei);window.history.replaceState(window.history.state,"",n)}catch(e){}eS(t),ek(0)}}})}),eZ&&"pc"!==g&&W&&(0,l.jsx)("div",{className:"fixed top-3 right-20 z-30",children:(0,l.jsx)("a",{href:W,target:"_blank",rel:"noreferrer",children:(0,l.jsx)(s.$,{size:"sm",variant:"secondary",className:"rounded-full h-8 px-3",children:Y||"AI运营"})})}),"workspace"===e$.type&&(0,l.jsxs)("div",{className:(0,h.cn)("relative z-10","pc"===g?"p-6":eD?"p-4 pt-4":"p-4 pt-20"),children:[eP&&"iconText"===eP.type&&(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)(G.A,{config:eP,activeIndex:eA,disableNavigate:!0,onSwitchTab:e=>{let{index:t}=e;if("number"==typeof t){var a;try{let e=new URLSearchParams((null==es||null==(a=es.toString)?void 0:a.call(es))||"");0===t?e.delete("nav"):e.set("nav",String(t));let l=e.toString(),n=l?"".concat(ei,"?").concat(l):"".concat(ei);window.history.replaceState(window.history.state,"",n)}catch(e){}ek(t)}}})}),(0,l.jsx)("div",{className:"mb-6",children:0===et.length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)(k,{className:"w-8 h-8 text-gray-400"})}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"pc"===g?"PC自定义工作台":"自定义动态页面"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"点击右下角 ➕ 按钮添加功能卡片，自定义您的页面"})]}):(0,l.jsx)(d.F,{items:eG.map(e=>{let t,a;return{id:e.id,content:(0,l.jsx)(J.x,{value:e.id,children:(0,l.jsxs)("div",{className:"relative group ".concat("half"===e.width?"w-full":""),children:[eo&&e$.config.allowEdit&&(0,l.jsx)(s.$,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity w-6 h-6 p-0 z-10",onClick:()=>{var t;return t=e.id,void ea(et.filter(e=>e.id!==t))},children:(0,l.jsx)(T.A,{className:"w-3 h-3"})}),eo&&e$.config.allowEdit&&(0,l.jsx)(s.$,{variant:"ghost",size:"sm",className:"absolute top-2 right-10 opacity-0 group-hover:opacity-100 transition-opacity w-6 h-6 p-0 z-10",onClick:()=>(e=>{ef(e),eb(null);try{let e=localStorage.getItem("APPLICATION_CONFIG");if(!e){ex([]),eb("未找到 APPLICATION_CONFIG"),ep(!0);return}let t=JSON.parse(e),a=t&&t.config&&t.config.clientManifest&&t.config.clientManifest.dataSources,l=[];a&&"object"==typeof a&&(l=Object.keys(a).map(e=>({key:e,label:a[e]&&a[e].label||e}))),l.length||eb("dataSources 为空或结构不正确"),ex(l),ep(!0)}catch(e){eb("解析 APPLICATION_CONFIG 失败"),ex([]),ep(!0)}})(e.id),title:"配置数据",children:(0,l.jsx)(p.A,{className:"w-3 h-3"})}),eo&&e$.config.allowEdit&&ew[e.id]&&(0,l.jsx)("div",{className:"absolute top-2 left-2 z-10",children:(0,l.jsx)(i.E,{variant:"secondary",className:"bg-blue-50 text-blue-600 border-blue-200",children:ew[e.id]})}),(t=(()=>{try{let t,a,r,s,i=c.U.getAll().find(t=>t.name===e.type);if(!i||!i.component)return e.component;let o=i.component,d={},m=!!(eD&&"text"===eD.type),h=!!(eP&&"iconText"===eP.type),u=m&&h?"tab-".concat(eN,"::icon-").concat(eA):void 0,p=u||(m?"tab-".concat(eN):h?"icon-".concat(eA):"");if(ee&&p)try{let l=localStorage.getItem("APP_PAGE_".concat(ee)),n=l?JSON.parse(l):{},i=t=>{var a,l;return t?null==n||null==(l=n.overrides)||null==(a=l[t])?void 0:a[e.type]:void 0},c=i(u)||i(p);a=null==c?void 0:c.props,t=null==c?void 0:c.jsx,r=null==c?void 0:c.display,s=null==c?void 0:c.filters}catch(e){}if(t)return(0,l.jsx)(V,{code:t,data:d,props:a,theme:{},className:"w-full"});let g=(()=>{try{if(!(null==s?void 0:s.enabled)||!Array.isArray(null==s?void 0:s.fields))return[];return s.fields.map(e=>{let t=[];if(Array.isArray(e.options)&&"select"===e.type)e.options.forEach(e=>{var a,l,n,r;"string"==typeof e?t.push({label:String(e),value:String(e)}):e&&"object"==typeof e&&t.push({label:null!=(l=e.label)?l:String(null!=(a=e.value)?a:""),value:String(null!=(r=null!=(n=e.value)?n:e.label)?r:"")})});else if(Array.isArray(e.optionsTree)&&"cascader"===e.type){let a=(e,l,n)=>{e.forEach(e=>{var r,s,i,c,o,d;let m=[...l,String(null!=(i=null!=(s=null!=(r=e.name)?r:e.label)?s:e.id)?i:"")],h=[...n,String(null!=(d=null!=(o=null!=(c=e.id)?c:e.value)?o:e.name)?d:"")];Array.isArray(e.children)&&e.children.length>0?a(e.children,m,h):t.push({label:m.join(" / "),value:h.join("/")})})};a(e.optionsTree,[],[])}return 0===t.length&&("select"===e.type?t.push({label:"全部",value:"all"},{label:"选项A",value:"a"},{label:"选项B",value:"b"}):"cascader"===e.type&&t.push({label:"中国 / 北京",value:"cn/bj"},{label:"中国 / 上海",value:"cn/sh"},{label:"美国 / 纽约",value:"us/ny"})),{category:e.label||e.fieldId,options:t,defaultValue:e.default}})}catch(e){return[]}})(),f=eC[e.id]||(()=>{let e={};return g.forEach(t=>{var a;let l=t.defaultValue||(null==(a=t.options[0])?void 0:a.value)||"";e[t.category]=l}),e})(),y=(()=>{let e={};return(null==s?void 0:s.enabled)&&Array.isArray(s.fields)&&s.fields.forEach(t=>{let a=t.label||t.fieldId,l=f[a];null!=l&&(e[t.fieldId||a]=l)}),e})(),x=c.U.getRealData(e.id);(null==s?void 0:s.fields)&&g.length&&g.forEach(e=>{let t=s.fields.find(t=>t.label===e.category);if(e.options.push({value:"none",label:"不限"}),t){let a={};x.forEach(e=>{a[e[t.fieldId]]=t.fieldId}),Object.keys(a).forEach(t=>{e.options.push({value:t,fieldId:a[t],label:t})})}});let v={...a||{},listLimit:r&&r.limit,activeFilters:y};return(0,l.jsxs)("div",{className:"space-y-2",children:[(null==s?void 0:s.enabled)&&g.length>0&&(0,l.jsx)(H.E,{cardId:e.id,items:g,values:f,onValueChange:(t,a)=>{e_(l=>({...l,[e.id]:{...l[e.id]||{},[t]:a}}))}}),n.createElement(o,{data:d,props:v,onAction:(e,t)=>console.log("Card action:",e,t)})]})}catch(t){return e.component}})(),a=e.id,(0,n.isValidElement)(t)?(0,n.cloneElement)(t,{id:a,"data-theme-key":a}):t)]})}),className:(0,h.cn)("pc"===g?"half"===e.width?"col-span-1":"col-span-2 lg:col-span-3":"half"===e.width?"col-span-1":"col-span-2")}}),onReorder:e=>{ea(e.map(e=>et.find(t=>t.id===e)).filter(Boolean))},layout:"grid",className:"pc"===g?"grid grid-cols-2 lg:grid-cols-3 gap-6":"grid grid-cols-2 gap-4",disabled:!eo},ez)}),ec&&e$.config.allowEdit&&(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsx)(s.$,{variant:"outline",className:"flex-1 hover:bg-accent hover:text-accent-foreground",onClick:()=>{eo&&eU(),ed(!eo)},children:eo?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"保存布局"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.A,{className:"w-4 h-4 mr-2"}),"编辑布局"]})})})]},eT),eo&&e$.config.allowEdit&&(0,l.jsx)(s.$,{className:(0,h.cn)("fixed shadow-lg z-30 w-14 h-14 rounded-full bg-accent text-accent-foreground hover:bg-accent/90","pc"===g?"bottom-8 right-8":"bottom-24 right-6"),size:"icon",onClick:()=>er(!0),children:(0,l.jsx)(z.A,{className:"w-6 h-6"})}),en&&eo&&e$.config.allowEdit&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40",onClick:()=>er(!1)}),(0,l.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-xl rounded-t-3xl shadow-2xl max-h-[75vh] overflow-hidden border-t border-white/20",children:[(0,l.jsx)("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto mt-3 mb-4"}),(0,l.jsxs)("div",{className:"px-6 pb-4 border-b border-gray-100/50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"选择功能卡片"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"预览卡片效果，点击添加到工作台"})]}),(0,l.jsx)(s.$,{variant:"ghost",size:"sm",className:"rounded-full w-8 h-8 p-0 hover:bg-gray-100",onClick:()=>er(!1),children:(0,l.jsx)(T.A,{className:"w-4 h-4"})})]}),(0,l.jsx)(m.d,{items:eq,activeItem:em,onItemChange:eh,className:"flex-nowrap overflow-x-auto scrollbar-hide whitespace-nowrap pb-2"})]}),(0,l.jsx)("div",{className:"px-6 py-4 overflow-y-auto max-h-[calc(75vh-180px)]",children:(0,l.jsx)("div",{className:"space-y-4",children:eF.map(e=>{let t=et.some(t=>t.type===e.id);return(0,l.jsx)("div",{className:(0,h.cn)("transition-all duration-300 border rounded-2xl overflow-hidden",t?"bg-gray-50/80 border-gray-200 opacity-60":"bg-white/90 backdrop-blur-sm border-gray-200 hover:shadow-xl hover:scale-[1.02] hover:border-accent cursor-pointer"),onClick:()=>!t&&(e=>{let t=[...et,{id:"".concat(e.id,"-").concat(Date.now()),type:e.id,name:e.name,category:e.category,component:e.component,width:e.width}];ea(t);try{localStorage.setItem(ez,JSON.stringify({cards:eL(t)}))}catch(e){}er(!1)})(e),children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h5",{className:"font-semibold text-base text-gray-900 mb-1",children:e.name}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(i.E,{variant:"outline",className:"text-xs bg-accent/10 text-accent-foreground border-accent/20",children:e.category}),t&&(0,l.jsx)(i.E,{variant:"secondary",className:"text-xs bg-green-50 text-green-700 border-green-200",children:"已添加"})]})]})}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-2 border border-gray-200/50 overflow-hidden",children:(0,l.jsx)("div",{className:"transform scale-[0.7] origin-top-left w-[143%] pointer-events-none",children:(0,l.jsx)("div",{className:"max-h-48 overflow-hidden",children:e.component})})}),(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-white/80 via-transparent to-transparent rounded-xl flex items-end justify-center pb-2",children:(0,l.jsx)("div",{className:"text-xs text-gray-600 font-medium bg-white/90 px-2 py-1 rounded-full",children:"点击添加"})})]})]})},e.id)})})})]})]})]}),(0,l.jsx)(U.lG,{open:eu,onOpenChange:ep,children:(0,l.jsxs)(U.Cf,{className:"max-w-md",children:[(0,l.jsx)(U.c7,{children:(0,l.jsx)(U.L3,{children:"选择数据源"})}),(0,l.jsxs)("div",{className:"mt-2 space-y-2",children:[ev&&(0,l.jsx)("div",{className:"text-sm text-red-600",children:ev}),!ev&&0===ey.length&&(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"暂无可用数据源"}),(0,l.jsx)("div",{className:"grid grid-cols-1 gap-2",children:ey.map(e=>(0,l.jsx)(s.$,{variant:"outline",className:"justify-start",onClick:()=>(e=>{if(eg){console.log(eg,e),ej(t=>({...t,[eg]:e.label}));try{localStorage.setItem("CARD_DS_".concat(eg),JSON.stringify({key:e.key,label:e.label}))}catch(e){}try{let t=(0,B.CV)(),a=et.find(e=>e.id===eg),l=a?c.U.getConfig(a.type):void 0,n=F.g[null==a?void 0:a.type]||{};t.post("aino:data",{card:{id:null==a?void 0:a.id,name:null==a?void 0:a.name,type:null==a?void 0:a.type,config:l?{displayName:l.displayName,category:l.category,width:l.width,businessFlow:l.businessFlow}:void 0},inputs:n,dataSource:{key:e.key,label:e.label},timestamp:Date.now()})}catch(e){}ep(!1)}})(e),children:e.label},e.key))})]})]})})]})}},46393:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},59213:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},70368:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},73607:(e,t,a)=>{a.d(t,{Cf:()=>m,L3:()=>u,c7:()=>h,lG:()=>c});var l=a(89835),n=a(55931),r=a(11353),s=a(68232),i=a(15496);let c=r.bL;r.l9;let o=r.ZL;r.bm;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(r.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});d.displayName=r.hJ.displayName;let m=n.forwardRef((e,t)=>{let{className:a,children:n,...c}=e;return(0,l.jsxs)(o,{children:[(0,l.jsx)(d,{}),(0,l.jsxs)(r.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[n,(0,l.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(s.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};h.displayName="DialogHeader";let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(r.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});u.displayName=r.hE.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(r.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...n})}).displayName=r.VY.displayName},76539:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},76865:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(51894).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])}}]);