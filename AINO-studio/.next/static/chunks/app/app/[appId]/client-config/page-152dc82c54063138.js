(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9046],{5660:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,r:()=>r});var i=a(74364);a(10640);var s=a(4756),l=a(31792),n=a(11915);let r=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:a,size:l,asChild:o=!1,...d}=e,c=o?s.DX:"button";return(0,i.jsx)(c,{"data-slot":"button",className:(0,n.cn)(r({variant:a,size:l,className:t})),...d})}},11484:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var i=a(74364),s=a(10640),l=a(28410),n=a(5660),r=a(25646),o=a(88224),d=a(11286),c=a(57893),p=a(11915);function u(e){let{className:t,...a}=e;return(0,i.jsx)(c.YZ,{"data-slot":"resizable-panel-group",className:(0,p.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})}function h(e){let{...t}=e;return(0,i.jsx)(c.Zk,{"data-slot":"resizable-panel",...t})}function m(e){let{withHandle:t,className:a,...s}=e;return(0,i.jsx)(c.TW,{"data-slot":"resizable-handle",className:(0,p.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...s,children:t&&(0,i.jsx)("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:(0,i.jsx)(d.A,{className:"size-2.5"})})})}var g=a(69494),v=a(56318),x=a(74688),f=a(73475),y=a(6712),j=a(49592),b=a(4002),N=a(64565),w=a(46400),S=a(6651),C=a(29552),z=a(40721),k=a(53107),I=a(96619),T=a(45889),D=a(83075);let _={$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{schemaVersion:{type:"string"},app:{type:"object",properties:{appKey:{type:"string"},locale:{type:"string"},theme:{type:"string"},bottomNav:{type:"array",items:{type:"object",properties:{key:{type:"string"},label:{type:"string"},page:{type:"string"},route:{type:"string"},iconName:{type:"string"}},required:["key","label"]}}},required:["appKey","locale","theme","bottomNav"]},pages:{type:"object"},dataSources:{type:"object"},actions:{type:"object"}},required:["schemaVersion","app"]};var A=a(91650),O=a(8639),E=a(54356),L=a(55132),R=a(47255),P=a(76572),B=a(74395);function $(e){let{open:t,onOpenChange:a,lang:l,pages:r,value:o,onSave:d}=e,[c]=(0,s.useState)("click"),[p,u]=(0,s.useState)("navigate"),[h,m]=(0,s.useState)("internal"),[f,y]=(0,s.useState)(r[0]||"home"),[j,b]=(0,s.useState)(""),[N,w]=(0,s.useState)(""),[S,C]=(0,s.useState)(void 0),[z,k]=(0,s.useState)("");return(0,s.useEffect)(()=>{t&&(o?(u(o.action||"navigate"),m(o.pageType||"internal"),y(o.page||r[0]||"home"),b(o.url||""),w(o.tabKey||""),C("number"==typeof o.tabIndex?o.tabIndex:void 0),k(o.params||"")):(u("navigate"),m("internal"),y(r[0]||"home"),b(""),w(""),C(void 0),k("")))},[t]),(0,i.jsx)(E.lG,{open:t,onOpenChange:a,children:(0,i.jsxs)(E.Cf,{className:"max-w-[560px] w-[92vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===l?"事件配置":"Event Settings"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"事件类型":"Trigger"}),(0,i.jsx)(x.p,{value:"zh"===l?"点击时":"On Click",readOnly:!0})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"执行动作":"Action"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"navigate"===p?"default":"outline",onClick:()=>u("navigate"),children:"zh"===l?"跳转新页面":"Navigate"}),(0,i.jsx)(n.$,{size:"sm",variant:"switchTab"===p?"default":"outline",onClick:()=>u("switchTab"),children:"zh"===l?"当前页面切换":"Switch Tab"})]})]})]}),"navigate"===p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.J,{children:"zh"===l?"页面类型":"Destination"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"internal"===h?"default":"outline",onClick:()=>m("internal"),children:"zh"===l?"内部页面":"Internal"}),(0,i.jsx)(n.$,{size:"sm",variant:"external"===h?"default":"outline",onClick:()=>m("external"),children:"zh"===l?"外部链接":"External"})]})]}),"internal"===h?(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"选择页面":"Select Page"}),(0,i.jsx)("select",{className:"border rounded-md h-9 px-2",value:f,onChange:e=>y(e.target.value),children:r.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]}):(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"外部链接":"External URL"}),(0,i.jsx)(x.p,{placeholder:"https://",value:j,onChange:e=>b(e.target.value)})]})]}):(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"标签标识(可选)":"Tab Key (optional)"}),(0,i.jsx)(x.p,{placeholder:"zh"===l?"例如: overview":"e.g. overview",value:N,onChange:e=>w(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"标签索引(可选)":"Tab Index (optional)"}),(0,i.jsx)(x.p,{type:"number",placeholder:"0",value:"number"==typeof S?String(S):"",onChange:e=>C(""===e.target.value?void 0:Number(e.target.value))})]})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===l?"页面入参 (JSON)":"Params (JSON)"}),(0,i.jsx)(g.T,{rows:3,value:z,onChange:e=>k(e.target.value),placeholder:"zh"===l?'例如: {"tab":1}':'e.g. {"tab":1}'})]})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>a(!1),children:"zh"===l?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:()=>{d("navigate"===p?{trigger:c,action:p,pageType:h,page:"internal"===h?f:void 0,url:"external"===h?j:void 0,params:(null==z?void 0:z.trim())||void 0}:{trigger:c,action:p,tabKey:N||void 0,tabIndex:"number"==typeof S?S:void 0,params:(null==z?void 0:z.trim())||void 0}),a(!1)},children:"zh"===l?"确定":"Save"})]})]})})}let M=(0,D.default)(()=>a.e(5386).then(a.bind(a,55386)).then(e=>e.default),{loadableGenerated:{webpack:()=>[55386]},ssr:!1}),F={type:"object",additionalProperties:!0,properties:{title:{type:["string","object"],properties:{zh:{type:"string"},en:{type:"string"}}},subtitle:{type:["string","object"],properties:{zh:{type:"string"},en:{type:"string"}}},actions:{type:"array",items:{type:"object",properties:{key:{type:"string"},label:{type:"string"},icon:{type:"string"}}}},style:{type:"object",properties:{variant:{type:"string",enum:["plain","soft","elevated"]},radius:{type:"string",enum:["none","sm","md","lg","xl","full"]},elevation:{type:"number",minimum:0,maximum:24},padding:{type:"string",enum:["none","xs","sm","md","lg"]},gap:{type:"string",enum:["none","xs","sm","md","lg"]},colors:{type:"object",properties:{background:{type:"string"},text:{type:"string"},highlight:{type:"string"}}},typography:{type:"object",properties:{titleSize:{type:"string"},bodySize:{type:"string"}}}}},layout:{type:"object",properties:{type:{type:"string"},columns:{type:"number",minimum:1,maximum:4}}},display:{type:"object",properties:{mode:{type:"string",enum:["pick","filter","time","hot"]},limit:{type:["number","null"]},unlimited:{type:"boolean"},sort:{type:"object",properties:{by:{type:"string"},order:{type:"string",enum:["asc","desc"]}}}}},data:{type:"object",properties:{mode:{type:"string",enum:["dynamic","static"]},source:{type:"string"},static:{type:["array","object","null"]}}},render:{type:"object",properties:{item:{type:["object","string"]}}}}},J=()=>'{\n  "title": "",\n  "subtitle": "",\n  "style": {\n    "variant": "plain",\n    "radius": "md",\n    "elevation": 0,\n    "padding": "md",\n    "gap": "md",\n    "colors": { "background": "", "text": "" },\n    "typography": { "titleSize": "base", "bodySize": "sm" }\n  },\n  "layout": { "type": "list", "columns": 1 },\n  "display": { "limit": 1, "mode": "time" },\n  "data": { "mode": "dynamic" },\n  "render": { "item": {} }\n}';function U(){var e,t,a,c,p,D,U,V,K,H,W,G,Z,q,X,Y,Q,ee,et,ea,ei,es,el,en,er,eo,ed,ec,ep,eu,eh,em,eg,ev,ex,ef,ey,ej,eb,eN,ew,eS;let eC=(0,l.useParams)();(0,l.useRouter)();let{locale:ez}=(0,f.Y)(),{toast:ek}=(0,y.dj)(),eI=function(){let[e,t]=s.useState(void 0);return s.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}(),[eT,eD]=(0,s.useState)(eI?"mobile":"pc"),[e_,eA]=(0,s.useState)("zh"===ez?"zh":"en"),[eO,eE]=(0,s.useState)(""),[eL,eR]=(0,s.useState)("preview"),[eP,eB]=(0,s.useState)(""),[e$,eM]=(0,s.useState)(""),[eF,eJ]=(0,s.useState)(!1),eU=(0,s.useRef)(null),eV=(0,s.useRef)(!1),[eK,eH]=(0,s.useState)(!1),[eW,eG]=(0,s.useState)(!1),[eZ,eq]=(0,s.useState)(!0),[eX,eY]=(0,s.useState)(!1),[eQ,e0]=(0,s.useState)("manifest"),[e1,e2]=(0,s.useState)(!1),[e4,e5]=(0,s.useState)(""),[e3,e7]=(0,s.useState)({layoutVariant:"centered",showBackground:!0,backgroundImage:void 0,showLogo:!0,logoImage:void 0,showIntro:!0,introTitle:void 0,introText:void 0,providers:[{key:"phone",label:"zh"===ez?"手机号登录":"Phone",enabled:!0},{key:"wechat",label:"zh"===ez?"微信登录":"WeChat",enabled:!0},{key:"bytedance",label:"zh"===ez?"字节登录":"ByteDance",enabled:!1},{key:"google",label:"zh"===ez?"谷歌登录":"Google",enabled:!0},{key:"apple",label:"zh"===ez?"苹果登录":"Apple",enabled:!0}]}),[e6,e9]=(0,s.useState)({schemaVersion:"1.0",app:{appKey:eC.appId,locale:"zh"===e_?"zh-CN":"en-US",defaultLanguage:"zh"===e_?"zh":"en",theme:"default",bottomNav:[{key:"home",label:"zh"===e_?"首页":"Home",route:"/preview"},{key:"me",label:"zh"===e_?"我的":"Me",route:"/profile"}]},dataSources:{}}),[e8,te]=(0,s.useState)("manifest"),[tt,ta]=(0,s.useState)("home"),[ti,ts]=(0,s.useState)(!1),[tl,tn]=(0,s.useState)([]),[tr,to]=(0,s.useState)(!1),[td,tc]=(0,s.useState)(""),[tp,tu]=(0,s.useState)(null),[th,tm]=(0,s.useState)({}),[tg,tv]=(0,s.useState)({});eC.appId;let[tx,tf]=(0,s.useState)({}),[ty,tj]=(0,s.useState)({}),[tb,tN]=(0,s.useState)({}),[tw,tS]=(0,s.useState)({});async function tC(e){try{var t;let a;if(!e||ty[e])return;let i=String(eC.appId);if(e.startsWith("table:"))a=e.replace(/^table:/,"");else{let t=(e6.dataSources||{})[e];a=null==t?void 0:t.tableId}if(!a){tj(t=>({...t,[e]:[]}));return}let s=await A.api.directoryDefs.getOrCreateDirectoryDefByDirectoryId(a,i),l=null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.id;if(!l){tj(t=>({...t,[e]:[]}));return}let n=await A.api.fields.getFields({directoryId:l,page:1,limit:100}),r=Array.isArray(null==n?void 0:n.data)?n.data:[],o=[];r.map(e=>{var t,a,i;"meta_items"===e.type&&((null===(i=e.schema)||void 0===i?void 0:null===(a=i.metaItemsConfig)||void 0===a?void 0:a.fields)||[]).forEach(t=>{var a;o.push({key:"".concat(e.key,".").concat(t.id)||"",label:"".concat((null==e?void 0:null===(a=e.schema)||void 0===a?void 0:a.label)||e.key||"","-").concat(t.label)})}),o.push({key:String(e.key||""),label:String((null==e?void 0:null===(t=e.schema)||void 0===t?void 0:t.label)||e.key||"")})}),tj(t=>({...t,[e]:o}))}catch(t){tj(t=>({...t,[e]:[]}))}}function tz(e){try{let t=[],a=e=>"String"===e||"Number"===e||"Boolean"===e||"Date"===e||"Time"===e||"Datetime"===e||"RichText"===e||"Image"===e||"Video"===e||"File"===e;return((e,i)=>{if(!e||"object"!=typeof e){i&&t.push(i);return}if(Array.isArray(e)){if(0===e.length){i&&t.push("".concat(i,"[]"));return}let s=e[0];if(a(s)){i&&t.push("".concat(i,"[]"));return}if("object"==typeof s&&s){Object.keys(s).forEach(e=>{let l=s[e];a(l)?t.push("".concat(i,"[].").concat(e)):Array.isArray(l)?t.push("".concat(i,"[].").concat(e,"[]")):"object"==typeof l&&l?Object.keys(l).forEach(a=>{t.push("".concat(i,"[].").concat(e,".").concat(a))}):t.push("".concat(i,"[].").concat(e))});return}i&&t.push("".concat(i,"[]"));return}Object.keys(e).forEach(s=>{let l=e[s],n=i?"".concat(i,".").concat(s):s;if(a(l))t.push(n);else if(Array.isArray(l)){if(0===l.length)t.push("".concat(n,"[]"));else{let e=l[0];a(e)?t.push("".concat(n,"[]")):"object"==typeof e&&e?Object.keys(e).forEach(i=>{let s=e[i];a(s)?t.push("".concat(n,"[].").concat(i)):Array.isArray(s)?t.push("".concat(n,"[].").concat(i,"[]")):"object"==typeof s&&s?Object.keys(s).forEach(e=>{t.push("".concat(n,"[].").concat(i,".").concat(e))}):t.push("".concat(n,"[].").concat(i))}):t.push("".concat(n,"[]"))}}else if("object"==typeof l&&l){let e=Object.keys(l);0===e.length?t.push(n):e.forEach(e=>{let i=l[e];a(i)||"object"!=typeof i?t.push("".concat(n,".").concat(e)):Array.isArray(i)?0===i.length?t.push("".concat(n,".").concat(e,"[]")):a(i[0])?t.push("".concat(n,".").concat(e,"[]")):"object"==typeof i[0]&&i[0]&&Object.keys(i[0]).forEach(a=>{t.push("".concat(n,".").concat(e,"[].").concat(a))}):Object.keys(i).forEach(a=>{t.push("".concat(n,".").concat(e,".").concat(a))})})}else t.push(n)})})(e,""),Array.from(new Set(t))}catch(e){return[]}}function tk(e,t,a){tN(i=>{let s={...i[e]||{},[t]:a};return{...i,[e]:s}})}function tI(e){try{tf(t=>{let a={...t};return delete a[e],a}),tN(t=>{let a={...t};return delete a[e],a}),tS(t=>{let a={...t};return delete a[e],a})}catch(e){}}function tT(e,t){tN(a=>{let i={...a[e]||{}};return void 0!==i[t]&&delete i[t],{...a,[e]:i}})}(0,s.useEffect)(()=>{try{Object.values(tx||{}).forEach(e=>{let t=(null==e?void 0:e.dataSourceKey)?String(e.dataSourceKey):void 0;t&&(e6.dataSources||{})[t]&&!ty[t]&&tC(t);let a=(null==e?void 0:e.tableId)?String(e.tableId):void 0;if(a){let e="table:".concat(a);ty[e]||tC(e)}})}catch(e){}},[tx,ty]),(0,s.useEffect)(()=>{try{let e=Object.entries(tx||{});if(0===e.length)return;tS(t=>{let a={...t};return e.forEach(e=>{let[t,i]=e,s=String((null==i?void 0:i.dataSourceKey)||"");a[t]||(s&&(e6.dataSources||{})[s]?a[t]=s:(null==i?void 0:i.tableId)?a[t]="table:".concat(String(i.tableId)):a[t]="")}),a})}catch(e){}},[tx,null==e6?void 0:e6.dataSources]);let tD=(0,s.useMemo)(()=>{let e=td.trim().toLowerCase();return e?tl.filter(t=>t.name.toLowerCase().includes(e)||t.moduleName.toLowerCase().includes(e)):tl},[tl,td]);async function t_(){if(!tr&&!(tl.length>0)){to(!0);try{let e=String(eC.appId),t=await A.api.applications.getApplicationModules(e),a=t.success&&t.data?t.data.modules:[],i=await Promise.all(a.map(async t=>{try{let a=await A.api.directories.getDirectories({applicationId:e,moduleId:t.id});return(a.success&&a.data&&a.data.directories||[]).filter(e=>"table"===e.type).map(e=>({id:e.id,name:e.name,moduleName:t.name}))}catch(e){return[]}}));tn(i.flat())}finally{to(!1)}}}let[tA,tO]=(0,s.useState)(!1),[tE,tL]=(0,s.useState)(null),[tR,tP]=(0,s.useState)(""),[tB,t$]=(0,s.useState)(!1),[tM,tF]=(0,s.useState)("navigation"),[tJ,tU]=(0,s.useState)("iconText"),[tV,tK]=(0,s.useState)("grid-4"),[tH,tW]=(0,s.useState)([]),[tG,tZ]=(0,s.useState)(!1),[tq,tX]=(0,s.useState)(null),[tY,tQ]=(0,s.useState)(0),[t0,t1]=(0,s.useState)({}),[t2,t4]=(0,s.useState)(""),[t5,t3]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{let a="STUDIO_CLIENT_CFG_".concat(eC.appId),i=window.localStorage.getItem(a);if(i){var e,t;let a=JSON.parse(i);e9(e=>(function(e,t){try{if(!t||"object"!=typeof t)return e;let a={...t};if("__ui"in a)try{delete a.__ui}catch(e){}let i={...e,...a};return i.app={...e.app,...a.app||{}},i.app.appKey=e.app.appKey,i.app.defaultLanguage=i.app.defaultLanguage||e.app.defaultLanguage,i.app.locale=i.app.locale||e.app.locale,Array.isArray(i.app.bottomNav)||(i.app.bottomNav=e.app.bottomNav),a.pages&&(i.pages=a.pages),a.dataSources&&(i.dataSources=a.dataSources),i}catch(t){return e}})(e,a));try{let t=null==a?void 0:null===(e=a.__ui)||void 0===e?void 0:e.activePageKey;t&&e5(String(t))}catch(e){}try{let e=null==a?void 0:null===(t=a.__ui)||void 0===t?void 0:t.pageTabIndex;"number"==typeof e&&tQ(e)}catch(e){}}}catch(e){}finally{eV.current=!0}},[eC.appId]),(0,s.useEffect)(()=>{try{if(!eV.current)return;let e="STUDIO_CLIENT_CFG_".concat(eC.appId),t={...e6,__ui:{activePageKey:e4,pageTabIndex:tY}};window.localStorage.setItem(e,JSON.stringify(t))}catch(e){}},[e6,e4,tY,eC.appId]);let[t7,t6]=(0,s.useState)(""),[t9,t8]=(0,s.useState)(""),[ae,at]=(0,s.useState)('{\n  "title": "",\n  "subtitle": ""\n}'),[aa,ai]=(0,s.useState)({}),[as,al]=(0,s.useState)(""),[an,ar]=(0,s.useState)(null),[ao,ad]=(0,s.useState)("json"),ac=(0,s.useRef)(!1),ap=(0,s.useRef)(null),[au,ah]=(0,s.useState)(!1),[am,ag]=(0,s.useState)(""),[av,ax]=(0,s.useState)(""),[af,ay]=(0,s.useState)("1"),[aj,ab]=(0,s.useState)(!1),[aN,aw]=(0,s.useState)("time"),[aS,aC]=(0,s.useState)(""),[az,ak]=(0,s.useState)(!1);function aI(e){let t=new Set,a=[];for(let i of Array.isArray(e)?e:[]){let e=String((null==i?void 0:i.id)||"")+"::"+String((null==i?void 0:i.title)||"");t.has(e)||(t.add(e),a.push({id:(null==i?void 0:i.id)||"tab-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,7)),title:(null==i?void 0:i.title)||""}))}return a}let[aT,aD]=(0,s.useState)(!1),[a_,aA]=(0,s.useState)(""),[aO,aE]=(0,s.useState)(""),[aL,aR]=(0,s.useState)(""),[aP,aB]=(0,s.useState)(!1),[a$,aM]=(0,s.useState)([]),[aF,aJ]=(0,s.useState)({}),aU=(0,s.useMemo)(()=>Object.entries(e6.dataSources||{}).filter(e=>{let[,t]=e;return t&&"table"===t.type}).map(e=>{let[t,a]=e;return{key:t,tableId:a.tableId,label:a.label||"".concat(a.moduleName||"","/").concat(a.tableName||"")}}),[e6.dataSources]);function aV(){return[{id:"mock_category",key:"category",label:"zh"===e_?"类别":"Category",type:"select",options:[{label:"zh"===e_?"全部":"All",value:"all"},{label:"选项A",value:"a"},{label:"选项B",value:"b"}],optionsTree:[]},{id:"mock_region",key:"region",label:"zh"===e_?"地区":"Region",type:"cascader",options:[],optionsTree:[{id:"cn",name:"zh"===e_?"中国":"China",children:[{id:"bj",name:"zh"===e_?"北京":"Beijing"},{id:"sh",name:"zh"===e_?"上海":"Shanghai"}]},{id:"us",name:"USA",children:[{id:"ny",name:"New York"},{id:"sf",name:"San Francisco"}]}]}]}async function aK(e){try{var t;aB(!0);let a=(e6.dataSources||{})[e];if(!(null==a?void 0:a.tableId)){let e=aV();aM(e),aJ(t=>{let a={...t};return e.forEach(e=>{a[e.key]||(a[e.key]={fieldId:e.key,type:e.type,label:e.label})}),a});return}let i=String(eC.appId),s=await A.api.directoryDefs.getOrCreateDirectoryDefByDirectoryId(a.tableId,i),l=null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.id;if(!l){let e=aV();aM(e),aJ(t=>{let a={...t};return e.forEach(e=>{a[e.key]||(a[e.key]={fieldId:e.key,type:e.type,label:e.label})}),a});return}let n=await A.api.fields.getFields({directoryId:l,page:1,limit:200}),r=(Array.isArray(null==n?void 0:n.data)?n.data:[]).map(e=>{var t,a,i;return{id:e.id,key:e.key,label:(null===(t=e.schema)||void 0===t?void 0:t.label)||e.key,type:e.type,options:(null===(a=e.schema)||void 0===a?void 0:a.options)||[],optionsTree:(null===(i=e.schema)||void 0===i?void 0:i.cascaderOptions)||[]}}).filter(e=>"select"===e.type||"cascader"===e.type),o=r.length>0?r:aV();aM(o),aJ(e=>{let t={...e};return o.forEach(e=>{t[e.key]||(t[e.key]={fieldId:e.key,type:e.type,label:e.label})}),t})}finally{aB(!1)}}async function aH(e){if(!tg[e]&&!th[e]){tv(t=>({...t,[e]:!0}));try{let t=await A.api.records.listRecords(e,{page:1,pageSize:100}),a=(t.success&&t.data?Array.isArray(t.data)?t.data:t.data.records||[]:[]).map(e=>({id:e.id,label:e.name||e.title||e.id,raw:e}));tm(t=>({...t,[e]:a}))}catch(t){tm(t=>({...t,[e]:[]}))}finally{tv(t=>({...t,[e]:!1}))}}}function aW(e){e9(t=>{let a={...t},i={...a.dataSources||{}};return delete i[e],a.dataSources=i,a})}async function aG(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,s=document.createElement("img"),l=await new Promise((t,a)=>{let i=new FileReader;i.onload=()=>t(String(i.result)),i.onerror=a,i.readAsDataURL(e)});await new Promise(e=>{s.onload=e,s.src=l});let n=document.createElement("canvas"),r=Math.min(t/s.width,a/s.height),o=Math.round(s.width*r),d=Math.round(s.height*r);return n.width=o,n.height=d,n.getContext("2d").drawImage(s,0,0,o,d),n.toDataURL("image/jpeg",i)}(0,s.useEffect)(()=>{let e=e=>{let t=e.data;if(t&&"DYN_CARDS"===t.type&&Array.isArray(t.cards))t1(e=>({...e,[t.category]:t.cards})),t4(t.category||"");else if(t&&"OVERRIDE"===t.type){let{pageId:e,sectionKey:a,cardType:i,props:s,jsx:l}=t;try{if(s){let t="pages/p-".concat(e,"/cards/").concat(a,"/").concat(i,".json"),l=JSON.stringify(s||{},null,2);ai(e=>({...e,[t]:l})),as===t&&(ac.current=!0,eE(l),ad("json"),eR("code"))}}catch(e){}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[]),(0,s.useEffect)(()=>{try{let e;e="manifest"===e8?e6:"app"===e8?e6.app||{}:"dataSources"===e8?e6.dataSources||{}:"page"===e8?e6.pages&&e6.pages[tt]||{}:e6,eE(JSON.stringify(e,null,2))}catch(e){eE("{}")}},[e6,e8,tt]),(0,s.useEffect)(()=>{e9(e=>({...e,app:{...e.app,locale:"zh"===e_?"zh-CN":"en-US",bottomNav:e.app.bottomNav.map(e=>"home"===e.key?{...e,label:"zh"===e_?"首页":"Home"}:"me"===e.key?{...e,label:"zh"===e_?"我的":"Me"}:e)}}))},[e_]),(0,s.useEffect)(()=>{e7(e=>({...e,providers:e.providers.map(e=>"phone"===e.key?{...e,label:"zh"===e_?"手机号登录":"Phone"}:"wechat"===e.key?{...e,label:"zh"===e_?"微信登录":"WeChat"}:"bytedance"===e.key?{...e,label:"zh"===e_?"字节登录":"ByteDance"}:"google"===e.key?{...e,label:"zh"===e_?"谷歌登录":"Google"}:"apple"===e.key?{...e,label:"zh"===e_?"苹果登录":"Apple"}:e)}))},[e_]);let[aZ,aq]=(0,s.useState)(!1),[aX,aY]=(0,s.useState)(!1),[aQ,a0]=(0,s.useState)(!1),[a1,a2]=(0,s.useState)(""),[a4,a5]=(0,s.useState)(""),[a3,a7]=(0,s.useState)(""),[a6,a9]=(0,s.useState)("");async function a8(){try{var e;let t=await fetch("http://47.94.52.142:3007/api/preview-manifests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:e6})}),a=await t.json();if(!t.ok||!(null==a?void 0:a.success)||!(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.id))throw Error((null==a?void 0:a.message)||"create failed");let i=a.data.id;eM(i);let s=encodeURIComponent(JSON.stringify((null==e6?void 0:e6.dataSources)||{})),l="http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(i,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(s);eB(l),eR("preview"),ek({description:"zh"===e_?"预览已生成":"Preview created"})}catch(e){ek({description:(null==e?void 0:e.message)||("zh"===e_?"创建预览失败":"Failed to create preview"),variant:"destructive"}),eR("code")}}async function ie(e,t){try{if(!t)try{let e=JSON.parse(eO||"{}");e9(t=>{let a={...t};if("manifest"===e8)Object.assign(a,e);else if("app"===e8)a.app=e;else if("dataSources"===e8)a.dataSources=e;else if("page"===e8){if(an&&as)try{var i,s;let t=an.pageKey.replace(/^p-/,"");as.endsWith(".json")?(null===(i=window.frames[0])||void 0===i||i.postMessage({type:"SET_OVERRIDE",pageId:t,sectionKey:an.sectionKey,cardType:an.cardType,props:e},"*"),ai(t=>({...t,[as]:JSON.stringify(e,null,2)}))):as.endsWith(".tsx")&&(null===(s=window.frames[0])||void 0===s||s.postMessage({type:"SET_OVERRIDE",pageId:t,sectionKey:an.sectionKey,cardType:an.cardType,jsx:eO},"*"),ai(e=>({...e,[as]:eO})))}catch(e){}else a.pages=a.pages||{},a.pages[tt]=e}return a})}catch(e){ek({description:(null==e?void 0:e.message)||("zh"===e_?"JSON 无法解析":"JSON parse error"),variant:"destructive"});return}if(!e$)return a8();let a=null!=e?e:e6,i=await fetch("http://47.94.52.142:3007/api/preview-manifests/".concat(e$),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:a})}),s=await i.json().catch(()=>({}));if(!i.ok||(null==s?void 0:s.success)===!1)throw Error((null==s?void 0:s.message)||"save failed");try{let e=new URL(eP||"http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId));e.searchParams.set("device",eT),e.searchParams.set("appId",String(eC.appId));let t=JSON.stringify((null==e6?void 0:e6.dataSources)||{});e.searchParams.set("data",encodeURIComponent(t)),eB(e.toString())}catch(a){let e=encodeURIComponent(JSON.stringify((null==e6?void 0:e6.dataSources)||{})),t="http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(e);eB(t)}ek({description:"zh"===e_?"已保存并刷新预览":"Saved and refreshed preview"})}catch(e){ek({description:(null==e?void 0:e.message)||("zh"===e_?"保存失败":"Save failed"),variant:"destructive"})}}async function it(){if(!eW){eG(!0);try{let t={...function(e,t,a,i){let s={};try{s=JSON.parse(i||"{}")}catch(e){throw Error((null==e?void 0:e.message)||("zh"===e_?"JSON 无法解析":"JSON parse error"))}let l={...e||{}};return"manifest"===t?Object.assign(l,s):"app"===t?l.app=s:"dataSources"===t?l.dataSources=s:"page"===t&&(l.pages=l.pages||{},l.pages[a]=s),l}(e6,e8,tt,eO),dataMappings:tb,incomingMappings:tx},a=String(eC.appId),i={};try{let e=await A.api.applications.getApplication(a);i=(e.success&&e.data?e.data.config:{})||{}}catch(e){i={}}let s={...i,clientManifest:t},l=await A.api.applications.updateApplication(a,{config:s});if(!l.success)throw Error(l.error||("zh"===e_?"保存到数据库失败":"Save to database failed"));if(e9(t),e$){let e=await fetch("http://47.94.52.142:3007/api/preview-manifests/".concat(e$),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:t})}),a=await e.json().catch(()=>({}));if(!e.ok||(null==a?void 0:a.success)===!1)throw Error((null==a?void 0:a.message)||"save failed");try{let e=new URL(eP||"http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId));e.searchParams.set("device",eT),e.searchParams.set("appId",String(eC.appId));let a=JSON.stringify((null==t?void 0:t.dataSources)||{});e.searchParams.set("data",encodeURIComponent(a)),eB(e.toString())}catch(i){let e=encodeURIComponent(JSON.stringify((null==t?void 0:t.dataSources)||{})),a="http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(e);eB(a)}}else{var e;let a=await fetch("http://47.94.52.142:3007/api/preview-manifests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:t})}),i=await a.json();if(!a.ok||!(null==i?void 0:i.success)||!(null==i?void 0:null===(e=i.data)||void 0===e?void 0:e.id))throw Error((null==i?void 0:i.message)||"create failed");let s=i.data.id;eM(s);let l=encodeURIComponent(JSON.stringify((null==t?void 0:t.dataSources)||{})),n="http://47.94.52.142:3005/".concat(e_,"/preview?previewId=").concat(s,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(l);eB(n)}ek({description:"zh"===e_?"已保存到数据库并刷新预览":"Saved to database and refreshed preview"}),eR("preview")}catch(e){ek({description:(null==e?void 0:e.message)||("zh"===e_?"保存失败":"Save failed"),variant:"destructive"})}finally{eG(!1)}}}return(0,s.useEffect)(()=>{if(eX&&"auth-login"===eQ&&"preview"===eL)try{var e;let t=(null===(e=e6.app)||void 0===e?void 0:e.defaultLanguage)||("zh"===e_?"zh":"en"),a={layoutVariant:e3.layoutVariant||"centered",showBackground:!!e3.showBackground,backgroundImage:e3.backgroundImage||void 0,showLogo:!!e3.showLogo,logoImage:e3.logoImage||void 0,showIntro:!!e3.showIntro,introTitle:e3.introTitle||void 0,introText:e3.introText||void 0,titleColor:e3.titleColor||void 0,bodyColor:e3.bodyColor||void 0,providers:(e3.providers||[]).map(e=>({key:e.key,enabled:!!e.enabled}))},i=new URL("http://47.94.52.142:3005/".concat(t,"/auth/login"));i.searchParams.set("authCfg",JSON.stringify(a)),i.searchParams.set("v",String(Date.now())),eB(i.toString())}catch(e){}},[e3,eX,eQ,eL,null===(e=e6.app)||void 0===e?void 0:e.defaultLanguage,e_]),(0,s.useEffect)(()=>{let e=document.getElementById("my-app-iframe");window.addEventListener("message",function(t){var a,i;let s=t.data||{};if(s&&"object"==typeof s&&s.type&&String(s.type).startsWith("aino:"))switch(s.type){case"aino:ready":console.log("AINO ready:",s.payload);break;case"aino:height":s.payload&&"number"==typeof s.payload.height&&(e.style.height=s.payload.height+"px");break;case"aino:data":try{console.log("aino:data",s.payload),function(e){try{var t,a,i,s,l,n,r,o,d,c;let p=String((null==e?void 0:null===(t=e.card)||void 0===t?void 0:t.id)||""),u=String((null==e?void 0:null===(a=e.card)||void 0===a?void 0:a.name)||""),h=(null==e?void 0:null===(i=e.dataSource)||void 0===i?void 0:i.key)?String(null==e?void 0:null===(s=e.dataSource)||void 0===s?void 0:s.key):void 0,m=(null==e?void 0:null===(l=e.dataSource)||void 0===l?void 0:l.label)?String(null==e?void 0:null===(n=e.dataSource)||void 0===n?void 0:n.label):void 0,g=(null==e?void 0:null===(r=e.dataSource)||void 0===r?void 0:r.tableId)||(null==e?void 0:null===(o=e.dataSource)||void 0===o?void 0:o.id),v=(null==e?void 0:null===(d=e.dataSource)||void 0===d?void 0:d.tableName)||(null==e?void 0:null===(c=e.dataSource)||void 0===c?void 0:c.name),x=(null==e?void 0:e.inputs)&&"object"==typeof e.inputs?e.inputs:{};if(!p)return;let f="".concat(p,"::").concat(h||(g?"table:".concat(g):"unknown"));tf(e=>({...e,[f]:{cardType:p,cardName:u,dataSourceKey:h,dataSourceLabel:m,tableId:g?String(g):void 0,tableName:v?String(v):void 0,inputs:x,timestamp:Date.now()}}))}catch(e){}}(s.payload)}catch(e){}break;case"aino:manifest":console.log("AINO manifest:",null===(a=s.payload)||void 0===a?void 0:a.manifest);break;case"aino:error":console.warn("AINO error:",null===(i=s.payload)||void 0===i?void 0:i.message);break;case"aino:custom":console.log("AINO custom:",s.payload)}},!1)},[]),(0,s.useEffect)(()=>{"preview"!==eL||eP||a8()},[eL]),(0,s.useEffect)(()=>{if(e1)try{let e=String(e4||"");if(!e)return;let t=e6.pages&&e6.pages[e]||{},a=String(eP||"http://47.94.52.142:3005/".concat(e_,"/p/").concat(e.replace(/^p-/,"")));fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json().catch(()=>null)).then(e=>{var t;let i=e&&(e.id||(null===(t=e.data)||void 0===t?void 0:t.id)),s=new URL(a);i&&s.searchParams.set("cfgId",String(i)),eB(s.toString()),eR("preview")}).catch(()=>{let e=new URL(a);eB(e.toString()),eR("preview")})}catch(e){}},[e1]),(0,s.useEffect)(()=>{if(eP)try{let e=new URL(eP);e.searchParams.set("device",eT);let t=e.pathname.split("/");t.length>=3&&(t[1]=e_,e.pathname=t.join("/")),eB(e.toString())}catch(e){}},[eT,e_]),(0,s.useEffect)(()=>{let e=!0;return async function(){eq(!0);try{let a=String(eC.appId),i=await A.api.applications.getApplication(a),s=i.success&&i.data?i.data.config:null,l=null==s?void 0:s.clientManifest;if(e&&l&&"object"==typeof l){try{var t;let e=null==l?void 0:null===(t=l.app)||void 0===t?void 0:t.locale;"string"==typeof e&&(/^zh/i.test(e)?eA("zh"):/^en/i.test(e)&&eA("en"))}catch(e){}try{let e=Object.keys((null==l?void 0:l.pages)||{});e.length>0&&ta(e[0])}catch(e){}e9(l);try{tN(l.dataMappings||{})}catch(e){}try{tf(l.incomingMappings||{})}catch(e){}"preview"===eL&&setTimeout(()=>{a8()},0)}}catch(e){}finally{e&&eq(!1)}}(),()=>{e=!1}},[eC.appId]),(0,i.jsxs)("main",{className:"h-[100dvh] overflow-hidden bg-gradient-to-br from-white via-blue-50 to-green-50",children:[(0,i.jsx)("div",{className:"max-w-[100rem] mx-auto p-3 h-full",children:(0,i.jsx)(r.Zp,{className:"p-0 overflow-hidden h-full",children:(0,i.jsxs)(u,{direction:"horizontal",className:"h-full",children:[(0,i.jsx)(h,{defaultSize:22,minSize:18,className:"bg-white",children:(0,i.jsx)("div",{className:"h-full overflow-y-auto p-3 space-y-3",children:eX||e1?e1?(0,i.jsxs)("div",{className:"h-full overflow-y-auto p-1 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{e2(!1),e0("preview"),eR("preview");try{var e;let t=(null===(e=e6.app)||void 0===e?void 0:e.defaultLanguage)||"zh",a=encodeURIComponent(JSON.stringify((null==e6?void 0:e6.dataSources)||{})),i="http://47.94.52.142:3005/".concat(t,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(a);eB(i)}catch(e){}},children:[(0,i.jsx)(C.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"返回":"Back"]}),(0,i.jsx)("div",{className:"text-sm font-semibold",children:"zh"===e_?"页面配置":"Page Settings"}),e4&&(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/pages/",e4,".json"]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"页面名称":"Page Title"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)(x.p,{placeholder:"zh"===e_?"中文标题":"Title ZH",value:e4&&(null===(c=e6.pages)||void 0===c?void 0:null===(a=c[e4])||void 0===a?void 0:null===(t=a.title)||void 0===t?void 0:t.zh)||"",onChange:e=>e9(t=>{let a={...t};a.pages=a.pages||{};let i=a.pages[e4]||{};return i.title={...i.title||{},zh:e.target.value},a.pages[e4]=i,a})}),(0,i.jsx)(x.p,{placeholder:"zh"===e_?"英文标题":"Title EN",value:e4&&(null===(U=e6.pages)||void 0===U?void 0:null===(D=U[e4])||void 0===D?void 0:null===(p=D.title)||void 0===p?void 0:p.en)||"",onChange:e=>e9(t=>{let a={...t};a.pages=a.pages||{};let i=a.pages[e4]||{};return i.title={...i.title||{},en:e.target.value},a.pages[e4]=i,a})})]}),(0,i.jsx)("div",{className:"text-[10px] text-muted-foreground",children:"zh"===e_?"保存后右侧预览页标题会跟随显示":"Title applies to header after save"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,i.jsx)("span",{children:"zh"===e_?"开启 顶部栏":"Show Header"}),(0,i.jsx)(L.d,{checked:!!(e4&&(null===(H=e6.pages)||void 0===H?void 0:null===(K=H[e4])||void 0===K?void 0:null===(V=K.options)||void 0===V?void 0:V.showHeader)!==!1),onCheckedChange:e=>e9(t=>{let a={...t};a.pages=a.pages||{};let i=a.pages[e4]||{};return i.options={...i.options||{},showHeader:!!e},a.pages[e4]=i,a})})]}),(0,i.jsx)("div",{})]}),(0,i.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["zh"===e_?"顶部标签栏（开启顶部栏后可用）":"Top Tabs (requires header)"," "]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-3",children:(0,i.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,i.jsx)("span",{children:"zh"===e_?"开启 顶部标签栏":"Enable Top Tabs"}),(0,i.jsx)(L.d,{checked:!!(e4&&(null===(Z=e6.pages)||void 0===Z?void 0:null===(G=Z[e4])||void 0===G?void 0:null===(W=G.topBar)||void 0===W?void 0:W.enabled)),onCheckedChange:e=>e9(t=>{var a,i;let s={...t};s.pages=s.pages||{};let l=s.pages[e4]||{};return l.topBar={...l.topBar||{},enabled:!!e,tabs:Array.isArray(null===(a=l.topBar)||void 0===a?void 0:a.tabs)?null===(i=l.topBar)||void 0===i?void 0:i.tabs:[]},s.pages[e4]=l,s})})]})}),!!(null===(Y=e6.pages)||void 0===Y?void 0:null===(X=Y[e4])||void 0===X?void 0:null===(q=X.topBar)||void 0===q?void 0:q.enabled)&&(0,i.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,i.jsx)("div",{className:"flex items-center gap-8 overflow-x-auto flex-nowrap",children:aI((null===(eS=e6.pages)||void 0===eS?void 0:null===(ew=eS[e4])||void 0===ew?void 0:null===(eN=ew.topBar)||void 0===eN?void 0:eN.tabs)||[]).map((e,t)=>(0,i.jsxs)("button",{className:"relative text-lg flex-shrink-0 ".concat(tY===t?"text-primary":"text-foreground"),onClick:()=>tQ(t),children:[e.title||"".concat("zh"===e_?"标签栏":"").concat(t+1),tY===t&&(0,i.jsx)("span",{className:"absolute left-0 right-0 -bottom-1 mx-auto block h-1 w-20 bg-primary rounded-full"})]},"tabkey-".concat((null==e?void 0:e.id)||t)))}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{aC(""),ak(!0)},children:"zh"===e_?"增加/管理":"Add/Manage"})})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"内容导航配置":"Content Navigation"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:function(){try{var e,t;let a;let i=e6.pages&&e6.pages[e4]||{};if(null==i?void 0:null===(e=i.topBar)||void 0===e?void 0:e.enabled){let e=i.tabContent||{};a=(null==e?void 0:null===(t=e[tY])||void 0===t?void 0:t.contentNav)||{}}else a=(null==i?void 0:i.contentNav)||{};let s=a.style||("text"===a.type?"text":(a.type,"icon"));tF("status"===a.category?"status":"navigation"),tU("text"===s?"text":"iconText"),tK(a.layout||"grid-4"),tW(Array.isArray(a.items)?a.items:[]),t$(!0)}catch(e){tF("navigation"),tU("iconText"),tK("grid-4"),tW([]),t$(!0)}},children:"zh"===e_?"配置内容导航":"Configure"}),e4&&(null===(ee=e6.pages)||void 0===ee?void 0:null===(Q=ee[e4])||void 0===Q?void 0:Q.contentNav)&&(0,i.jsxs)("div",{className:"text-[11px] text-muted-foreground",children:[(null===(ea=e6.pages[e4])||void 0===ea?void 0:null===(et=ea.contentNav)||void 0===et?void 0:et.type)==="iconText"?"zh"===e_?"图+文":"Icon+Text":"zh"===e_?"文字":"Text"," \xb7 ",(null===(es=e6.pages[e4])||void 0===es?void 0:null===(ei=es.contentNav)||void 0===ei?void 0:ei.layout)||"-"," \xb7 ",Array.isArray(null===(en=e6.pages[e4])||void 0===en?void 0:null===(el=en.contentNav)||void 0===el?void 0:el.items)?null===(eo=e6.pages[e4])||void 0===eo?void 0:null===(er=eo.contentNav)||void 0===er?void 0:er.items.length:0," ","zh"===e_?"项":"items"]})]}),(()=>{try{var e,t,a,i;let s=(null===(e=e6.pages)||void 0===e?void 0:e[e4])||{},l=(null==s?void 0:null===(t=s.topBar)||void 0===t?void 0:t.enabled)?null==s?void 0:null===(i=s.tabContent)||void 0===i?void 0:null===(a=i[tY])||void 0===a?void 0:a.contentNav:null==s?void 0:s.contentNav;return!!l&&"text"===l.style}catch(e){return!1}})()&&(0,i.jsx)("div",{className:"mt-2 px-1",children:(0,i.jsx)("div",{className:"flex items-center gap-6 overflow-x-auto scrollbar-hide",children:((null===(ec=e6.pages[e4])||void 0===ec?void 0:null===(ed=ec.contentNav)||void 0===ed?void 0:ed.items)||[]).map((e,t)=>(0,i.jsxs)("button",{className:"relative pb-1 text-sm ".concat(tY===t?"text-primary":"text-muted-foreground hover:text-foreground"),onClick:()=>{tQ(t);try{var e;let a=(null===(e=e6.pages)||void 0===e?void 0:e[e4])||{},i=String(eP||"http://47.94.52.142:3005/".concat(e_,"/p/").concat(e4.replace(/^p-/,"")));fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json().catch(()=>null)).then(e=>{var a;let s=e&&(e.id||(null===(a=e.data)||void 0===a?void 0:a.id)),l=new URL(i);s&&l.searchParams.set("cfgId",String(s)),l.searchParams.set("tab",String(t)),eB(l.toString())}).catch(()=>{let e=new URL(i);e.searchParams.set("tab",String(t)),eB(e.toString())}),eR("preview")}catch(e){}},children:[(null==e?void 0:e.title)||"".concat("zh"===e_?"标签":"Tab"," ").concat(t+1),tY===t&&(0,i.jsx)("span",{className:"absolute left-1/2 -translate-x-1/2 -bottom-0.5 h-0.5 w-6 bg-primary rounded-full"})]},t))})}),(()=>{try{var e,t,a,i;let s=(null===(e=e6.pages)||void 0===e?void 0:e[e4])||{},l=(null==s?void 0:null===(t=s.topBar)||void 0===t?void 0:t.enabled)?null==s?void 0:null===(i=s.tabContent)||void 0===i?void 0:null===(a=i[tY])||void 0===a?void 0:a.contentNav:null==s?void 0:s.contentNav;return!!l&&"icon"===l.style}catch(e){return!1}})()&&(0,i.jsxs)("div",{className:"mt-2 px-1",children:[(0,i.jsx)("div",{className:"text-[11px] text-muted-foreground mb-1",children:"zh"===e_?"点击图标以切换配置的卡片区域":"Click icon to switch section being configured"}),(0,i.jsx)("div",{className:"flex items-center gap-5 overflow-x-auto scrollbar-hide py-2",children:((null===(eu=e6.pages[e4])||void 0===eu?void 0:null===(ep=eu.contentNav)||void 0===ep?void 0:ep.items)||[]).map((e,t)=>(0,i.jsxs)("button",{className:"flex flex-col items-center gap-1 ".concat(tY===t?"text-primary":"text-foreground"),onClick:()=>{tQ(t);try{var e;let a=(null===(e=e6.pages)||void 0===e?void 0:e[e4])||{},i=String(eP||"http://47.94.52.142:3005/".concat(e_,"/p/").concat(e4.replace(/^p-/,"")));fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json().catch(()=>null)).then(e=>{var a;let s=e&&(e.id||(null===(a=e.data)||void 0===a?void 0:a.id)),l=new URL(i);s&&l.searchParams.set("cfgId",String(s)),l.searchParams.set("tab",String(t)),eB(l.toString())}).catch(()=>{let e=new URL(i);e.searchParams.set("tab",String(t)),eB(e.toString())}),eR("preview")}catch(e){}},children:[(0,i.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 border border-gray-200"}),(0,i.jsx)("div",{className:"text-xs opacity-70",children:(null==e?void 0:e.title)||"Item ".concat(t+1)})]},t))})]})]}),(0,i.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"数据定义":"Data Sources"}),(0,i.jsxs)(n.$,{variant:"secondary",size:"sm",onClick:()=>ts(!0),children:[(0,i.jsx)(N.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"添加数据":"Add Data"]})]}),(0,i.jsxs)("div",{className:"space-y-1 max-h-40 overflow-auto pr-1",children:[0===Object.entries(e6.dataSources||{}).length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===e_?"尚未添加数据源":"No data sources yet"}),Object.entries(e6.dataSources||{}).map(e=>{let[t,a]=e;return(0,i.jsxs)("div",{className:"flex items-center gap-2 border rounded-md px-2 py-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,i.jsx)(w.A,{className:"w-3.5 h-3.5"}),(0,i.jsx)("span",{className:"font-medium",children:(null==a?void 0:a.label)||t})]}),(0,i.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-600",children:null==a?void 0:a.type}),(0,i.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>aW(t),children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]})]},t)})]})]}),(0,i.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,i.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[(0,i.jsx)("span",{children:"zh"===e_?"数据映射":"Field Mapping"}),(0,i.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"zh"===e_?"将卡片入参字段映射到所选数据源表字段":"Map card input fields to table fields"})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[0===Object.entries(tx||{}).length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===e_?"等待子页面选择数据源后将自动出现映射项":"Mappings will appear after selecting data source in preview"}),Object.entries(tx||{}).map(e=>{var t;let[a,s]=e,l=tz(s.inputs||{}),r=tw[a]||s.dataSourceKey||"",o=ty[r]||[],d=tb[a]||{};return(0,i.jsxs)("div",{className:"border rounded-md p-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("div",{className:"text-xs font-medium",children:[s.cardName||s.cardType," → ",(0,i.jsx)("span",{className:"text-muted-foreground",children:(null===(t=(e6.dataSources||{})[r])||void 0===t?void 0:t.label)||s.dataSourceLabel||r||"-"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"text-[10px] text-muted-foreground",children:new Date(s.timestamp).toLocaleString()}),(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>tI(a),children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]})]}),0===l.length?(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"暂无卡片入参字段":"No input fields"}):(0,i.jsx)("div",{className:"grid grid-cols-2 gap-2",children:l.map(e=>{var t;return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"text-xs w-40 truncate",title:e,children:e}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsxs)(P.l6,{disabled:0===o.length||!r,value:o.length>0&&null!==(t=d[e])&&void 0!==t?t:void 0,onValueChange:t=>tk(a,e,t),children:[(0,i.jsx)(P.bq,{className:"max-w-[80px] w-full truncate",children:(0,i.jsx)(P.yv,{placeholder:"zh"===e_?"选择字段":"Choose field"})}),(0,i.jsx)(P.gC,{children:0===o.length?(0,i.jsx)(P.eb,{disabled:!0,value:"__no_fields__",children:"zh"===e_?"（无可用字段）":"(no fields)"}):o.map(e=>(0,i.jsx)(P.eb,{value:String(e.key),children:e.label||String(e.key)},String(e.key)))})]})}),(0,i.jsx)(n.$,{size:"sm",variant:"ghost",onClick:()=>tT(a,e),title:"zh"===e_?"清除该字段映射":"Clear mapping",children:(0,i.jsx)(S.A,{className:"w-4 h-4"})})]},"".concat(a,"::").concat(e))})})]},a)})]})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"主内容":"Main Content"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(t0[t2]||[]).map(e=>(0,i.jsxs)("div",{className:"px-3 py-2 rounded-xl border bg-white flex items-center justify-between",children:[(0,i.jsx)("span",{className:"truncate text-sm text-foreground",children:e.displayName||e.type}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{try{var t,a,i;let s=null===(a=e6.pages)||void 0===a?void 0:null===(t=a[e4])||void 0===t?void 0:t.topBar,l=(null==s?void 0:s.enabled)?"tab-".concat(tY):"icon-".concat(tY),n="pages/".concat(e4,"/cards/").concat(l,"/").concat(e.type,".json");null===(i=window.frames[0])||void 0===i||i.postMessage({type:"GET_OVERRIDE",pageId:e4.replace(/^p-/,""),sectionKey:l,cardType:e.type},"*"),setTimeout(()=>{let t=aa[n]||J();eE(t),te("page"),eR("code"),al(n),ar({pageKey:e4,sectionKey:l,cardType:e.type}),ad("json")},100)}catch(e){}},children:"zh"===e_?"配置":"Config"}),(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{ag(e.displayName||e.type),ax(e.type),ah(!0),ay("1"),ab(!1),aw("time")},children:"zh"===e_?"显示":"Display"}),(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{try{var t,a,i,s;let l=null===(a=e6.pages)||void 0===a?void 0:null===(t=a[e4])||void 0===t?void 0:t.topBar,n=(null==l?void 0:l.enabled)?"tab-".concat(tY):"icon-".concat(tY);aA(e.displayName||e.type),aE(e.type);let r=(null===(i=aU[0])||void 0===i?void 0:i.key)||"",o=aL||r;aR(o),aK(o),null===(s=window.frames[0])||void 0===s||s.postMessage({type:"GET_OVERRIDE",pageId:e4.replace(/^p-/,""),sectionKey:n,cardType:e.type},"*"),aD(!0)}catch(e){}},children:"zh"===e_?"筛选":"Filter"}),(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{try{var t,a,i,s;let l=null===(a=e6.pages)||void 0===a?void 0:null===(t=a[e4])||void 0===t?void 0:t.topBar,n=(null==l?void 0:l.enabled)?"tab-".concat(tY):"icon-".concat(tY),r=(null===(s=e6.pages)||void 0===s?void 0:null===(i=s[e4])||void 0===i?void 0:i.innerPages)&&e6.pages[e4].innerPages[n]&&e6.pages[e4].innerPages[n][e.type];e9(t=>{let a={...t};if(a.pages=a.pages||{},!r){let t="p-".concat(Date.now().toString(36));r=t,a.pages[t]={title:{zh:"".concat(e.displayName||e.type,"内页"),en:"".concat(e.displayName||e.type," Detail")},layout:"mobile",route:"/".concat(t),options:{showBack:!0},cards:[]};let i=a.pages[e4]||{};i.innerPages=i.innerPages||{},i.innerPages[n]=i.innerPages[n]||{},i.innerPages[n][e.type]=t,a.pages[e4]=i}return a}),setTimeout(()=>{try{let t=e6.pages&&e6.pages[r]||{title:{zh:"".concat(e.displayName||e.type,"内页"),en:"".concat(e.displayName||e.type," Detail")},layout:"mobile",route:"/".concat(r)},a={...t,options:{...(null==t?void 0:t.options)||{},showBack:!0}};fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json().catch(()=>null)).then(e=>{var t;let a=e&&(e.id||(null===(t=e.data)||void 0===t?void 0:t.id)),i=new URL("http://47.94.52.142:3005/".concat(e_,"/p/").concat(String(r).replace(/^p-/,"")));a&&i.searchParams.set("cfgId",String(a)),eB(i.toString())}).catch(()=>{let e=new URL("http://47.94.52.142:3005/".concat(e_,"/p/").concat(String(r).replace(/^p-/,"")));eB(e.toString())}),e5(String(r)),e2(!0),eR("preview")}catch(e){}},0)}catch(e){}},children:"zh"===e_?"内页":"Inner"})]})]},e.type)),(!t0[t2]||0===t0[t2].length)&&(0,i.jsx)("div",{className:"text-xs opacity-60",children:"zh"===e_?"右侧新增卡片后，将自动出现在这里以配置显示":"New cards added on the right will appear here for display config."})]}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"其他卡片":"Other Cards"})]}),(0,i.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,i.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,i.jsx)("span",{children:"zh"===e_?"开启 全局底部导航":"Show Bottom Nav"}),(0,i.jsx)(L.d,{checked:!!(e4&&(null===(eg=e6.pages)||void 0===eg?void 0:null===(em=eg[e4])||void 0===em?void 0:null===(eh=em.options)||void 0===eh?void 0:eh.showBottomNav)!==!1),onCheckedChange:e=>e9(t=>{let a={...t};a.pages=a.pages||{};let i=a.pages[e4]||{};return i.options={...i.options||{},showBottomNav:!!e},a.pages[e4]=i,a})})]}),(0,i.jsx)(n.$,{size:"sm",className:"w-full",onClick:()=>{try{var e;let t=(null===(e=e6.pages)||void 0===e?void 0:e[e4])||{},a=String(eP||"http://47.94.52.142:3005/".concat(e_,"/p/").concat(e4.replace(/^p-/,"")));fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json().catch(()=>null)).then(e=>{var t;let i=e&&(e.id||(null===(t=e.data)||void 0===t?void 0:t.id)),s=new URL(a);i&&s.searchParams.set("cfgId",String(i)),eB(s.toString())}).catch(()=>{let e=new URL(a);eB(e.toString())}),eR("preview")}catch(e){}},children:"zh"===e_?"保留浏览":"Keep Preview"})]})]}):(0,i.jsxs)("div",{className:"h-full p-1 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{eY(!1),e0("preview"),eR("preview");try{var e;let t=(null===(e=e6.app)||void 0===e?void 0:e.defaultLanguage)||"zh",a=encodeURIComponent(JSON.stringify((null==e6?void 0:e6.dataSources)||{})),i="http://47.94.52.142:3005/".concat(t,"/preview?previewId=").concat(e$,"&device=").concat(eT,"&appId=").concat(eC.appId,"&data=").concat(a);eB(i)}catch(e){}},children:[(0,i.jsx)(C.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"返回":"Back"]}),(0,i.jsx)("div",{className:"text-sm font-semibold",children:"zh"===e_?"登录配置":"Login Settings"})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"布局模式":"Layout"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"centered"===e3.layoutVariant?"default":"outline",onClick:()=>e7(e=>({...e,layoutVariant:"centered"})),children:"zh"===e_?"居中":"Centered"}),(0,i.jsx)(n.$,{size:"sm",variant:"bottomDocked"===e3.layoutVariant?"default":"outline",onClick:()=>e7(e=>({...e,layoutVariant:"bottomDocked"})),children:"zh"===e_?"底部承载":"Bottom"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"显示元素":"Visibility"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,i.jsx)("span",{className:"mr-2",children:"zh"===e_?"背景":"Background"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>aq(!0),disabled:!e3.showBackground,children:"zh"===e_?"上传":"Upload"}),(0,i.jsx)(L.d,{checked:e3.showBackground,onCheckedChange:e=>e7(t=>({...t,showBackground:!!e}))})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,i.jsx)("span",{className:"mr-2",children:"logo"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>aY(!0),disabled:!e3.showLogo,children:"zh"===e_?"上传":"Upload"}),(0,i.jsx)(L.d,{checked:e3.showLogo,onCheckedChange:e=>e7(t=>({...t,showLogo:!!e}))})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2 col-span-2",children:[(0,i.jsx)("span",{className:"mr-2",children:"zh"===e_?"介绍":"Intro"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>{var e,t,a,i,s,l;a2((null===(e=e3.introTitle)||void 0===e?void 0:e.zh)||(null===(t=e3.introTitle)||void 0===t?void 0:t.en)||""),a5((null===(a=e3.introText)||void 0===a?void 0:a.zh)||(null===(i=e3.introText)||void 0===i?void 0:i.en)||""),a7((null===(s=e3.introTitle)||void 0===s?void 0:s.en)||""),a9((null===(l=e3.introText)||void 0===l?void 0:l.en)||""),a0(!0)},disabled:!e3.showIntro,children:"zh"===e_?"编辑":"Edit"}),(0,i.jsx)(L.d,{checked:e3.showIntro,onCheckedChange:e=>e7(t=>({...t,showIntro:!!e}))})]})]})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"文本设置":"Text Settings"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"标题颜色":"Title Color"}),(0,i.jsx)(x.p,{type:"color",value:e3.titleColor||"#111111",onChange:e=>e7(t=>({...t,titleColor:e.target.value}))})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"内容颜色":"Body Color"}),(0,i.jsx)(x.p,{type:"color",value:e3.bodyColor||"#6b7280",onChange:e=>e7(t=>({...t,bodyColor:e.target.value}))})]})]})]}),(0,i.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"登录方式":"Login Methods"}),(0,i.jsx)("div",{className:"space-y-2",children:e3.providers.map((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-[20px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",draggable:"phone"!==e.key,onDragStart:a=>{"phone"!==e.key&&a.dataTransfer.setData("text/plain",String(t))},onDragOver:t=>{"phone"!==e.key&&t.preventDefault()},onDrop:a=>{if("phone"===e.key)return;a.preventDefault();let i=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(i)||i===t||0===i||0===t||e7(e=>{let a=[...e.providers],[s]=a.splice(i,1);return a.splice(t,0,s),{...e,providers:a}})},children:[(0,i.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center opacity-70",children:(0,i.jsx)(d.A,{className:"w-4 h-4"})}),(0,i.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,i.jsx)(L.d,{checked:e.enabled,onCheckedChange:a=>e7(i=>({...i,providers:i.providers.map((i,s)=>s===t?{...i,enabled:"phone"===e.key||!!a}:i)})),disabled:"phone"===e.key})]},e.key))})]})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"text-sm font-semibold",children:"zh"===e_?"配置/构建":"Config/Build"}),(0,i.jsx)(o.tU,{value:"config",className:"-mr-2",children:(0,i.jsxs)(o.j7,{children:[(0,i.jsx)(o.Xi,{value:"config",children:"zh"===e_?"配置":"Config"}),(0,i.jsx)(o.Xi,{value:"ai",disabled:!0,children:"zh"===e_?"AI 对话（稍后）":"AI (later)"})]})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"默认语言（应用）":"Default Language (App)"}),(0,i.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gray-50 rounded-md p-1 border",children:[(0,i.jsx)(n.$,{size:"sm",variant:"zh"===e6.app.defaultLanguage?"default":"ghost",onClick:()=>{e9(e=>({...e,app:{...e.app,defaultLanguage:"zh",locale:"zh-CN"}}))},children:"中文"}),(0,i.jsx)(n.$,{size:"sm",variant:"en"===e6.app.defaultLanguage?"default":"ghost",onClick:()=>{e9(e=>({...e,app:{...e.app,defaultLanguage:"en",locale:"en-US"}}))},children:"EN"})]})]}),!1,(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"底部导航（最多5项）":"Bottom Nav (max 5)"}),(0,i.jsxs)("div",{className:"space-y-2",children:[e6.app.bottomNav.map((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-[20px_1fr_auto_auto_auto] items-center gap-2",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",String(t))},onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();let a=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(a)||a===t||e9(e=>{let i=[...e.app.bottomNav],[s]=i.splice(a,1);return i.splice(t,0,s),{...e,app:{...e.app,bottomNav:i}}})},children:[(0,i.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center",children:(0,i.jsx)(d.A,{className:"w-4 h-4"})}),(0,i.jsx)(x.p,{value:e.label,onChange:e=>e9(a=>({...a,app:{...a.app,bottomNav:a.app.bottomNav.map((a,i)=>i===t?{...a,label:e.target.value}:a)}})),placeholder:"zh"===e_?"名称":"Label"}),(0,i.jsxs)(n.$,{variant:"secondary",size:"sm",onClick:()=>{let t=(e.route||"").replace(/^\//,"")||e.key;if(t){var a,i;try{let i=(null===(a=e.route)||void 0===a?void 0:a.startsWith("/"))?e.route:"/".concat(t),s=new URL("http://47.94.52.142:3005/".concat(e_).concat(i));eB(s.toString())}catch(s){let a=(null===(i=e.route)||void 0===i?void 0:i.startsWith("/"))?e.route:"/".concat(t);eB("http://47.94.52.142:3005/".concat(e_).concat(a))}e5(t),e2(!0),eR("preview")}else ek({description:"zh"===e_?"请先设置路由":"Set route first"})},children:[(0,i.jsx)(j.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"配置":"Config"]}),(0,i.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>{e9(e=>{let a={...e,app:{...e.app,bottomNav:e.app.bottomNav.filter((e,a)=>a!==t)}};return setTimeout(()=>{ie(a,!0)},0),a})},children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]},e.key)),e6.app.bottomNav.length<5&&(0,i.jsx)(n.$,{variant:"secondary",onClick:()=>e9(e=>{let t="k".concat(Date.now()),a="/p-".concat(t),i={...e};i.app={...i.app,bottomNav:[...i.app.bottomNav,{key:t,label:"zh"===e_?"新项":"Item",route:a}]};let s=(a||"").replace(/^\//,"")||"p-".concat(t);return i.pages=i.pages||{},i.pages[s]||(i.pages[s]={title:{zh:"新页面",en:"New Page"},layout:"mobile",route:a,cards:[]}),i}),children:"zh"===e_?"添加项":"Add Item"})]})]}),(0,i.jsx)("div",{className:"pt-2",children:(0,i.jsx)(n.$,{className:"w-full justify-center",variant:"secondary",onClick:()=>{eY(!0),e0("auth-login"),eR("preview");try{var e;let t=(null===(e=e6.app)||void 0===e?void 0:e.defaultLanguage)||"zh",a={layoutVariant:e3.layoutVariant||"centered",showBackground:!!e3.showBackground,backgroundImage:e3.backgroundImage||void 0,showLogo:!!e3.showLogo,logoImage:e3.logoImage||void 0,showIntro:!!e3.showIntro,introTitle:e3.introTitle||void 0,introText:e3.introText||void 0,titleColor:e3.titleColor||void 0,bodyColor:e3.bodyColor||void 0,providers:(e3.providers||[]).map(e=>({key:e.key,enabled:!!e.enabled}))},i=new URL("http://47.94.52.142:3005/".concat(t,"/auth/login"));i.searchParams.set("authCfg",JSON.stringify(a)),i.searchParams.set("v",String(Date.now())),eB(i.toString())}catch(e){}},children:"zh"===e_?"登录配置":"Login Settings"})}),(0,i.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"数据定义":"Data Sources"}),(0,i.jsxs)(n.$,{variant:"secondary",size:"sm",onClick:()=>ts(!0),children:[(0,i.jsx)(N.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"添加数据":"Add Data"]})]}),(0,i.jsxs)("div",{className:"space-y-1 max-h-40 overflow-auto pr-1",children:[0===Object.entries(e6.dataSources||{}).length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===e_?"尚未添加数据源":"No data sources yet"}),Object.entries(e6.dataSources||{}).map(e=>{let[t,a]=e;return(0,i.jsxs)("div",{className:"flex items-center gap-2 border rounded-md px-2 py-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,i.jsx)(w.A,{className:"w-3.5 h-3.5"}),(0,i.jsx)("span",{className:"font-medium",children:(null==a?void 0:a.label)||t})]}),(0,i.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-600",children:null==a?void 0:a.type}),(0,i.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>aW(t),children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]})]},t)})]})]}),(0,i.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,i.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[(0,i.jsx)("span",{children:"zh"===e_?"数据映射":"Field Mapping"}),(0,i.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"zh"===e_?"将卡片入参字段映射到所选数据源表字段":"Map card input fields to table fields"})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[0===Object.entries(tx||{}).length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===e_?"等待子页面选择数据源后将自动出现映射项":"Mappings will appear after selecting data source in preview"}),Object.entries(tx||{}).map(e=>{var t;let[a,s]=e,l=tz(s.inputs||{}),r=tw[a]||s.dataSourceKey||"",o=ty[r]||[],d=tb[a]||{};return(0,i.jsxs)("div",{className:"border rounded-md p-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("div",{className:"text-xs font-medium",children:[s.cardName||s.cardType," → ",(0,i.jsx)("span",{className:"text-muted-foreground",children:(null===(t=(e6.dataSources||{})[r])||void 0===t?void 0:t.label)||s.dataSourceLabel||r||"-"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"text-[10px] text-muted-foreground",children:new Date(s.timestamp).toLocaleString()}),(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>tI(a),children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]})]}),0===l.length?(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"暂无卡片入参字段":"No input fields"}):(0,i.jsx)("div",{className:"grid grid-cols-2 gap-2",children:l.map(e=>{var t;return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"text-xs w-40 truncate",title:e,children:e}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsxs)(P.l6,{disabled:0===o.length||!r,value:o.length>0&&null!==(t=d[e])&&void 0!==t?t:void 0,onValueChange:t=>tk(a,e,t),children:[(0,i.jsx)(P.bq,{className:"max-w-[80px] w-full truncate",children:(0,i.jsx)(P.yv,{placeholder:"zh"===e_?"选择字段":"Choose field"})}),(0,i.jsx)(P.gC,{children:0===o.length?(0,i.jsx)(P.eb,{disabled:!0,value:"__no_fields__",children:"zh"===e_?"（无可用字段）":"(no fields)"}):o.map(e=>(0,i.jsx)(P.eb,{value:String(e.key),children:e.label||String(e.key)},String(e.key)))})]})}),(0,i.jsx)(n.$,{size:"sm",variant:"ghost",onClick:()=>tT(a,e),title:"zh"===e_?"清除该字段映射":"Clear mapping",children:(0,i.jsx)(S.A,{className:"w-4 h-4"})})]},"".concat(a,"::").concat(e))})})]},a)})]})]})]})})}),(0,i.jsx)(E.lG,{open:ti,onOpenChange:ts,children:(0,i.jsxs)(E.Cf,{className:"max-w-[880px] w-[95vw] max-h-[80vh] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"选择数据源":"Choose Data Source"})}),(0,i.jsxs)("div",{className:"p-0",children:[(0,i.jsx)("div",{className:"p-3 text-xs text-muted-foreground",children:"zh"===e_?"可选择整张表作为数据源，或展开表选择某条记录作为数据源。":"Choose a whole table or expand to pick a specific record."}),(0,i.jsxs)("div",{className:"px-3 pb-3 flex items-center gap-3",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(x.p,{placeholder:"zh"===e_?"搜索表/模块":"Search tables/modules",value:td,onChange:e=>tc(e.target.value),className:"pl-8 w-64"}),(0,i.jsx)(z.A,{className:"w-4 h-4 absolute left-2 top-2.5 text-gray-400"})]}),(0,i.jsx)(n.$,{variant:"outline",onClick:t_,disabled:tr,children:"zh"===e_?"刷新":"Refresh"})]}),(0,i.jsx)("div",{className:"px-3 pb-3",children:(0,i.jsx)(O.F,{className:"h-[52vh] border rounded-lg",children:(0,i.jsxs)("div",{className:"divide-y",children:[tr&&(0,i.jsx)("div",{className:"p-4 text-sm text-muted-foreground",children:"zh"===e_?"加载中...":"Loading..."}),!tr&&0===tD.length&&(0,i.jsx)("div",{className:"p-4 text-sm text-muted-foreground",children:"zh"===e_?"暂无数据表":"No tables found"}),tD.map(e=>{let t=tp===e.id,a=th[e.id],s=!!tg[e.id];return(0,i.jsxs)("div",{className:"p-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{className:"p-1 rounded hover:bg-gray-100",onClick:async()=>{let a=t?null:e.id;tu(a),a&&await aH(e.id)},"aria-label":t?"collapse":"expand",children:t?(0,i.jsx)(k.A,{className:"w-4 h-4"}):(0,i.jsx)(I.A,{className:"w-4 h-4"})}),(0,i.jsx)(w.A,{className:"w-4 h-4 text-blue-600"}),(0,i.jsx)("div",{className:"font-medium",children:e.name}),(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/ ",e.moduleName]}),(0,i.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",onClick:()=>(function(e){let t="table_".concat(e.id);e9(a=>{let i={...a};return i.dataSources=i.dataSources||{},i.dataSources[t]={type:"table",tableId:e.id,tableName:e.name,moduleName:e.moduleName,label:"".concat(e.moduleName,"/").concat(e.name)},i}),ts(!1)})(e),children:"zh"===e_?"整表":"Whole Table"}),(0,i.jsx)(n.$,{variant:"secondary",size:"sm",onClick:async()=>{tu(e.id),await aH(e.id)},children:"zh"===e_?"选择记录":"Pick Record"})]})]}),t&&(0,i.jsxs)("div",{className:"mt-2 ml-7",children:[s&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground p-2",children:"zh"===e_?"加载记录...":"Loading records..."}),!s&&(a&&a.length>0?(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a.map(t=>(0,i.jsxs)("div",{className:"border rounded-md px-2 py-1.5 flex items-center gap-2",children:[(0,i.jsx)(T.A,{className:"w-3.5 h-3.5 text-gray-500"}),(0,i.jsx)("div",{className:"text-sm truncate",title:t.label,children:t.label}),(0,i.jsx)("div",{className:"ml-auto",children:(0,i.jsx)(n.$,{size:"sm",onClick:()=>(function(e,t){let a="record_".concat(e.id,"_").concat(t.id);e9(i=>{let s={...i};return s.dataSources=s.dataSources||{},s.dataSources[a]={type:"record",tableId:e.id,tableName:e.name,moduleName:e.moduleName,recordId:t.id,label:"".concat(e.moduleName,"/").concat(e.name,"#").concat(t.label)},s}),ts(!1)})(e,t),children:"zh"===e_?"选择":"Select"})})]},t.id))}):(0,i.jsx)("div",{className:"text-xs text-muted-foreground p-2",children:"zh"===e_?"暂无记录":"No records"}))]})]},e.id)})]})})})]}),(0,i.jsx)(E.Es,{children:(0,i.jsx)(n.$,{variant:"outline",onClick:()=>ts(!1),children:"zh"===e_?"关闭":"Close"})})]})}),(0,i.jsx)($,{open:tG,onOpenChange:tZ,lang:e_,pages:Object.keys(e6.pages||{home:{}}),value:(()=>{if(null==tq)return;let e=tH[tq];return null==e?void 0:e.event})(),onSave:e=>{null!=tq&&tW(t=>t.map((t,a)=>a===tq?{...t,event:e}:t))}}),(0,i.jsx)(E.lG,{open:tB,onOpenChange:t$,children:(0,i.jsxs)(E.Cf,{className:"max-w-[760px] w-[95vw] max-h-[85vh] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"内容导航配置":"Content Navigation"})}),(0,i.jsx)(O.F,{className:"max-h-[62vh] pr-2",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"展示样式":"Display Type"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"iconText"===tJ?"default":"outline",onClick:()=>tU("iconText"),children:"zh"===e_?"图+文":"Icon+Text"}),(0,i.jsx)(n.$,{size:"sm",variant:"text"===tJ?"default":"outline",onClick:()=>tU("text"),children:"zh"===e_?"文字":"Text"})]})]}),"iconText"===tJ&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"排版":"Layout"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{size:"sm",variant:"grid-4"===tV?"default":"outline",onClick:()=>tK("grid-4"),children:"zh"===e_?"每行4个":"4 per row"}),(0,i.jsx)(n.$,{size:"sm",variant:"grid-5"===tV?"default":"outline",onClick:()=>tK("grid-5"),children:"zh"===e_?"每行5个":"5 per row"}),(0,i.jsx)(n.$,{size:"sm",variant:"scroll"===tV?"default":"outline",onClick:()=>tK("scroll"),children:"zh"===e_?"横向滑动":"Horizontal scroll"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"导航项":"Items"}),(0,i.jsxs)("div",{className:"space-y-2",children:[tH.map((e,t)=>(0,i.jsxs)("div",{className:"iconText"===tJ?"grid grid-cols-[20px_56px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2":"grid grid-cols-[20px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",String(t))},onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let a=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(a)||a===t||tW(e=>{let i=[...e],[s]=i.splice(a,1);return i.splice(t,0,s),i})},children:[(0,i.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center opacity-70",children:(0,i.jsx)(d.A,{className:"w-4 h-4"})}),"iconText"===tJ&&(0,i.jsx)("div",{className:"flex items-center gap-2",children:e.image?(0,i.jsx)("img",{src:e.image,alt:"icon",className:"w-12 h-12 rounded border object-cover"}):(0,i.jsx)("div",{className:"w-12 h-12 rounded border bg-gray-50 text-[10px] flex items-center justify-center text-gray-400",children:"img"})}),(0,i.jsx)(x.p,{placeholder:"zh"===e_?"标题(中文/英文皆可)":"Title",value:e.title||"",onChange:e=>tW(a=>a.map((a,i)=>i===t?{...a,title:e.target.value}:a))}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["iconText"===tJ&&(0,i.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>(function(e){try{let t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async t=>{try{var a;let i=null===(a=t.target.files)||void 0===a?void 0:a[0];if(!i)return;let s=await aG(i,256,256,.9);tW(t=>t.map((t,a)=>a===e?{...t,image:s}:t))}catch(e){}},t.click()}catch(e){}})(t),children:"zh"===e_?"上传图片":"Upload"}),(0,i.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>{tX(t),tZ(!0)},children:"zh"===e_?"事件":"Event"}),(0,i.jsx)(n.$,{size:"icon",variant:"ghost",onClick:()=>tW(e=>e.filter((e,a)=>a!==t)),children:(0,i.jsx)(b.A,{className:"w-4 h-4"})})]})]},t)),(0,i.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>tW(e=>[...e,{title:""}]),children:[(0,i.jsx)(N.A,{className:"w-4 h-4 mr-1"}),"zh"===e_?"新增导航":"Add Item"]})]})]})]})}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>t$(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:function(){e9(e=>{var t;let a={...e};a.pages=a.pages||{};let i=a.pages[e4]||{},s={category:tM,style:"text"===tJ?"text":"icon",layout:"iconText"===tJ?tV:void 0,items:tH};if(null==i?void 0:null===(t=i.topBar)||void 0===t?void 0:t.enabled){let e=i.tabContent||{},t=e[tY]||{};e[tY]={...t,contentNav:s},i.tabContent=e}else i.contentNav=s;return a.pages[e4]=i,a}),t$(!1)},children:"zh"===e_?"保存":"Save"})]})]})}),(0,i.jsx)(m,{withHandle:!0}),(0,i.jsx)(h,{defaultSize:50,minSize:35,className:"bg-gray-50",children:(0,i.jsxs)("div",{className:"h-full p-3 flex flex-col gap-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)(o.tU,{value:eL,onValueChange:e=>(function(e){if("preview"===e){var t,a;if("auth-login"===eQ){let e=(null===(t=e6.app)||void 0===t?void 0:t.defaultLanguage)||("zh"===e_?"zh":"en");eB("http://47.94.52.142:3005/".concat(e,"/auth/login")),eR("preview")}else if("home"===eQ){let e=(null===(a=e6.app)||void 0===a?void 0:a.defaultLanguage)||("zh"===e_?"zh":"en");eB("http://47.94.52.142:3005/".concat(e,"/home")),eR("preview")}else a8()}else eR("code")})(e),children:(0,i.jsxs)(o.j7,{children:[(0,i.jsx)(o.Xi,{value:"preview",children:"zh"===e_?"预览":"Preview"}),(0,i.jsx)(o.Xi,{value:"code",children:"zh"===e_?"代码":"Code"})]})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.$,{variant:"default",onClick:it,disabled:eW,children:eW?"zh"===e_?"保存中...":"Saving...":"zh"===e_?"保存":"Save"}),(0,i.jsx)(n.$,{onClick:a8,children:"zh"===e_?eP?"刷新预览":"生成预览":eP?"Refresh":"Generate"}),(0,i.jsx)(n.$,{variant:"outline",disabled:!0,title:"zh"===e_?"PC 预览稍后提供":"PC preview later",children:"PC"}),(0,i.jsx)(n.$,{variant:"mobile"===eT?"default":"outline",onClick:()=>eD("mobile"),children:"Mobile"}),(0,i.jsx)(n.$,{variant:"outline",onClick:()=>eA("zh"===e_?"en":"zh"),children:"zh"===e_?"中/EN":"EN/中"}),(0,i.jsx)("a",{href:"http://47.94.52.142:3007/docs/apps/".concat(eC.appId,"/swagger"),target:"_blank",rel:"noreferrer",children:(0,i.jsx)(n.$,{variant:"secondary",children:"API"})})]})]}),"code"===eL?(0,i.jsx)("div",{className:"flex-1 min-h-[520px]",children:(0,i.jsxs)(u,{direction:"horizontal",className:"h-full",children:[(0,i.jsxs)(h,{defaultSize:20,minSize:14,className:"bg-white border rounded-xl overflow-auto",children:[(0,i.jsx)("div",{className:"p-2 text-xs text-muted-foreground",children:"zh"===e_?"文件":"Files"}),(0,i.jsxs)("div",{className:"px-2 pb-2 space-y-1",children:[(0,i.jsx)(n.$,{variant:"manifest"===e8?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>te("manifest"),children:"manifest.json"}),(0,i.jsx)(n.$,{variant:"app"===e8?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>te("app"),children:"app.json"}),(0,i.jsx)("div",{className:"pt-1 text-[10px] uppercase tracking-wide text-muted-foreground",children:"zh"===e_?"页面":"Pages"}),(0,i.jsx)("div",{className:"space-y-1",children:Object.keys(e6.pages||{}).map(e=>(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)(n.$,{variant:"page"!==e8||tt!==e||as?"ghost":"default",className:"w-full justify-start text-xs",onClick:()=>{ta(e),al(""),ar(null),ad("json"),te("page")},children:["pages/",e,".json"]}),(()=>{let t="pages/".concat(e,"/cards/"),a=Object.keys(aa).filter(e=>e.startsWith(t));return 0===a.length?null:(0,i.jsx)("div",{className:"ml-2 pl-2 border-l space-y-1",children:a.sort().map(a=>{let s=a.slice(t.length).split("/");if(s.length<2)return null;let l=s[0],r=s.slice(1).join("/");if(r.endsWith(".tsx"))return null;let o=as===a;return(0,i.jsxs)(n.$,{variant:o?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>{try{let t=a.endsWith(".tsx")?"typescript":"json";ta(e),al(a);let i=r.replace(/\.tsx$|\.json$/,""),s=i.includes(".")?i.split(".")[0]:i;ar({pageKey:e,sectionKey:l,cardType:s}),ad(t),eE(aa[a]||""),eR("code"),te("page")}catch(e){}},children:["cards/",l,"/",r]},a)})})})()]},e))}),(0,i.jsx)("div",{className:"pt-1 text-[10px] uppercase tracking-wide text-muted-foreground",children:"data"}),(0,i.jsx)(n.$,{variant:"dataSources"===e8?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>te("dataSources"),children:"data-sources.json"})]})]}),(0,i.jsx)(m,{withHandle:!0}),(0,i.jsx)(h,{defaultSize:80,minSize:40,children:(0,i.jsx)(M,{height:"100%",defaultLanguage:ao,language:ao,theme:"vs",value:eO,onChange:e=>{let t=e||"";eE(t),as&&(ap.current&&clearTimeout(ap.current),ap.current=setTimeout(()=>{try{if(ai(e=>({...e,[as]:t})),an){var e,a;let i=an.pageKey.replace(/^p-/,"");if(as.endsWith(".json")){if(ac.current){ac.current=!1;return}let a=JSON.parse(t||"{}");null===(e=window.frames[0])||void 0===e||e.postMessage({type:"SET_OVERRIDE",pageId:i,sectionKey:an.sectionKey,cardType:an.cardType,props:a},"*")}else as.endsWith(".tsx")&&(null===(a=window.frames[0])||void 0===a||a.postMessage({type:"SET_OVERRIDE",pageId:i,sectionKey:an.sectionKey,cardType:an.cardType,jsx:t},"*"))}}catch(e){}},300))},options:{wordWrap:"on",minimap:{enabled:!1},formatOnPaste:!0,formatOnType:!0,tabSize:2},onMount:function(e,t){eU.current=e;try{t.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!0,schemas:[{uri:"aino://manifest.schema.json",fileMatch:["*"],schema:_},{uri:"aino://card.schema.json",fileMatch:["**/pages/*/cards/**/*.json"],schema:F}]})}catch(e){}eJ(!0)}})})]})}):(0,i.jsx)("div",{className:"flex-1 border rounded-xl bg-white overflow-hidden",children:eP?(0,i.jsx)("iframe",{id:"my-app-iframe",src:"".concat(eP,"&isEdite=true"),className:"w-full h-full"}):(0,i.jsx)("div",{className:"h-full flex items-center justify-center text-xs text-muted-foreground",children:"zh"===e_?"点击上方预览按钮生成预览":"Switch to Preview to generate"})})]})})]})})}),(0,i.jsx)(B.O,{open:eK,onOpenChange:eH,appId:String(eC.appId),lang:e_}),(0,i.jsx)(E.lG,{open:aZ,onOpenChange:aq,children:(0,i.jsxs)(E.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"上传背景图":"Upload Background"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"建议尺寸：1080\xd71920（9:16）":"Suggested: 1080\xd71920 (9:16)"}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let i=await aG(a,1080,1920,.82);e7(e=>({...e,backgroundImage:i,showBackground:!0})),aq(!1)}}),e3.backgroundImage&&(0,i.jsx)("img",{src:e3.backgroundImage,alt:"bg",className:"mt-2 rounded-md border max-h-64 object-cover"})]}),(0,i.jsx)(E.Es,{children:(0,i.jsx)(n.$,{variant:"outline",onClick:()=>aq(!1),children:"zh"===e_?"关闭":"Close"})})]})}),(0,i.jsx)(E.lG,{open:az,onOpenChange:ak,children:(0,i.jsxs)(E.Cf,{className:"max-w-[560px] w-[96vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"标签管理":"Manage Tabs"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-end gap-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"新增标签名称":"New Tab Title"}),(0,i.jsx)(x.p,{value:aS,onChange:e=>aC(e.target.value),placeholder:"zh"===e_?"例如：推荐":"e.g. Featured"})]}),(0,i.jsx)(n.$,{onClick:()=>{try{let e=(aS||"").trim();if(!e)return;let t="tab-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,7));e9(a=>{var i;let s={...a};s.pages=s.pages||{};let l=s.pages[e4]||{},n=Array.isArray(null===(i=l.topBar)||void 0===i?void 0:i.tabs)?l.topBar.tabs:[],r=aI([...Array.isArray(n)?n:[],{id:t,title:e}]);return l.topBar={...l.topBar||{enabled:!0},tabs:r},s.pages[e4]=l,s}),aC("")}catch(e){}},children:"zh"===e_?"新增":"Add"})]}),0===((null===(ef=e6.pages)||void 0===ef?void 0:null===(ex=ef[e4])||void 0===ex?void 0:null===(ev=ex.topBar)||void 0===ev?void 0:ev.tabs)||[]).length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"暂无标签，请先新增":"No tabs yet. Add one first."}),aI((null===(eb=e6.pages)||void 0===eb?void 0:null===(ej=eb[e4])||void 0===ej?void 0:null===(ey=ej.topBar)||void 0===ey?void 0:ey.tabs)||[]).map((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-[24px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",children:[(0,i.jsx)("div",{className:"text-xs",children:t+1}),(0,i.jsx)(x.p,{className:"h-8",value:e.title||"",onChange:e=>e9(a=>{var i,s;let l={...a};l.pages=l.pages||{};let n=l.pages[e4]||{},r=aI(Array.isArray(null===(i=n.topBar)||void 0===i?void 0:i.tabs)?n.topBar.tabs:[]);return r[t]={...r[t]||{},title:e.target.value,id:(null===(s=r[t])||void 0===s?void 0:s.id)||"tab-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,7))},n.topBar={...n.topBar||{enabled:!0},tabs:r},l.pages[e4]=n,l})}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(n.$,{size:"icon",variant:"ghost",onClick:()=>e9(e=>{var a;let i={...e};i.pages=i.pages||{};let s=i.pages[e4]||{},l=aI(Array.isArray(null===(a=s.topBar)||void 0===a?void 0:a.tabs)?s.topBar.tabs:[]);if(t>0){let e=l[t-1];l[t-1]=l[t],l[t]=e}return s.topBar={...s.topBar||{enabled:!0},tabs:l},i.pages[e4]=s,i}),children:"↑"}),(0,i.jsx)(n.$,{size:"icon",variant:"ghost",onClick:()=>e9(e=>{var a;let i={...e};i.pages=i.pages||{};let s=i.pages[e4]||{},l=aI(Array.isArray(null===(a=s.topBar)||void 0===a?void 0:a.tabs)?s.topBar.tabs:[]);if(t<l.length-1){let e=l[t+1];l[t+1]=l[t],l[t]=e}return s.topBar={...s.topBar||{enabled:!0},tabs:l},i.pages[e4]=s,i}),children:"↓"}),(0,i.jsx)(n.$,{size:"icon",variant:"ghost",onClick:()=>e9(e=>{var a;let i={...e};i.pages=i.pages||{};let s=i.pages[e4]||{},l=aI(Array.isArray(null===(a=s.topBar)||void 0===a?void 0:a.tabs)?s.topBar.tabs:[]);return l.splice(t,1),s.topBar={...s.topBar||{enabled:!0},tabs:l},i.pages[e4]=s,i}),children:"✕"})]})]},"mgr-".concat(e.id||t)))]}),(0,i.jsx)(E.Es,{children:(0,i.jsx)(n.$,{onClick:()=>ak(!1),children:"zh"===e_?"完成":"Done"})})]})}),(0,i.jsx)(E.lG,{open:aT,onOpenChange:aD,children:(0,i.jsxs)(E.Cf,{className:"max-w-[880px] w-[96vw] max-h-[85vh] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"筛选设置：".concat(a_):"Filters: ".concat(a_)})}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"数据源（表）":"Data Source (Table)"}),(0,i.jsx)("div",{className:"w-80",children:(0,i.jsxs)(P.l6,{value:aL,onValueChange:e=>{aR(e),aK(e)},children:[(0,i.jsx)(P.bq,{children:(0,i.jsx)(P.yv,{placeholder:"zh"===e_?"选择数据源":"Choose data source"})}),(0,i.jsx)(P.gC,{children:aU.map(e=>(0,i.jsx)(P.eb,{value:e.key,children:e.label||e.key},e.key))})]})}),0===aU.length&&(0,i.jsx)("div",{className:"text-[11px] text-muted-foreground",children:"zh"===e_?"请先在左侧添加数据源（整表）。":"Add a table data source first on the left."})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"可作为筛选的字段（单选/级联）":"Filterable fields (select/cascader)"}),(0,i.jsx)(O.F,{className:"max-h-[40vh] border rounded-md",children:(0,i.jsxs)("div",{className:"p-3 space-y-2",children:[aP&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"加载中...":"Loading..."}),!aP&&0===a$.length&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"无可用字段（请在字段管理中配置 select/cascader）。":"No fields available (configure select/cascader in Fields)."}),a$.map(e=>{var t;let a=!!(null===(t=aF[e.key])||void 0===t?void 0:t.__checked);return(0,i.jsxs)("div",{className:"grid grid-cols-[20px_1fr] items-center gap-2 border rounded-md px-2 py-2",children:[(0,i.jsx)(R.S,{checked:a,onCheckedChange:t=>aJ(a=>({...a,[e.key]:{...a[e.key]||{fieldId:e.key,type:e.type,label:e.label},__checked:!!t}}))}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,i.jsx)("span",{className:"text-[10px] text-muted-foreground",children:e.type})]})]},e.key)})]})}),(0,i.jsx)("div",{className:"text-[11px] text-muted-foreground",children:"zh"===e_?"多选字段，仅用于决定出现哪些筛选标签，不在此输入默认值。":"Multi-select fields to show as filter tags; no defaults here."})]})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>aD(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:()=>{try{var e,t,a;let i=null===(t=e6.pages)||void 0===t?void 0:null===(e=t[e4])||void 0===e?void 0:e.topBar,s=(null==i?void 0:i.enabled)?"tab-".concat(tY):"icon-".concat(tY),l=a$.filter(e=>{var t;return null===(t=aF[e.key])||void 0===t?void 0:t.__checked}).map(e=>({fieldId:e.key,type:e.type,label:e.label,options:"select"===e.type?Array.isArray(e.options)?e.options:[]:void 0,optionsTree:"cascader"===e.type?Array.isArray(e.optionsTree)?e.optionsTree:[]:void 0})),n={enabled:!0,dataSourceKey:aL||void 0,fields:l},r=aO||"";null===(a=window.frames[0])||void 0===a||a.postMessage({type:"SET_OVERRIDE",pageId:e4.replace(/^p-/,""),sectionKey:s,cardType:r,filters:n},"*");let o="pages/".concat(e4,"/cards/").concat(s,"/").concat(r,".json"),d=aa[o];if(d)try{let e={...JSON.parse(d||"{}"),filters:n},t=JSON.stringify(e,null,2);ai(e=>({...e,[o]:t})),as===o&&(ac.current=!0,eE(t))}catch(e){}aD(!1)}catch(e){}},children:"zh"===e_?"保存":"Save"})]})]})}),(0,i.jsx)(E.lG,{open:au,onOpenChange:ah,children:(0,i.jsxs)(E.Cf,{className:"max-w-[720px] w-[96vw] bg-white/70 backdrop-blur-md rounded-2xl shadow-xl",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{className:"text-base font-semibold",children:"zh"===e_?"显示设置：".concat(am):"Display: ".concat(am)})}),(0,i.jsxs)("div",{className:"space-y-5",children:[(0,i.jsxs)("div",{className:"rounded-xl border p-4 bg-white/60",children:[(0,i.jsx)("div",{className:"text-sm font-medium mb-3",children:"zh"===e_?"显示数量":"Limit"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(x.p,{type:"number",min:1,value:af,onChange:e=>ay(e.target.value),className:"w-28"}),(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,i.jsx)(L.d,{checked:aj,onCheckedChange:e=>ab(!!e)}),(0,i.jsx)("span",{children:"zh"===e_?"无限显示":"Unlimited"})]})]}),(0,i.jsx)("div",{className:"text-[11px] text-muted-foreground mt-2",children:"zh"===e_?"数量越大渲染越多，可能影响性能":"Larger limits may affect performance"})]}),(0,i.jsxs)("div",{className:"rounded-xl border p-4 bg-white/60",children:[(0,i.jsx)("div",{className:"text-sm font-medium mb-3",children:"zh"===e_?"展示来源":"Source"}),(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,i.jsx)(n.$,{size:"sm",variant:"pick"===aN?"default":"outline",onClick:()=>aw("pick"),children:"zh"===e_?"指定内容":"Pick"}),(0,i.jsx)(n.$,{size:"sm",variant:"filter"===aN?"default":"outline",onClick:()=>aw("filter"),children:"zh"===e_?"按过滤":"Filter"}),(0,i.jsx)(n.$,{size:"sm",variant:"time"===aN?"default":"outline",onClick:()=>aw("time"),children:"zh"===e_?"按时间":"Time"}),(0,i.jsx)(n.$,{size:"sm",variant:"hot"===aN?"default":"outline",onClick:()=>aw("hot"),children:"zh"===e_?"按热度":"Hot"})]}),"pick"===aN&&(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:"zh"===e_?"选择具体内容（占位，后续接数据选择器）":"Pick specific items (placeholder)"}),"filter"===aN&&(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,i.jsx)(x.p,{placeholder:"zh"===e_?"关键字":"Keyword"}),(0,i.jsx)(x.p,{placeholder:"zh"===e_?"类别（占位）":"Category (placeholder)"}),(0,i.jsx)(x.p,{placeholder:"zh"===e_?"标签（占位）":"Tags (placeholder)"})]}),"time"===aN&&(0,i.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(0,i.jsx)("div",{className:"text-muted-foreground",children:"zh"===e_?"按时间降序":"Newest first"})}),"hot"===aN&&(0,i.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(0,i.jsx)("div",{className:"text-muted-foreground",children:"zh"===e_?"按热度降序":"Hotness desc"})})]})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>ah(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:()=>{try{var e,t,a;let i=null===(t=e6.pages)||void 0===t?void 0:null===(e=t[e4])||void 0===e?void 0:e.topBar,s=(null==i?void 0:i.enabled)?"tab-".concat(tY):"icon-".concat(tY),l=aj?void 0:Math.max(1,parseInt(af||"1",10)),n={mode:aN,limit:l,unlimited:!!aj},r=av||"";null===(a=window.frames[0])||void 0===a||a.postMessage({type:"SET_OVERRIDE",pageId:e4.replace(/^p-/,""),sectionKey:s,cardType:r,display:n},"*");let o="pages/".concat(e4,"/cards/").concat(s,"/").concat(r,".json"),d=aa[o];if(d)try{let e={...JSON.parse(d||"{}"),display:n},t=JSON.stringify(e,null,2);ai(e=>({...e,[o]:t})),as===o&&(ac.current=!0,eE(t))}catch(e){}}catch(e){}ah(!1)},children:"zh"===e_?"保存":"Save"})]})]})}),(0,i.jsx)(E.lG,{open:t5,onOpenChange:t3,children:(0,i.jsxs)(E.Cf,{className:"max-w-[820px] w-[96vw] max-h-[85vh] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"配置：".concat(t9):"Config: ".concat(t9)})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"JSON 属性（保存后立即应用到右侧预览）":"JSON props (applies to preview on save)"}),(0,i.jsx)(g.T,{value:ae,onChange:e=>at(e.target.value),rows:16,className:"font-mono text-xs"})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>t3(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:()=>{try{var e,t,a;let i=null===(t=e6.pages)||void 0===t?void 0:null===(e=t[e4])||void 0===e?void 0:e.topBar,s=(null==i?void 0:i.enabled)?"tab-".concat(tY):"icon-".concat(tY),l=JSON.parse(ae||"{}");null===(a=window.frames[0])||void 0===a||a.postMessage({type:"SET_OVERRIDE",pageId:e4.replace(/^p-/,""),sectionKey:s,cardType:t7,props:l},"*"),t3(!1)}catch(e){ek({description:(null==e?void 0:e.message)||("zh"===e_?"JSON 无法解析":"Invalid JSON"),variant:"destructive"})}},children:"zh"===e_?"保存":"Save"})]})]})}),(0,i.jsx)(E.lG,{open:aX,onOpenChange:aY,children:(0,i.jsxs)(E.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"Logo"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"建议：正方形 PNG，至少 256\xd7256":"Square PNG, ≥256\xd7256"}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let i=await aG(a,512,512,.9);e7(e=>({...e,logoImage:i,showLogo:!0})),aY(!1)}}),e3.logoImage&&(0,i.jsx)("img",{src:e3.logoImage,alt:"logo",className:"mt-2 rounded-md border size-24 object-cover"})]}),(0,i.jsx)(E.Es,{children:(0,i.jsx)(n.$,{variant:"outline",onClick:()=>aY(!1),children:"zh"===e_?"关闭":"Close"})})]})}),(0,i.jsx)(E.lG,{open:aQ,onOpenChange:a0,children:(0,i.jsxs)(E.Cf,{className:"max-w-[560px] w-[95vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"编辑介绍":"Edit Intro"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"标题（中文）":"Title (ZH)"}),(0,i.jsx)(x.p,{value:a1,onChange:e=>a2(e.target.value),maxLength:30,placeholder:"zh"===e_?"中文标题":"ZH Title"}),(0,i.jsx)(v.J,{className:"mt-2 block",children:"zh"===e_?"标题（英文）":"Title (EN)"}),(0,i.jsx)(x.p,{value:a3,onChange:e=>a7(e.target.value),maxLength:60,placeholder:"zh"===e_?"英文标题":"EN Title"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"介绍（中文，最多3行）":"Intro ZH (max 3 lines)"}),(0,i.jsx)(g.T,{value:a4,onChange:e=>a5(e.target.value),rows:3,maxLength:180,placeholder:"zh"===e_?"中文介绍":"ZH Intro"}),(0,i.jsx)(v.J,{className:"mt-2 block",children:"zh"===e_?"介绍（英文，最多3行）":"Intro EN (max 3 lines)"}),(0,i.jsx)(g.T,{value:a6,onChange:e=>a9(e.target.value),rows:3,maxLength:300,placeholder:"zh"===e_?"英文介绍":"EN Intro"}),(0,i.jsx)("div",{className:"text-[10px] text-muted-foreground",children:"zh"===e_?"建议每行约60字以内":"~60 chars per line suggested"})]})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>a0(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:()=>{e7(e=>({...e,introTitle:{zh:a1.trim(),en:a3.trim()},introText:{zh:a4.trim(),en:a6.trim()},showIntro:!0})),a0(!1)},children:"zh"===e_?"确定":"OK"})]})]})}),(0,i.jsx)(E.lG,{open:tA,onOpenChange:tO,children:(0,i.jsxs)(E.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:"zh"===e_?"设置路由":"Set Route"})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.J,{children:"zh"===e_?"路由":"Route"}),(0,i.jsx)(x.p,{value:tR,onChange:e=>tP(e.target.value),placeholder:"/p-kxxxxxxxx or /home"}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===e_?"建议页面使用 /p- 开头的短链接；必须以 / 开头。":"Recommend using short links starting with /p-; must start with /."})]}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(n.$,{variant:"outline",onClick:()=>tO(!1),children:"zh"===e_?"取消":"Cancel"}),(0,i.jsx)(n.$,{onClick:function(){let e=(tR||"").trim();if(!/^\/[A-Za-z0-9_\-/]*$/.test(e)||e.length<2){ek({description:"zh"===e_?"路由格式不正确，应以 / 开头，可包含字母数字-_/":"Invalid route. Must start with / and contain letters, numbers, - or _.",variant:"destructive"});return}e9(t=>{let a={...t},i=[...a.app.bottomNav];if(null!=tE&&i[tE]){i[tE]={...i[tE],route:e},a.app.bottomNav=i;let t=(e||"").replace(/^\//,"");a.pages=a.pages||{},a.pages[t]||(a.pages[t]={title:{zh:"新页面",en:"New Page"},layout:"mobile",route:e,cards:[]})}return a}),tO(!1)},children:"zh"===e_?"保存":"Save"})]})]})})]})}},11915:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var i=a(44542),s=a(61375);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,i.$)(t))}},47255:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});var i=a(74364);a(10640);var s=a(83382),l=a(27367),n=a(11915);function r(e){let{className:t,...a}=e;return(0,i.jsx)(s.bL,{"data-slot":"checkbox",className:(0,n.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,i.jsx)(s.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,i.jsx)(l.A,{className:"size-3.5"})})})}},69494:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var i=a(74364);a(10640);var s=a(11915);function l(e){let{className:t,...a}=e;return(0,i.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}},73475:(e,t,a)=>{"use strict";a.d(t,{LocaleProvider:()=>o,Y:()=>d});var i=a(74364),s=a(10640);let l={brand:"通用无代码构建平台",save:"保存",newApp:"新建应用",appsTitle:"应用构建页",appsSubtitle:"管理已创建的应用或新建",searchApp:"搜索应用...",emptyAppHint:"还没有应用。点击右上角「新建应用」开始吧。",noDesc:"电商+系统模块示例",modulesCount:e=>{let{n:t}=e;return"模块 ".concat(t)},enter:"进入",clone:"克隆",delete:"删除",copySuffix:"（副本）",confirmDeleteApp:"确认删除该应用？",newAppNamePlaceholder:"请输入应用名称",toggleLang:"切换语言",appNotFound:"未找到应用",apps:"应用",directories:"目录（表）",rename:"重命名",addDir:"添加目录",typeCategory:"分类",typeTable:"表",emptyDirHint:"该模块暂无目录，请先添加。",moduleSettings:"模块设置",dirSettings:"目录设置",chooseDirHint:"请选择左侧目录开始操作",searchPlaceholder:"搜索 名称/品牌/标签...",filterByCategory:"按分类筛选",filterByStatus:"按上架状态",all:"全部",statusOn:"上架",statusOff:"下架",addRecord:"新增记录",tabList:"列表",tabFields:"字段管理",tabCategories:"内容分类",listHint:"提示：显示列由「字段管理」中的启用状态决定。单击一行打开右侧详情抽屉。",confirmDeleteRecord:"确认删除该记录？",addModule:"添加模块",module_ecom:"电商类通用模块",module_edu:"教育类通用模块",module_content:"通用内容模块",module_project:"通用项目展示模块",module_custom:"通用自定义模块",renameModule:"模块名",newDirNamePlaceholder:"目录名称",unnamedDir:"未命名目录",chooseTableTpl:"选择表模板（custom/ecom-product/...）",renameDir:"目录名",ft_text:"文本",ft_textarea:"多行文本",ft_number:"数字",ft_select:"单选",ft_multiselect:"多选",ft_boolean:"布尔",ft_date:"日期",ft_time:"时间",ft_tags:"标签",ft_image:"图片",ft_profile:"标识",ft_video:"视频",ft_file:"文件",ft_richtext:"富文本",ft_percent:"百分比",ft_progress:"进度",ft_barcode:"条码",ft_checkbox:"复选框",ft_cascader:"级联选项",ft_relation_one:"关联",ft_relation_many:"多关联",ft_experience:"经历",ft_multiimage:"多图片",ft_multivideo:"多视频",ft_identity_verification:"实名认证",ft_other_verification:"其他认证",ft_meta_items:"数据项集合",fieldManagement:"字段管理",fieldCategoryManagement:"字段分类",recordCategoryManagement:"内容分类",allFields:"全部字段",uncategorized:"未分类",editField:"编辑字段",defaultField:"默认字段",deleteField:"删除",dragToSort:"拖动排序",confirmDeleteField:"确认删除该字段？",basicFields:"基础字段",businessFields:"业务字段",addCategory:"添加分类",addCategoryLoading:"添加中...",addCategoryFailed:"添加分类失败，请重试",categoryName:"分类名称",categoryDescription:"分类描述（可选）",categoryList:"分类列表",fieldList:"字段列表",enabled:"已启用",disabled:"已禁用",showFields:"显示",ofFields:"个字段",selectCategoryToView:"请选择一个字段分类查看详情",confirmDeleteCategory:"确认删除分类",confirmDeleteCategoryWithFields:"该分类包含",fieldsWillMoveToUncategorized:"个字段，删除后这些字段将移至「无分类」。",systemCategoryCannotDelete:"系统分类不能删除",previousPage:"上一页",nextPage:"下一页",fieldCategoryManagement:"字段分类",deleteCategory:"删除分类",recordCategoryManagement:"内容分类管理",addRecordCategory:"添加内容分类",recordCategoryName:"分类名称",recordCategoryDescription:"分类描述",recordCategoryList:"内容分类列表",confirmDeleteRecordCategory:"确认删除该内容分类？",recordCategoryCannotDelete:"该分类下还有记录，不能删除",selectRecordCategory:"选择内容分类",noRecordCategory:"无分类",typeChangeWarning:"更改字段类型会尝试转换已有数据，可能造成数据丢失，是否继续？",saveField:"保存字段",selfModule:"自主模块",thirdPartyModule:"第三方模块",searchModulePlaceholder:"搜索模块名称、提供商或描述...",allCategories:"所有类别",provider:"提供商",version:"版本",downloads:"下载",rating:"评分",install:"安装",noMatchingModules:"没有找到匹配的模块",noPermissionToDelete:"当前角色无权删除",noPermissionToBulkDelete:"当前角色无权批量删除",confirmDeleteRecord:"确认删除该记录？",confirmBulkDeleteRecords:"确认批量删除选中的",records:"条记录？",bulkDeleteCompleted:"批量删除完成",bulkDeleteSelected:"批量删除选中项",bulkDelete:"批量删除",clearSelection:"清除选择",selected:"已选择",items:"项",dynamicRecordAdded:"动态记录已添加",pleaseEnterDynamicContent:"请输入动态内容",userRecord:"用户记录",systemInfo:"系统信息",behaviorDynamic:"行为动态",other:"其他",addUserRecord:"添加用户记录",recordContent:"记录内容",enterUserRecordContent:"请输入用户记录内容...",addRecord:"添加记录",historyRecord:"历史记录",category:"分类",basicInfo:"基本资料",dynamicRecord:"动态记录",saveChanges:"保存更改",saved:"已保存"},n={brand:"Universal No-code Builder",save:"Save",newApp:"New App",appsTitle:"App Builder",appsSubtitle:"Manage existing apps or create a new one",searchApp:"Search apps...",emptyAppHint:"No app yet. Click New App to start.",noDesc:"E-commerce + system modules demo",modulesCount:e=>{let{n:t}=e;return"Modules ".concat(t)},enter:"Enter",clone:"Clone",delete:"Delete",copySuffix:" (copy)",confirmDeleteApp:"Delete this app?",newAppNamePlaceholder:"Enter app name",toggleLang:"Toggle language",appNotFound:"App not found",apps:"Apps",directories:"Directories (Tables)",rename:"Rename",addDir:"Add Directory",typeCategory:"Category",typeTable:"Table",emptyDirHint:"No directory in this module. Add one first.",moduleSettings:"Module Settings",dirSettings:"Directory Settings",chooseDirHint:"Pick a directory from the left to start",searchPlaceholder:"Search name/brand/tags...",filterByCategory:"Filter by category",filterByStatus:"Filter by status",all:"All",statusOn:"Online",statusOff:"Offline",addRecord:"Add Record",tabList:"List",tabFields:"Fields",tabCategories:"Content Categories",listHint:"Columns are controlled in Fields tab. Click a row to open the right drawer.",confirmDeleteRecord:"Delete this record?",addModule:"Add Module",module_ecom:"E-commerce module",module_edu:"Education module",module_content:"Content module",module_project:"Project showcase module",module_custom:"Custom module",renameModule:"Module name",newDirNamePlaceholder:"Directory name",unnamedDir:"Untitled directory",chooseTableTpl:"Choose table template (custom/ecom-product/...)",renameDir:"Directory name",ft_text:"Text",ft_textarea:"Textarea",ft_number:"Number",ft_select:"Single Select",ft_multiselect:"Multi Select",ft_boolean:"Boolean",ft_date:"Date",ft_time:"Time",ft_tags:"Tags",ft_image:"Image",ft_profile:"Profile",ft_video:"Video",ft_file:"File",ft_richtext:"Rich Text",ft_percent:"Percent",ft_progress:"Progress",ft_barcode:"Barcode",ft_checkbox:"Checkbox",ft_cascader:"Cascader",ft_relation_one:"Relation",ft_relation_many:"Multi-relation",ft_experience:"Experience",ft_multiimage:"Multi Image",ft_multivideo:"Multi Video",ft_identity_verification:"Identity Verification",ft_other_verification:"Other Verification",ft_meta_items:"Meta Items",fieldManagement:"Field Management",fieldCategoryManagement:"Field Categories",recordCategoryManagement:"Content Categories",allFields:"All Fields",uncategorized:"Uncategorized",editField:"Edit Field",defaultField:"Default Field",deleteField:"Delete",dragToSort:"Drag to sort",confirmDeleteField:"Confirm delete this field?",basicFields:"Basic Fields",businessFields:"Business Fields",addCategory:"Add Category",addCategoryLoading:"Adding...",addCategoryFailed:"Failed to add category, please try again",categoryName:"Category Name",categoryDescription:"Category Description (Optional)",categoryList:"Category List",fieldList:"Field List",enabled:"Enabled",disabled:"Disabled",showFields:"Showing",ofFields:"fields",selectCategoryToView:"Please select a field category to view details",confirmDeleteCategory:"Confirm delete category",confirmDeleteCategoryWithFields:"This category contains",fieldsWillMoveToUncategorized:"fields, they will be moved to 'Uncategorized' after deletion.",systemCategoryCannotDelete:"System categories cannot be deleted",previousPage:"Previous",nextPage:"Next",fieldCategoryManagement:"Field Category",deleteCategory:"Delete Category",recordCategoryManagement:"Content Category Management",addRecordCategory:"Add Content Category",recordCategoryName:"Category Name",recordCategoryDescription:"Category Description",recordCategoryList:"Content Category List",confirmDeleteRecordCategory:"Confirm delete this content category?",recordCategoryCannotDelete:"This category contains records and cannot be deleted",selectRecordCategory:"Select Content Category",noRecordCategory:"No Category",typeChangeWarning:"Changing field type will attempt to convert existing data, which may cause data loss. Continue?",saveField:"Save Field",selfModule:"Self Module",thirdPartyModule:"Third-party Module",searchModulePlaceholder:"Search module name, provider or description...",allCategories:"All Categories",provider:"Provider",version:"Version",downloads:"Downloads",rating:"Rating",install:"Install",noMatchingModules:"No matching modules found",noPermissionToDelete:"Current role has no permission to delete",noPermissionToBulkDelete:"Current role has no permission to bulk delete",confirmDeleteRecord:"Confirm delete this record?",confirmBulkDeleteRecords:"Confirm bulk delete selected",records:"records?",bulkDeleteCompleted:"Bulk delete completed",bulkDeleteSelected:"Bulk delete selected items",bulkDelete:"Bulk Delete",clearSelection:"Clear Selection",selected:"Selected",items:"items",dynamicRecordAdded:"Dynamic record added",pleaseEnterDynamicContent:"Please enter dynamic content",userRecord:"User Record",systemInfo:"System Info",behaviorDynamic:"Behavior Dynamic",other:"Other",addUserRecord:"Add User Record",recordContent:"Record Content",enterUserRecordContent:"Please enter user record content...",addRecord:"Add Record",historyRecord:"History Record",category:"Category",basicInfo:"Basic Info",dynamicRecord:"Dynamic Record",saveChanges:"Save Changes",saved:"Saved"},r=(0,s.createContext)(null);function o(e){let{children:t}=e,[a,o]=(0,s.useState)("zh"),[d,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{c(!0),o(localStorage.getItem("nocode_locale")||"zh")},[]),(0,s.useEffect)(()=>{d&&localStorage.setItem("nocode_locale",a)},[a,d]);let p="zh"===a?l:n;return(0,i.jsx)(r.Provider,{value:{locale:a,t:function(e,t){let a=p[e];return"function"==typeof a?a(t):null!=a?a:String(e)},toggleLocale:function(){o(e=>"zh"===e?"en":"zh")}},children:t})}function d(){let e=(0,s.useContext)(r);if(!e)throw Error("useLocale must be used within a LocaleProvider");return e.locale?e:{locale:"zh",t:(e,t)=>{let a=l[e];return"function"==typeof a?a(t):null!=a?a:String(e)},toggleLocale:()=>{}}}},91562:(e,t,a)=>{Promise.resolve().then(a.bind(a,11484))}},e=>{var t=t=>e(e.s=t);e.O(0,[2189,1654,926,1968,5880,516,5203,1650,3294,1538,8380,1139,7358],()=>t(91562)),_N_E=e.O()}]);