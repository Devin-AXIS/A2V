(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2647],{3448:(e,s,a)=>{Promise.resolve().then(a.bind(a,29712))},28410:(e,s,a)=>{"use strict";var l=a(17518);a.o(l,"useParams")&&a.d(s,{useParams:function(){return l.useParams}}),a.o(l,"useRouter")&&a.d(s,{useRouter:function(){return l.useRouter}})},29712:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var l=a(74364),r=a(10640),t=a(28410),d=a(91650);function n(){var e,s,a,n,i,o,c,m,p,u;let x=(0,t.useParams)(),h=null==x?void 0:x.appId,[g,v]=(0,r.useState)({phone_number:"",password:"",name:"",email:""}),[N,j]=(0,r.useState)({phone_number:"",password:""}),[b,f]=(0,r.useState)({phone_number:"",old_password:"",new_password:""}),[y,w]=(0,r.useState)(!1),[_,C]=(0,r.useState)(""),[k,S]=(0,r.useState)(null),[P,I]=(0,r.useState)(""),[U,O]=(0,r.useState)("");if(!h)return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"Auth Test"}),(0,l.jsx)("p",{className:"text-red-500 mt-2",children:"Missing applicationId in route."})]});let D=async()=>{w(!0),C(""),I(""),O("");try{let e={phone_number:g.phone_number,password:g.password};g.name&&g.name.trim().length>0&&(e.name=g.name.trim()),g.email&&g.email.trim().length>0&&(e.email=g.email.trim());let s=await d.api.applicationUsers.registerUser(h,e);if(s.success)C("注册成功"),I("注册成功"),O("success");else{let e=s.error||"注册失败";C(e),I(e),O("error")}}catch(s){let e=(null==s?void 0:s.message)||"注册失败";C(e),I(e),O("error")}finally{w(!1)}},E=async()=>{w(!0),C("");try{let e=await d.api.applicationUsers.loginUser(h,N);e.success?(S(e.data),C("登录成功")):C(e.error||"登录失败")}catch(e){C((null==e?void 0:e.message)||"登录失败")}finally{w(!1)}},R=async()=>{w(!0),C("");try{let e=await d.api.applicationUsers.changePassword(h,b);e.success?C("修改密码成功"):C(e.error||"修改密码失败")}catch(e){C((null==e?void 0:e.message)||"修改密码失败")}finally{w(!1)}};return(0,l.jsxs)("div",{className:"p-6 space-y-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"应用用户注册/登录/改密测试"}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Application ID: ",h]}),(0,l.jsxs)("section",{className:"space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"注册"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"手机号",value:g.phone_number,onChange:e=>v({...g,phone_number:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"密码",type:"password",value:g.password,onChange:e=>v({...g,password:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"姓名（可选）",value:g.name,onChange:e=>v({...g,name:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"邮箱（可选）",value:g.email,onChange:e=>v({...g,email:e.target.value})})]}),(0,l.jsx)("button",{onClick:D,disabled:y,className:"inline-flex items-center rounded px-4 py-2 bg-black text-white disabled:opacity-50",children:y?"提交中...":"注册"}),P&&(0,l.jsx)("div",{className:"text-sm mt-2 ".concat("success"===U?"text-green-600":"text-red-600"),children:P})]}),(0,l.jsxs)("section",{className:"space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"登录"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"手机号",value:N.phone_number,onChange:e=>j({...N,phone_number:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"密码",type:"password",value:N.password,onChange:e=>j({...N,password:e.target.value})})]}),(0,l.jsx)("button",{onClick:E,disabled:y,className:"inline-flex items-center rounded px-4 py-2 bg-black text-white disabled:opacity-50",children:y?"提交中...":"登录"})]}),(0,l.jsxs)("section",{className:"space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"修改密码"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"手机号",value:b.phone_number,onChange:e=>f({...b,phone_number:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"旧密码",type:"password",value:b.old_password,onChange:e=>f({...b,old_password:e.target.value})}),(0,l.jsx)("input",{className:"border rounded px-3 py-2",placeholder:"新密码",type:"password",value:b.new_password,onChange:e=>f({...b,new_password:e.target.value})})]}),(0,l.jsx)("button",{onClick:R,disabled:y,className:"inline-flex items-center rounded px-4 py-2 bg-black text-white disabled:opacity-50",children:y?"提交中...":"修改密码"})]}),_&&(0,l.jsx)("div",{className:"text-sm text-blue-600",children:_}),k&&(0,l.jsxs)("section",{className:"space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"登录后返回的用户信息"}),(0,l.jsxs)("div",{className:"rounded border p-4 grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)("img",{src:k.avatar||(null===(e=k.profile)||void 0===e?void 0:e.avatar)||"/placeholder-user.jpg",alt:k.name||(null===(s=k.profile)||void 0===s?void 0:s.name)||"avatar",className:"w-24 h-24 rounded-full object-cover border"}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-base font-semibold",children:k.name||(null===(a=k.profile)||void 0===a?void 0:a.name)||"未命名用户"}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:k.role||"user"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"手机号："}),k.phone_number||k.phone]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"邮箱："}),k.email||(null===(n=k.profile)||void 0===n?void 0:n.email)||"-"]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"姓名："}),k.name||(null===(i=k.profile)||void 0===i?void 0:i.name)||"-"]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"部门："}),k.department||(null===(o=k.profile)||void 0===o?void 0:o.department)||"-"]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"职位："}),k.position||(null===(c=k.profile)||void 0===c?void 0:c.position)||"-"]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"状态："}),k.status||"-"]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:"标签"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(k.tags||(null===(m=k.profile)||void 0===m?void 0:m.tags)||[]).map((e,s)=>(0,l.jsx)("span",{className:"px-2 py-0.5 text-xs rounded bg-gray-100 border",children:e},s)),(!k.tags||0===((null===(p=k.tags)||void 0===p?void 0:p.length)||0))&&(!(null===(u=k.profile)||void 0===u?void 0:u.tags)||0===k.profile.tags.length)&&(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"无"})]}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground",children:["用户ID：",k.id]}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground",children:["应用ID：",h]})]})]}),(0,l.jsxs)("details",{className:"rounded border p-3",children:[(0,l.jsx)("summary",{className:"cursor-pointer text-sm",children:"查看完整返回 JSON"}),(0,l.jsx)("pre",{className:"mt-2 text-xs whitespace-pre-wrap break-all",children:JSON.stringify(k,null,2)})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[1650,8380,1139,7358],()=>s(3448)),_N_E=e.O()}]);