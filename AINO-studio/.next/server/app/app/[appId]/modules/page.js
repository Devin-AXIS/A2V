(()=>{var e={};e.id=143,e.ids=[143],e.modules={377:(e,s,a)=>{"use strict";a.d(s,{SQ:()=>o,_2:()=>d,lp:()=>c,mB:()=>m,rI:()=>i,ty:()=>n});var t=a(33752);a(82153);var r=a(2284),l=a(1237);function i({...e}){return(0,t.jsx)(r.bL,{"data-slot":"dropdown-menu",...e})}function n({...e}){return(0,t.jsx)(r.l9,{"data-slot":"dropdown-menu-trigger",...e})}function o({className:e,sideOffset:s=4,...a}){return(0,t.jsx)(r.ZL,{children:(0,t.jsx)(r.UC,{"data-slot":"dropdown-menu-content",sideOffset:s,className:(0,l.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...a})})}function d({className:e,inset:s,variant:a="default",...i}){return(0,t.jsx)(r.q7,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":a,className:(0,l.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i})}function c({className:e,inset:s,...a}){return(0,t.jsx)(r.JU,{"data-slot":"dropdown-menu-label","data-inset":s,className:(0,l.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e),...a})}function m({className:e,...s}){return(0,t.jsx)(r.wv,{"data-slot":"dropdown-menu-separator",className:(0,l.cn)("bg-border -mx-1 my-1 h-px",e),...s})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9307:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.default,__next_app__:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>o});var t=a(50842),r=a(13725),l=a(82416),i=a(70122),n={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);a.d(s,n);let o={children:["",{children:["app",{children:["[appId]",{children:["modules",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,84244)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/page.tsx"]}]},{error:[()=>Promise.resolve().then(a.bind(a,51999)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/error.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,27777)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/loading.tsx"]}]},{error:[()=>Promise.resolve().then(a.bind(a,87033)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/error.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,72330)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/layout.tsx"],error:[()=>Promise.resolve().then(a.bind(a,9556)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/error.tsx"],"global-error":[()=>Promise.resolve().then(a.bind(a,82416)),"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/global-error.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,31435,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,11622,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,5887,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/page.tsx"],c={require:a,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/app/[appId]/modules/page",pathname:"/app/[appId]/modules",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11819:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(74112).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19394:(e,s,a)=>{"use strict";a.d(s,{d:()=>i});var t=a(33752);a(82153);var r=a(70896),l=a(1237);function i({className:e,...s}){return(0,t.jsx)(r.bL,{"data-slot":"switch",className:(0,l.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(r.zi,{"data-slot":"switch-thumb",className:(0,l.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},27777:(e,s,a)=>{"use strict";function t(){return null}a.r(s),a.d(s,{default:()=>t})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39377:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var t=a(33752);a(82153);var r=a(51322),l=a(72498),i=a(77909),n=a(51404);function o({error:e,reset:s}){return(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"mx-auto max-w-md text-center",children:[(0,t.jsx)("div",{className:"mb-6 flex justify-center",children:(0,t.jsx)("div",{className:"rounded-full bg-red-100 p-3",children:(0,t.jsx)(l.A,{className:"h-8 w-8 text-red-600"})})}),(0,t.jsx)("h2",{className:"mb-4 text-2xl font-bold text-gray-900",children:"模块加载失败"}),(0,t.jsx)("p",{className:"mb-6 text-gray-600",children:"抱歉，模块加载时出现了错误。请尝试重新加载或返回应用主页。"}),(0,t.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,t.jsxs)(r.$,{onClick:s,className:"flex items-center gap-2",children:[(0,t.jsx)(i.A,{className:"h-4 w-4"}),"重新加载"]}),(0,t.jsxs)(r.$,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center gap-2",children:[(0,t.jsx)(n.A,{className:"h-4 w-4"}),"返回上页"]})]}),!1]})})}},40104:(e,s,a)=>{"use strict";a.d(s,{G:()=>c});var t=a(33752),r=a(82153),l=a(51322),i=a(16117),n=a(81694),o=a(90608),d=a(16585);function c({value:e="",onChange:s,multiple:a=!1,defaultImage:c="",disabled:m=!1,size:u="md"}){let{locale:h}=(0,d.Y)(),x=a?Array.isArray(e)?e:e?[e]:[]:Array.isArray(e)?e[0]||"":e||"",p=a?x.length>0:!!x,f=a||!p,g=!p&&c,v=g?[c]:a?x:[x],j={sm:"w-12 h-12",md:"w-20 h-20",lg:"w-32 h-32"},[y,b]=(0,r.useState)(!1),N=e=>{if(a){let a=x.filter((s,a)=>a!==e);s?.(a)}else s?.("")};return(0,t.jsxs)("div",{className:"space-y-3",children:[(p||g)&&(0,t.jsx)("div",{className:`grid gap-3 ${a?"grid-cols-2 md:grid-cols-3":"grid-cols-1 max-w-xs"}`,children:v.filter(Boolean).map((e,s)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:`${j[u]} rounded-full overflow-hidden border-2 border-gray-200`,children:(0,t.jsx)("img",{src:e,alt:"zh"===h?"标识":"Profile",className:"w-full h-full object-cover"})}),!g&&(0,t.jsx)(l.$,{type:"button",variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0 rounded-full",onClick:()=>N(s),disabled:m,children:(0,t.jsx)(i.A,{className:"h-3 w-3"})}),g&&(0,t.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 bg-black/50 text-white text-xs px-2 py-1 rounded-full",children:"zh"===h?"默认":"Default"})]},s))}),f&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded",children:[(0,t.jsx)(n.A,{className:"h-8 w-8 text-gray-400 mb-2"}),(0,t.jsxs)(l.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=a,e.onchange=async e=>{let t=e.target.files;if(t&&t.length>0){b(!0);try{let e=async e=>{let s=new FormData;s.append("file",e);let a=await fetch("http://localhost:3007/api/upload",{method:"POST",headers:{},body:s}),t=await a.json();if(!a.ok||!t?.success||!t?.url)throw Error(t?.message||"上传失败");return t.url},r=[];for(let s of Array.from(t)){let a=await e(s);r.push(a)}if(a){let e=x||[];s?.([...e,...r])}else s?.(r[0])}catch(e){console.error("头像上传失败",e)}finally{b(!1)}}},e.click()},disabled:m||y,className:"gap-1",children:[(0,t.jsx)(o.A,{className:"h-4 w-4"}),y?"zh"===h?"正在上传...":"Uploading...":"zh"===h?`上传标识${a&&p?"（追加）":""}`:`Upload Profile${a&&p?" (Add)":""}`]})]}),a&&(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"zh"===h?"支持选择多个图片文件进行批量上传":"Select multiple image files for batch upload"})]})}},43764:(e,s,a)=>{Promise.resolve().then(a.bind(a,51999))},45972:(e,s,a)=>{Promise.resolve().then(a.bind(a,39377))},51999:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(88954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/error.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/error.tsx","default")},61923:(e,s,a)=>{Promise.resolve().then(a.bind(a,84244))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70896:(e,s,a)=>{"use strict";a.d(s,{bL:()=>N,zi:()=>w});var t=a(82153),r=a(93603),l=a(60362),i=a(8816),n=a(88341),o=a(93621),d=a(47045),c=a(17044),m=a(33752),u="Switch",[h,x]=(0,i.A)(u),[p,f]=h(u),g=t.forwardRef((e,s)=>{let{__scopeSwitch:a,name:i,checked:o,defaultChecked:d,required:u,disabled:h,value:x="on",onCheckedChange:f,form:g,...v}=e,[j,N]=t.useState(null),w=(0,l.s)(s,e=>N(e)),z=t.useRef(!1),k=!j||g||!!j.closest("form"),[C=!1,A]=(0,n.i)({prop:o,defaultProp:d,onChange:f});return(0,m.jsxs)(p,{scope:a,checked:C,disabled:h,children:[(0,m.jsx)(c.sG.button,{type:"button",role:"switch","aria-checked":C,"aria-required":u,"data-state":b(C),"data-disabled":h?"":void 0,disabled:h,value:x,...v,ref:w,onClick:(0,r.m)(e.onClick,e=>{A(e=>!e),k&&(z.current=e.isPropagationStopped(),z.current||e.stopPropagation())})}),k&&(0,m.jsx)(y,{control:j,bubbles:!z.current,name:i,value:x,checked:C,required:u,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});g.displayName=u;var v="SwitchThumb",j=t.forwardRef((e,s)=>{let{__scopeSwitch:a,...t}=e,r=f(v,a);return(0,m.jsx)(c.sG.span,{"data-state":b(r.checked),"data-disabled":r.disabled?"":void 0,...t,ref:s})});j.displayName=v;var y=e=>{let{control:s,checked:a,bubbles:r=!0,...l}=e,i=t.useRef(null),n=(0,o.Z)(a),c=(0,d.X)(s);return t.useEffect(()=>{let e=i.current,s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(n!==a&&s){let t=new Event("click",{bubbles:r});s.call(e,a),e.dispatchEvent(t)}},[n,a,r]),(0,m.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...l,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function b(e){return e?"checked":"unchecked"}var N=g,w=j},72515:(e,s,a)=>{"use strict";a.d(s,{$:()=>i});var t=a(82153),r=a(64304),l=a(14618);function i({applicationId:e}){let{toast:s}=(0,l.dj)(),[a,i]=(0,t.useState)(!1),n=(0,t.useCallback)(async a=>{i(!0);try{let s=await r.api.modules.getInstalledModules({applicationId:e,...a});if(s.success)return s.data;throw Error(s.error||"获取模块列表失败")}catch(e){throw s({title:"获取模块列表失败",description:e instanceof Error?e.message:"获取模块列表失败",variant:"destructive"}),e}finally{i(!1)}},[e,s]),o=(0,t.useCallback)(async a=>{i(!0);try{let t=await r.api.modules.installModule(e,a);if(t.success)return s({title:"模块安装成功",description:`模块 ${a.moduleKey} 已成功安装`}),t.data;throw Error(t.error||"模块安装失败")}catch(e){throw s({title:"模块安装失败",description:e instanceof Error?e.message:"模块安装失败",variant:"destructive"}),e}finally{i(!1)}},[e,s]),d=(0,t.useCallback)(async(a,t=!1)=>{i(!0);try{let l=await r.api.modules.uninstallModule(e,a,{keepData:t});if(l.success)return s({title:"模块卸载成功",description:`模块 ${a} 已成功卸载`}),l.data;throw Error(l.error||"模块卸载失败")}catch(e){throw s({title:"模块卸载失败",description:e instanceof Error?e.message:"模块卸载失败",variant:"destructive"}),e}finally{i(!1)}},[e,s]),c=(0,t.useCallback)(async(a,t)=>{i(!0);try{let l=await r.api.modules.updateModuleConfig(e,a,t);if(l.success)return s({title:"配置更新成功",description:`模块 ${a} 的配置已更新`}),l.data;throw Error(l.error||"配置更新失败")}catch(e){throw s({title:"配置更新失败",description:e instanceof Error?e.message:"配置更新失败",variant:"destructive"}),e}finally{i(!1)}},[e,s]),m=(0,t.useCallback)(async(a,t)=>{i(!0);try{let l=await r.api.modules.updateModuleStatus(e,a,t);if(l.success)return s({title:"状态更新成功",description:`模块 ${a} 的状态已更新为 ${t}`}),l.data;throw Error(l.error||"状态更新失败")}catch(e){throw s({title:"状态更新失败",description:e instanceof Error?e.message:"状态更新失败",variant:"destructive"}),e}finally{i(!1)}},[e,s]);return{isLoading:a,getInstalledModules:n,installModule:o,uninstallModule:d,updateModuleConfig:c,updateModuleStatus:m,getAvailableModules:(0,t.useCallback)(async()=>{i(!0);try{let e=await r.api.modules.getAvailableModules();if(e.success)return e.data;throw Error(e.error||"获取可用模块失败")}catch(e){throw s({title:"获取可用模块失败",description:e instanceof Error?e.message:"获取可用模块失败",variant:"destructive"}),e}finally{i(!1)}},[s]),getModuleStats:(0,t.useCallback)(async()=>{i(!0);try{let s=await r.api.modules.getModuleStats(e);if(s.success)return s.data;throw Error(s.error||"获取模块统计失败")}catch(e){throw s({title:"获取模块统计失败",description:e instanceof Error?e.message:"获取模块统计失败",variant:"destructive"}),e}finally{i(!1)}},[e,s])}}},73217:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(74112).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},73801:(e,s,a)=>{"use strict";a.d(s,{E:()=>o});var t=a(33752);a(82153);var r=a(83402),l=a(23874),i=a(1237);let n=(0,l.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:s,asChild:a=!1,...l}){let o=a?r.DX:"span";return(0,t.jsx)(o,{"data-slot":"badge",className:(0,i.cn)(n({variant:s}),e),...l})}},75995:(e,s,a)=>{Promise.resolve().then(a.bind(a,84817))},76025:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(74112).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},77304:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(74112).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},82892:()=>{},84244:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(88954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wemo/new-flow/ai/AINO/AINO-studio/app/app/[appId]/modules/page.tsx","default")},84817:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>q});var t=a(33752),r=a(82153),l=a(77462),i=a(51322),n=a(85768),o=a(73801),d=a(92092),c=a(15930),m=a(377),u=a(90608),h=a(55373),x=a(83073),p=a(79505),f=a(74112);let g=(0,f.A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var v=a(4544),j=a(25040),y=a(76025),b=a(11819),N=a(73217),w=a(53198),z=a(56970),k=a(19394),C=a(66482);let A=(0,f.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var I=a(69123),E=a(77304),M=a(16585),P=a(40104);function S({open:e,onOpenChange:s,module:a,onSave:l}){let{locale:o}=(0,M.Y)(),[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(a?.settings||{enabled:!0,apiKey:"",webhookUrl:"",database:"mysql",cacheEnabled:!0,logLevel:"info",maxConnections:10,timeout:30}),[h,x]=(0,r.useState)(a?.name||""),[p,f]=(0,r.useState)(""),g=async()=>{c(!0);try{await l({...m,__moduleName:h?.trim(),__icon:p}),s(!1)}catch(e){console.error("保存配置失败:",e)}finally{c(!1)}};return a?(0,t.jsx)(w.lG,{open:e,onOpenChange:s,children:(0,t.jsxs)(w.Cf,{className:"max-w-2xl",children:[(0,t.jsx)(w.c7,{children:(0,t.jsxs)(w.L3,{children:["zh"===o?"配置模块":"Configure Module",": ",a.name]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"模块名称":"Module Name"}),(0,t.jsx)(n.p,{value:h,onChange:e=>x(e.target.value),placeholder:"zh"===o?"请输入模块名称":"Enter module name"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"模块图标":"Module Icon"}),(0,t.jsx)(P.G,{value:p,onChange:e=>f("string"==typeof e?e:e[0]||""),multiple:!1,size:"md"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"启用模块":"Enable Module"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.d,{checked:m.enabled,onCheckedChange:e=>u(s=>({...s,enabled:e}))}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:m.enabled?"zh"===o?"已启用":"Enabled":"zh"===o?"已禁用":"Disabled"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"缓存":"Cache"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.d,{checked:m.cacheEnabled,onCheckedChange:e=>u(s=>({...s,cacheEnabled:e}))}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:m.cacheEnabled?"zh"===o?"已启用":"Enabled":"zh"===o?"已禁用":"Disabled"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"API 密钥":"API Key"}),(0,t.jsx)(n.p,{value:m.apiKey,onChange:e=>u(s=>({...s,apiKey:e.target.value})),placeholder:"zh"===o?"请输入 API 密钥":"Enter API key"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"Webhook URL"}),(0,t.jsx)(n.p,{value:m.webhookUrl,onChange:e=>u(s=>({...s,webhookUrl:e.target.value})),placeholder:"zh"===o?"请输入 Webhook URL":"Enter webhook URL"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"数据库":"Database"}),(0,t.jsxs)(C.l6,{value:m.database,onValueChange:e=>u(s=>({...s,database:e})),children:[(0,t.jsx)(C.bq,{children:(0,t.jsx)(C.yv,{})}),(0,t.jsxs)(C.gC,{children:[(0,t.jsx)(C.eb,{value:"mysql",children:"MySQL"}),(0,t.jsx)(C.eb,{value:"postgresql",children:"PostgreSQL"}),(0,t.jsx)(C.eb,{value:"mongodb",children:"MongoDB"}),(0,t.jsx)(C.eb,{value:"sqlite",children:"SQLite"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"日志级别":"Log Level"}),(0,t.jsxs)(C.l6,{value:m.logLevel,onValueChange:e=>u(s=>({...s,logLevel:e})),children:[(0,t.jsx)(C.bq,{children:(0,t.jsx)(C.yv,{})}),(0,t.jsxs)(C.gC,{children:[(0,t.jsx)(C.eb,{value:"debug",children:"Debug"}),(0,t.jsx)(C.eb,{value:"info",children:"Info"}),(0,t.jsx)(C.eb,{value:"warn",children:"Warn"}),(0,t.jsx)(C.eb,{value:"error",children:"Error"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"最大连接数":"Max Connections"}),(0,t.jsx)(n.p,{type:"number",value:m.maxConnections,onChange:e=>u(s=>({...s,maxConnections:parseInt(e.target.value)||10})),min:"1",max:"100"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z.J,{children:"zh"===o?"超时时间（秒）":"Timeout (seconds)"}),(0,t.jsx)(n.p,{type:"number",value:m.timeout,onChange:e=>u(s=>({...s,timeout:parseInt(e.target.value)||30})),min:"1",max:"300"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsxs)(i.$,{variant:"outline",onClick:()=>{a&&u(a.settings)},disabled:d,children:[(0,t.jsx)(A,{className:"size-4 mr-2"}),"zh"===o?"重置":"Reset"]}),(0,t.jsxs)(i.$,{onClick:g,disabled:d,children:[d?(0,t.jsx)(I.A,{className:"size-4 mr-2 animate-spin"}):(0,t.jsx)(E.A,{className:"size-4 mr-2"}),d?"zh"===o?"保存中...":"Saving...":"zh"===o?"保存":"Save"]})]})]})}):null}var O=a(72498);function U({open:e,onOpenChange:s,moduleName:a,moduleType:l="local",onConfirm:n}){let{locale:o}=(0,M.Y)(),[d,c]=(0,r.useState)(!1),m=async()=>{c(!0);try{await n(),s(!1)}catch(e){console.error("卸载模块失败:",e)}finally{c(!1)}};return(0,t.jsx)(w.lG,{open:e,onOpenChange:s,children:(0,t.jsxs)(w.Cf,{className:"max-w-md",children:[(0,t.jsxs)(w.c7,{children:[(0,t.jsxs)(w.L3,{className:"flex items-center gap-2 text-red-600",children:[(0,t.jsx)(O.A,{className:"size-5"}),"system"===l?"zh"===o?"确认删除系统模块":"Confirm System Module Deletion":"zh"===o?"确认卸载模块":"Confirm Module Uninstall"]}),(0,t.jsx)(w.rr,{className:"pt-4",children:"system"===l?"zh"===o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["您即将删除系统模块 ",(0,t.jsxs)("strong",{children:['"',a,'"']}),"。此操作将："]}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 mb-4",children:[(0,t.jsx)("li",{children:"永久删除系统核心功能"}),(0,t.jsx)("li",{children:"删除所有相关数据和配置"}),(0,t.jsx)("li",{children:"可能影响其他模块的正常运行"}),(0,t.jsx)("li",{children:"导致系统功能缺失"})]}),(0,t.jsxs)("p",{className:"text-red-600 font-medium",children:[(0,t.jsx)("strong",{children:"警告："}),"删除系统模块可能导致系统不稳定，此操作不可撤销！"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["You are about to delete the system module ",(0,t.jsxs)("strong",{children:['"',a,'"']}),". This action will:"]}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 mb-4",children:[(0,t.jsx)("li",{children:"Permanently delete core system functionality"}),(0,t.jsx)("li",{children:"Delete all related data and configuration"}),(0,t.jsx)("li",{children:"May affect other modules' normal operation"}),(0,t.jsx)("li",{children:"Cause system functionality loss"})]}),(0,t.jsxs)("p",{className:"text-red-600 font-medium",children:[(0,t.jsx)("strong",{children:"Warning:"})," Deleting system modules may cause system instability. This action cannot be undone!"]})]}):"zh"===o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["您即将卸载模块 ",(0,t.jsxs)("strong",{children:['"',a,'"']}),"。此操作将："]}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 mb-4",children:[(0,t.jsx)("li",{children:"停止模块的所有功能"}),(0,t.jsx)("li",{children:"删除模块的所有数据"}),(0,t.jsx)("li",{children:"移除模块的配置设置"}),(0,t.jsx)("li",{children:"断开与其他模块的关联"})]}),(0,t.jsx)("p",{className:"text-red-600 font-medium",children:"此操作不可撤销，请确认您要卸载此模块。"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"mb-4",children:["You are about to uninstall the module ",(0,t.jsxs)("strong",{children:['"',a,'"']}),". This action will:"]}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 mb-4",children:[(0,t.jsx)("li",{children:"Stop all module functionality"}),(0,t.jsx)("li",{children:"Delete all module data"}),(0,t.jsx)("li",{children:"Remove module configuration settings"}),(0,t.jsx)("li",{children:"Disconnect from other modules"})]}),(0,t.jsx)("p",{className:"text-red-600 font-medium",children:"This action cannot be undone. Please confirm that you want to uninstall this module."})]})})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsx)(i.$,{variant:"outline",onClick:()=>s(!1),disabled:d,children:"zh"===o?"取消":"Cancel"}),(0,t.jsxs)(i.$,{variant:"destructive",onClick:m,disabled:d,children:[d?(0,t.jsx)(I.A,{className:"size-4 mr-2 animate-spin"}):(0,t.jsx)(j.A,{className:"size-4 mr-2"}),d?"zh"===o?"处理中...":"Processing...":"system"===l?"zh"===o?"确认删除":"Confirm Delete":"zh"===o?"确认卸载":"Confirm Uninstall"]})]})]})})}var $=a(42383),L=a(16117);function _({message:e,isVisible:s,onClose:a,duration:r=3e3}){let{locale:l}=(0,M.Y)();return s?(0,t.jsx)("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-top-2 duration-300",children:(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg max-w-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)($.A,{className:"size-5 text-green-600 mt-0.5 flex-shrink-0"}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:"text-sm font-medium text-green-800",children:e})}),(0,t.jsx)("button",{onClick:a,className:"text-green-400 hover:text-green-600 transition-colors",children:(0,t.jsx)(L.A,{className:"size-4"})})]})})}):null}var D=a(72515);function q(){let{locale:e}=(0,M.Y)(),s=(0,l.useParams)().appId,[a,o]=(0,r.useState)(""),[d,m]=(0,r.useState)("internal"),[f,g]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),[N,w]=(0,r.useState)([]),[z,k]=(0,r.useState)([]),[C,A]=(0,r.useState)(!0),[I,E]=(0,r.useState)(""),[P,O]=(0,r.useState)(!1),{getInstalledModules:$,installModule:L,uninstallModule:q,updateModuleConfig:R,getAvailableModules:V,isLoading:J}=(0,D.$)({applicationId:s}),K=N.filter(e=>{let s=e.moduleName?.toLowerCase().includes(a.toLowerCase())||e.moduleKey?.toLowerCase().includes(a.toLowerCase()),t=!0;return"internal"===d?t="system"===e.moduleType||"local"===e.moduleType:"third-party"===d?t="remote"===e.moduleType:"public"===d&&(t=!1),s&&t}),G=e=>{console.log("配置模块:",e.moduleName),b(e),g(!0)},F=e=>{console.log("卸载模块:",e.moduleName,"类型:",e.moduleType),b(e),j(!0)},Y=async e=>{try{await L({moduleKey:e.key,moduleVersion:e.version,installConfig:{}});let s=await $();w(s.modules||[])}catch(e){console.error("安装模块失败:",e)}},X=async()=>{if(y){console.log("\uD83D\uDDD1️ 开始卸载模块:",y.moduleName,"类型:",y.moduleType);try{await q(y.moduleKey,!1);let s=await $();w(s.modules||[]),E("zh"===e?`模块 "${y.moduleName}" 已成功卸载`:`Module "${y.moduleName}" has been successfully uninstalled`),O(!0),console.log("✅ 模块卸载完成")}catch(e){console.error("❌ 模块卸载失败:",e)}j(!1),b(null)}},B=async s=>{if(y){console.log("\uD83D\uDCBE 开始保存配置:",y.moduleName,s);try{let{__moduleName:a,__icon:t,...r}=s||{},l={...r};"string"==typeof a&&a.trim()&&(l.moduleName=a.trim()),"string"==typeof t&&t&&(l.icon=t),await R(y.moduleKey,l),g(!1),b(null),console.log("✅ 配置保存完成"),E("zh"===e?`模块 "${y.moduleName}" 的配置已保存`:`Configuration for module "${y.moduleName}" has been saved`),O(!0)}catch(e){throw console.error("保存配置失败:",e),e}}};return(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"zh"===e?"模块管理":"Module Management"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"zh"===e?"管理和浏览所有可用的模块":"Manage and browse all available modules"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(u.A,{className:"size-4 mr-2"}),"zh"===e?"上传模块":"Upload Module"]}),(0,t.jsxs)(i.$,{size:"sm",children:[(0,t.jsx)(h.A,{className:"size-4 mr-2"}),"zh"===e?"创建模块":"Create Module"]})]})]})}),(0,t.jsx)("div",{className:"flex-1 px-6 py-6",children:(0,t.jsxs)(c.tU,{value:d,onValueChange:m,className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)(c.j7,{className:"grid w-auto grid-cols-3",children:[(0,t.jsx)(c.Xi,{value:"internal",children:"zh"===e?"内部模块":"Internal Modules"}),(0,t.jsx)(c.Xi,{value:"third-party",children:"zh"===e?"第三方模块":"Third-party Modules"}),(0,t.jsx)(c.Xi,{value:"public",children:"zh"===e?"公用模块":"Public Modules"})]}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 size-4"}),(0,t.jsx)(n.p,{placeholder:"zh"===e?"搜索模块...":"Search modules...",value:a,onChange:e=>o(e.target.value),className:"pl-10 w-80"})]})})]}),(0,t.jsx)(c.av,{value:"internal",className:"mt-0",children:(0,t.jsx)(T,{modules:K,onConfigure:G,onUninstall:F,onInstall:Y})}),(0,t.jsx)(c.av,{value:"third-party",className:"mt-0",children:(0,t.jsx)(T,{modules:K,onConfigure:G,onUninstall:F,onInstall:Y})}),(0,t.jsx)(c.av,{value:"public",className:"mt-0",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(p.A,{className:"size-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"zh"===e?"暂无公用模块":"No Public Modules"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"zh"===e?"您还没有上传任何模块到公用库":"You haven't uploaded any modules to the public library yet"}),(0,t.jsxs)(i.$,{children:[(0,t.jsx)(u.A,{className:"size-4 mr-2"}),"zh"===e?"上传第一个模块":"Upload First Module"]})]})})]})}),(0,t.jsx)(S,{open:f,onOpenChange:g,module:y?{id:y.id,name:y.name,version:y.version,settings:{enabled:!0,apiKey:"",webhookUrl:"",database:"mysql",cacheEnabled:!0,logLevel:"info",maxConnections:10,timeout:30}}:null,onSave:B}),(0,t.jsx)(U,{open:v,onOpenChange:j,moduleName:y?.moduleName||"",moduleType:y?.moduleType,onConfirm:X}),(0,t.jsx)(_,{message:I,isVisible:P,onClose:()=>O(!1)})]})}function T({modules:e,onConfigure:s,onUninstall:a,onInstall:r}){let{locale:l}=(0,M.Y)();return 0===e.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(p.A,{className:"size-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"zh"===l?"暂无模块":"No Modules"}),(0,t.jsx)("p",{className:"text-gray-600",children:"zh"===l?"没有找到匹配的模块":"No matching modules found"})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(e=>(0,t.jsxs)(d.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,t.jsx)(d.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:(0,t.jsx)(p.A,{className:"size-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(d.ZB,{className:"text-base font-medium truncate",children:e.moduleName}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsxs)(o.E,{variant:"secondary",className:"text-xs",children:["v",e.moduleVersion]}),(0,t.jsx)(o.E,{variant:"outline",className:"text-xs",children:e.moduleType}),"active"===e.installStatus&&(0,t.jsx)(o.E,{variant:"default",className:"text-xs bg-green-100 text-green-800",children:"zh"===l?"已安装":"Installed"})]})]})]}),(0,t.jsxs)(m.rI,{children:[(0,t.jsx)(m.ty,{asChild:!0,children:(0,t.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,t.jsx)(g,{className:"size-4"})})}),(0,t.jsxs)(m.SQ,{align:"end",children:["active"===e.installStatus?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m._2,{onClick:a=>{a.preventDefault(),a.stopPropagation(),console.log("下拉菜单配置点击:",e.moduleName),s(e)},children:[(0,t.jsx)(v.A,{className:"size-4 mr-2"}),"zh"===l?"配置":"Configure"]}),(0,t.jsxs)(m._2,{className:"text-red-600",onClick:s=>{s.preventDefault(),s.stopPropagation(),console.log("下拉菜单卸载点击:",e.moduleName),a(e)},children:[(0,t.jsx)(j.A,{className:"size-4 mr-2"}),"system"===e.moduleType?"zh"===l?"删除":"Delete":"zh"===l?"卸载":"Uninstall"]})]}):(0,t.jsxs)(m._2,{onClick:()=>r(e),children:[(0,t.jsx)(y.A,{className:"size-4 mr-2"}),"zh"===l?"安装":"Install"]}),(0,t.jsxs)(m._2,{children:[(0,t.jsx)(b.A,{className:"size-4 mr-2"}),"zh"===l?"查看详情":"View Details"]})]})]})]})}),(0,t.jsxs)(d.Wu,{className:"pt-0",children:[(0,t.jsx)(d.BT,{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.manifest?.description||"暂无描述"}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:[(0,t.jsxs)("span",{children:["by ",e.manifest?.author||"AINO"]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(y.A,{className:"size-3"}),e.moduleType]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(N.A,{className:"size-3 fill-yellow-400 text-yellow-400"}),"4.5"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["active"===e.installStatus?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.$,{size:"sm",variant:"outline",className:"flex-1",onClick:a=>{a.preventDefault(),a.stopPropagation(),console.log("按钮配置点击:",e.moduleName),s(e)},children:[(0,t.jsx)(v.A,{className:"size-3 mr-1"}),"zh"===l?"配置":"Configure"]}),(0,t.jsxs)(i.$,{size:"sm",variant:"destructive",className:"flex-1",onClick:s=>{s.preventDefault(),s.stopPropagation(),console.log("按钮卸载点击:",e.moduleName),a(e)},children:[(0,t.jsx)(j.A,{className:"size-3 mr-1"}),"system"===e.moduleType?"zh"===l?"删除":"Delete":"zh"===l?"卸载":"Uninstall"]})]}):(0,t.jsxs)(i.$,{size:"sm",className:"flex-1",onClick:()=>r(e),children:[(0,t.jsx)(y.A,{className:"size-3 mr-1"}),"zh"===l?"安装":"Install"]}),(0,t.jsx)(i.$,{size:"sm",variant:"outline",children:(0,t.jsx)(b.A,{className:"size-3"})})]})]})]},e.id))})}},88972:()=>{}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[662,593,195,217,144,186,167],()=>a(9307));module.exports=t})();