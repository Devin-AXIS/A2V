(()=>{var e={};e.id=46,e.ids=[46],e.modules={3017:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(88954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wemo/new-flow/AINO/AINO-studio/app/app/[appId]/client-config/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wemo/new-flow/AINO/AINO-studio/app/app/[appId]/client-config/page.tsx","default")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7021:(e,t,a)=>{Promise.resolve().then(a.bind(a,56084))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13120:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let s=a(31981)._(a(86312));function n(e,t){var a;let n={};"function"==typeof e&&(n.loader=e);let r={...n,...t};return(0,s.default)({...r,modules:null==(a=r.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34715:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let s=a(24543);function n(e){let{reason:t,children:a}=e;throw Object.defineProperty(new s.BailoutToCSRError(t),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},46006:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return l}});let s=a(33752),n=a(86188),r=a(29294),i=a(52728);function l(e){let{moduleIds:t}=e,a=r.workAsyncStorage.getStore();if(void 0===a)return null;let l=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files;l.push(...t)}}return 0===l.length?null:(0,s.jsx)(s.Fragment,{children:l.map(e=>{let t=a.assetPrefix+"/_next/"+(0,i.encodeURIPath)(e);return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,n.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},52728:(e,t)=>{"use strict";function a(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"encodeURIPath",{enumerable:!0,get:function(){return a}})},56084:(e,t,a)=>{"use strict";let s;a.r(t),a.d(t,{default:()=>e0});var n=a(33752),r=a(82153),i=a(77462),l=a(51322),o=a(92092),d=a(15930),c=a(24568);let p=(0,r.createContext)(null);p.displayName="PanelGroupContext";let u={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},h=r["useId".toString()],m="function"==typeof h?h:()=>null,x=0;function g(e=null){let t=m(),a=(0,r.useRef)(e||t||null);return null===a.current&&(a.current=""+x++),null!=e?e:a.current}function f({children:e,className:t="",collapsedSize:a,collapsible:s,defaultSize:n,forwardedRef:i,id:l,maxSize:o,minSize:d,onCollapse:c,onExpand:h,onResize:m,order:x,style:f,tagName:v="div",...y}){let j=(0,r.useContext)(p);if(null===j)throw Error("Panel components must be rendered within a PanelGroup container");let{collapsePanel:b,expandPanel:N,getPanelSize:w,getPanelStyle:z,groupId:S,isPanelCollapsed:C,reevaluatePanelConstraints:k,registerPanel:$,resizePanel:I,unregisterPanel:E}=j,A=g(l),O=(0,r.useRef)({callbacks:{onCollapse:c,onExpand:h,onResize:m},constraints:{collapsedSize:a,collapsible:s,defaultSize:n,maxSize:o,minSize:d},id:A,idIsFromProps:void 0!==l,order:x});(0,r.useRef)({didLogMissingDefaultSizeWarning:!1}),(0,r.useImperativeHandle)(i,()=>({collapse:()=>{b(O.current)},expand:e=>{N(O.current,e)},getId:()=>A,getSize:()=>w(O.current),isCollapsed:()=>C(O.current),isExpanded:()=>!C(O.current),resize:e=>{I(O.current,e)}}),[b,N,w,C,A,I]);let P=z(O.current,n);return(0,r.createElement)(v,{...y,children:e,className:t,id:A,style:{...P,...f},[u.groupId]:S,[u.panel]:"",[u.panelCollapsible]:s||void 0,[u.panelId]:A,[u.panelSize]:parseFloat(""+P.flexGrow).toFixed(1)})}let v=(0,r.forwardRef)((e,t)=>(0,r.createElement)(f,{...e,forwardedRef:t}));f.displayName="Panel",v.displayName="forwardRef(Panel)";let y=null,j=-1,b=null;function N(e,t){var a,n,r;let i=function(e,t){if(t){let e=(t&O)!=0,a=(t&P)!=0,s=(t&T)!=0,n=(t&R)!=0;if(e)return s?"se-resize":n?"ne-resize":"e-resize";if(a)return s?"sw-resize":n?"nw-resize":"w-resize";if(s)return"s-resize";else if(n)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}(e,t);if(y!==i){if(y=i,null===b){b=document.createElement("style");s&&b.setAttribute("nonce",s),document.head.appendChild(b)}j>=0&&(null===(r=b.sheet)||void 0===r||r.removeRule(j)),j=null!==(a=null===(n=b.sheet)||void 0===n?void 0:n.insertRule(`*{cursor: ${i} !important;}`))&&void 0!==a?a:-1}}function w(e){return"keydown"===e.type}function z(e){return e.type.startsWith("pointer")}function S(e){return e.type.startsWith("mouse")}function C(e){if(z(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(S(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}let k=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function $(e){let t=e.length;for(;t--;){let a=e[t];if(Z(a,"Missing node"),function(e){let t=getComputedStyle(e);return!!("fixed"===t.position||"auto"!==t.zIndex&&("static"!==t.position||function(e){var t;let a=getComputedStyle(null!==(t=A(e))&&void 0!==t?t:e).display;return"flex"===a||"inline-flex"===a}(e))||1>+t.opacity||"transform"in t&&"none"!==t.transform||"webkitTransform"in t&&"none"!==t.webkitTransform||"mixBlendMode"in t&&"normal"!==t.mixBlendMode||"filter"in t&&"none"!==t.filter||"webkitFilter"in t&&"none"!==t.webkitFilter||"isolation"in t&&"isolate"===t.isolation||k.test(t.willChange))||"touch"===t.webkitOverflowScrolling}(a))return a}return null}function I(e){return e&&Number(getComputedStyle(e).zIndex)||0}function E(e){let t=[];for(;e;)t.push(e),e=A(e);return t}function A(e){let{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}let O=1,P=2,T=4,R=8,L="coarse"===function(){if("function"==typeof matchMedia)return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}(),D=[],_=!1,B=new Map,M=new Map,J=new Set;function U(e){let{target:t}=e,{x:a,y:s}=C(e);_=!0,V({target:t,x:a,y:s}),W(),D.length>0&&(X("down",e),e.preventDefault(),G(t)||e.stopImmediatePropagation())}function H(e){let{x:t,y:a}=C(e);if(_&&0===e.buttons&&(_=!1,X("up",e)),!_){let{target:s}=e;V({target:s,x:t,y:a})}X("move",e),K(),D.length>0&&e.preventDefault()}function F(e){let{target:t}=e,{x:a,y:s}=C(e);M.clear(),_=!1,D.length>0&&(e.preventDefault(),G(t)||e.stopImmediatePropagation()),X("up",e),V({target:t,x:a,y:s}),K(),W()}function G(e){let t=e;for(;t;){if(t.hasAttribute(u.resizeHandle))return!0;t=t.parentElement}return!1}function V({target:e,x:t,y:a}){D.splice(0);let s=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(s=e),J.forEach(e=>{let{element:n,hitAreaMargins:r}=e,i=n.getBoundingClientRect(),{bottom:l,left:o,right:d,top:c}=i,p=L?r.coarse:r.fine;if(t>=o-p&&t<=d+p&&a>=c-p&&a<=l+p){if(null!==s&&document.contains(s)&&n!==s&&!n.contains(s)&&!s.contains(n)&&function(e,t){let a;if(e===t)throw Error("Cannot compare node with itself");let s={a:E(e),b:E(t)};for(;s.a.at(-1)===s.b.at(-1);)e=s.a.pop(),t=s.b.pop(),a=e;Z(a,"Stacking order can only be calculated for elements with a common ancestor");let n={a:I($(s.a)),b:I($(s.b))};if(n.a===n.b){let e=a.childNodes,t={a:s.a.at(-1),b:s.b.at(-1)},n=e.length;for(;n--;){let a=e[n];if(a===t.a)return 1;if(a===t.b)return -1}}return Math.sign(n.a-n.b)}(s,n)>0){let e=s,t=!1;for(;e&&!e.contains(n);){var u,h;if(u=e.getBoundingClientRect(),h=i,u.x<h.x+h.width&&u.x+u.width>h.x&&u.y<h.y+h.height&&u.y+u.height>h.y){t=!0;break}e=e.parentElement}if(t)return}D.push(e)}})}function K(){let e=!1,t=!1;D.forEach(a=>{let{direction:s}=a;"horizontal"===s?e=!0:t=!0});let a=0;M.forEach(e=>{a|=e}),e&&t?N("intersection",a):e?N("horizontal",a):t?N("vertical",a):null!==b&&(document.head.removeChild(b),y=null,b=null,j=-1)}let q=new AbortController;function W(){q.abort();let e={capture:!0,signal:(q=new AbortController).signal};J.size&&(_?(D.length>0&&B.forEach((t,a)=>{let{body:s}=a;t>0&&(s.addEventListener("contextmenu",F,e),s.addEventListener("pointerleave",H,e),s.addEventListener("pointermove",H,e))}),window.addEventListener("pointerup",F,e),window.addEventListener("pointercancel",F,e)):B.forEach((t,a)=>{let{body:s}=a;t>0&&(s.addEventListener("pointerdown",U,e),s.addEventListener("pointermove",H,e))}))}function X(e,t){J.forEach(a=>{let{setResizeHandlerState:s}=a;s(e,D.includes(a),t)})}function Z(e,t){if(!e)throw console.error(t),Error(t)}function Y(e,t,a=10){return e.toFixed(a)===t.toFixed(a)?0:e>t?1:-1}function Q(e,t,a=10){return 0===Y(e,t,a)}function ee(e,t,a){return 0===Y(e,t,a)}function et({panelConstraints:e,panelIndex:t,size:a}){let s=e[t];Z(null!=s,`Panel constraints not found for index ${t}`);let{collapsedSize:n=0,collapsible:r,maxSize:i=100,minSize:l=0}=s;return 0>Y(a,l)&&(a=r&&0>Y(a,(n+l)/2)?n:l),a=parseFloat((a=Math.min(i,a)).toFixed(10))}function ea({delta:e,initialLayout:t,panelConstraints:a,pivotIndices:s,prevLayout:n,trigger:r}){if(ee(e,0))return t;let i=[...t],[l,o]=s;Z(null!=l,"Invalid first pivot index"),Z(null!=o,"Invalid second pivot index");let d=0;if("keyboard"===r){{let s=e<0?o:l,n=a[s];Z(n,`Panel constraints not found for index ${s}`);let{collapsedSize:r=0,collapsible:i,minSize:d=0}=n;if(i){let a=t[s];if(Z(null!=a,`Previous layout not found for panel index ${s}`),ee(a,r)){let t=d-a;Y(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{let s=e<0?l:o,n=a[s];Z(n,`No panel constraints found for index ${s}`);let{collapsedSize:r=0,collapsible:i,minSize:d=0}=n;if(i){let a=t[s];if(Z(null!=a,`Previous layout not found for panel index ${s}`),ee(a,d)){let t=a-r;Y(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{let s=e<0?1:-1,n=e<0?o:l,r=0;for(;;){let e=t[n];if(Z(null!=e,`Previous layout not found for panel index ${n}`),r+=et({panelConstraints:a,panelIndex:n,size:100})-e,(n+=s)<0||n>=a.length)break}let i=Math.min(Math.abs(e),Math.abs(r));e=e<0?0-i:i}{let s=e<0?l:o;for(;s>=0&&s<a.length;){let n=Math.abs(e)-Math.abs(d),r=t[s];Z(null!=r,`Previous layout not found for panel index ${s}`);let l=et({panelConstraints:a,panelIndex:s,size:r-n});if(!ee(r,l)&&(d+=r-l,i[s]=l,d.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?s--:s++}}if(function(e,t,a){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(!ee(e[a],t[a],void 0))return!1;return!0}(n,i))return n;{let s=e<0?o:l,n=t[s];Z(null!=n,`Previous layout not found for panel index ${s}`);let r=n+d,c=et({panelConstraints:a,panelIndex:s,size:r});if(i[s]=c,!ee(c,r)){let t=r-c,s=e<0?o:l;for(;s>=0&&s<a.length;){let n=i[s];Z(null!=n,`Previous layout not found for panel index ${s}`);let r=et({panelConstraints:a,panelIndex:s,size:n+t});if(ee(n,r)||(t-=r-n,i[s]=r),ee(t,0))break;e>0?s--:s++}}}return ee(i.reduce((e,t)=>t+e,0),100)?i:n}function es(e,t=document){return Array.from(t.querySelectorAll(`[${u.resizeHandleId}][data-panel-group-id="${e}"]`))}function en(e,t,a=document){let s=es(e,a).findIndex(e=>e.getAttribute(u.resizeHandleId)===t);return null!=s?s:null}function er(e,t,a){let s=en(e,t,a);return null!=s?[s,s+1]:[-1,-1]}function ei(e,t=document){var a;if(t instanceof HTMLElement&&(null==t?void 0:null===(a=t.dataset)||void 0===a?void 0:a.panelGroupId)==e)return t;let s=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return s||null}function el(e,t=document){let a=t.querySelector(`[${u.resizeHandleId}="${e}"]`);return a||null}function eo(e,t){let{x:a,y:s}=C(t);return"horizontal"===e?a:s}function ed(e,t,a){t.forEach((t,s)=>{let n=e[s];Z(n,`Panel data not found for index ${s}`);let{callbacks:r,constraints:i,id:l}=n,{collapsedSize:o=0,collapsible:d}=i,c=a[l];if(null==c||t!==c){a[l]=t;let{onCollapse:e,onExpand:s,onResize:n}=r;n&&n(t,c),d&&(e||s)&&(s&&(null==c||Q(c,o))&&!Q(t,o)&&s(),e&&(null==c||!Q(c,o))&&Q(t,o)&&e())}})}function ec(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!=t[a])return!1;return!0}function ep(e){try{if("undefined"!=typeof localStorage)e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function eu(e){return`react-resizable-panels:${e}`}function eh(e,t,a,s,n){var r;let i=eu(e),l=t.map(e=>{let{constraints:t,id:a,idIsFromProps:s,order:n}=e;return s?a:n?`${n}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(","),o=null!==(r=function(e,t){try{let a=eu(e),s=t.getItem(a);if(s){let e=JSON.parse(s);if("object"==typeof e&&null!=e)return e}}catch(e){}return null}(e,n))&&void 0!==r?r:{};o[l]={expandToSizes:Object.fromEntries(a.entries()),layout:s};try{n.setItem(i,JSON.stringify(o))}catch(e){console.error(e)}}let em={getItem:e=>(ep(em),em.getItem(e)),setItem:(e,t)=>{ep(em),em.setItem(e,t)}},ex={};function eg({autoSaveId:e=null,children:t,className:a="",direction:s,forwardedRef:n,id:i=null,onLayout:l=null,keyboardResizeBy:o=null,storage:d=em,style:c,tagName:h="div",...m}){let x=g(i),f=(0,r.useRef)(null),[v,y]=(0,r.useState)(null),[j,b]=(0,r.useState)([]),N=function(){let[e,t]=(0,r.useState)(0);return(0,r.useCallback)(()=>t(e=>e+1),[])}(),C=(0,r.useRef)({}),k=(0,r.useRef)(new Map),$=(0,r.useRef)(0),I=(0,r.useRef)({autoSaveId:e,direction:s,dragState:v,id:x,keyboardResizeBy:o,onLayout:l,storage:d}),E=(0,r.useRef)({layout:j,panelDataArray:[],panelDataArrayChanged:!1});(0,r.useRef)({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),(0,r.useImperativeHandle)(n,()=>({getId:()=>I.current.id,getLayout:()=>{let{layout:e}=E.current;return e},setLayout:e=>{let{onLayout:t}=I.current,{layout:a,panelDataArray:s}=E.current,n=function({layout:e,panelConstraints:t}){let a=[...e],s=a.reduce((e,t)=>e+t,0);if(a.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${a.map(e=>`${e}%`).join(", ")}`);if(!ee(s,100)&&a.length>0)for(let e=0;e<t.length;e++){let t=a[e];Z(null!=t,`No layout data found for index ${e}`);let n=100/s*t;a[e]=n}let n=0;for(let e=0;e<t.length;e++){let s=a[e];Z(null!=s,`No layout data found for index ${e}`);let r=et({panelConstraints:t,panelIndex:e,size:s});s!=r&&(n+=s-r,a[e]=r)}if(!ee(n,0))for(let e=0;e<t.length;e++){let s=a[e];Z(null!=s,`No layout data found for index ${e}`);let r=et({panelConstraints:t,panelIndex:e,size:s+n});if(s!==r&&(n-=r-s,a[e]=r,ee(n,0)))break}return a}({layout:e,panelConstraints:s.map(e=>e.constraints)});!function(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}(a,n)&&(b(n),E.current.layout=n,t&&t(n),ed(s,n,C.current))}}),[]),function({committedValuesRef:e,eagerValuesRef:t,groupId:a,layout:s,panelDataArray:n,panelGroupElement:i,setLayout:l}){(0,r.useRef)({didWarnAboutMissingResizeHandle:!1}),(0,r.useEffect)(()=>{if(!i)return;let e=t.current;Z(e,"Eager values not found");let{panelDataArray:n}=e;Z(null!=ei(a,i),`No group found for id "${a}"`);let r=es(a,i);Z(r,`No resize handles found for group id "${a}"`);let o=r.map(e=>{let t=e.getAttribute(u.resizeHandleId);Z(t,"Resize handle element has no handle id attribute");let[r,o]=function(e,t,a,s=document){var n,r,i,l;let o=el(t,s),d=es(e,s),c=o?d.indexOf(o):-1;return[null!==(n=null===(r=a[c])||void 0===r?void 0:r.id)&&void 0!==n?n:null,null!==(i=null===(l=a[c+1])||void 0===l?void 0:l.id)&&void 0!==i?i:null]}(a,t,n,i);if(null==r||null==o)return()=>{};let d=e=>{if(!e.defaultPrevented&&"Enter"===e.key){e.preventDefault();let o=n.findIndex(e=>e.id===r);if(o>=0){let e=n[o];Z(e,`No panel data found for index ${o}`);let r=s[o],{collapsedSize:d=0,collapsible:c,minSize:p=0}=e.constraints;if(null!=r&&c){let e=ea({delta:ee(r,d)?p-d:d-r,initialLayout:s,panelConstraints:n.map(e=>e.constraints),pivotIndices:er(a,t,i),prevLayout:s,trigger:"keyboard"});s!==e&&l(e)}}}};return e.addEventListener("keydown",d),()=>{e.removeEventListener("keydown",d)}});return()=>{o.forEach(e=>e())}},[i,e,t,a,s,n,l])}({committedValuesRef:I,eagerValuesRef:E,groupId:x,layout:j,panelDataArray:E.current.panelDataArray,setLayout:b,panelGroupElement:f.current}),(0,r.useEffect)(()=>{let{panelDataArray:t}=E.current;if(e){if(0===j.length||j.length!==t.length)return;let a=ex[e];null==a&&(a=function(e,t=10){let a=null;return(...s)=>{null!==a&&clearTimeout(a),a=setTimeout(()=>{e(...s)},t)}}(eh,100),ex[e]=a),a(e,[...t],new Map(k.current),j,d)}},[e,j,d]),(0,r.useEffect)(()=>{});let A=(0,r.useCallback)(e=>{let{onLayout:t}=I.current,{layout:a,panelDataArray:s}=E.current;if(e.constraints.collapsible){let n=s.map(e=>e.constraints),{collapsedSize:r=0,panelSize:i,pivotIndices:l}=ey(s,e,a);if(Z(null!=i,`Panel size not found for panel "${e.id}"`),!Q(i,r)){k.current.set(e.id,i);let o=ea({delta:ev(s,e)===s.length-1?i-r:r-i,initialLayout:a,panelConstraints:n,pivotIndices:l,prevLayout:a,trigger:"imperative-api"});ec(a,o)||(b(o),E.current.layout=o,t&&t(o),ed(s,o,C.current))}}},[]),L=(0,r.useCallback)((e,t)=>{let{onLayout:a}=I.current,{layout:s,panelDataArray:n}=E.current;if(e.constraints.collapsible){let r=n.map(e=>e.constraints),{collapsedSize:i=0,panelSize:l=0,minSize:o=0,pivotIndices:d}=ey(n,e,s),c=null!=t?t:o;if(Q(l,i)){let t=k.current.get(e.id),i=null!=t&&t>=c?t:c,o=ea({delta:ev(n,e)===n.length-1?l-i:i-l,initialLayout:s,panelConstraints:r,pivotIndices:d,prevLayout:s,trigger:"imperative-api"});ec(s,o)||(b(o),E.current.layout=o,a&&a(o),ed(n,o,C.current))}}},[]),D=(0,r.useCallback)(e=>{let{layout:t,panelDataArray:a}=E.current,{panelSize:s}=ey(a,e,t);return Z(null!=s,`Panel size not found for panel "${e.id}"`),s},[]),_=(0,r.useCallback)((e,t)=>{let{panelDataArray:a}=E.current,s=ev(a,e);return function({defaultSize:e,dragState:t,layout:a,panelData:s,panelIndex:n,precision:r=3}){let i;let l=a[n];return{flexBasis:0,flexGrow:null==l?void 0!=e?e.toPrecision(r):"1":1===s.length?"1":l.toPrecision(r),flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:v,layout:j,panelData:a,panelIndex:s})},[v,j]),B=(0,r.useCallback)(e=>{let{layout:t,panelDataArray:a}=E.current,{collapsedSize:s=0,collapsible:n,panelSize:r}=ey(a,e,t);return Z(null!=r,`Panel size not found for panel "${e.id}"`),!0===n&&Q(r,s)},[]),J=(0,r.useCallback)(e=>{let{layout:t,panelDataArray:a}=E.current,{collapsedSize:s=0,collapsible:n,panelSize:r}=ey(a,e,t);return Z(null!=r,`Panel size not found for panel "${e.id}"`),!n||Y(r,s)>0},[]),U=(0,r.useCallback)(e=>{let{panelDataArray:t}=E.current;t.push(e),t.sort((e,t)=>{let a=e.order,s=t.order;return null==a&&null==s?0:null==a?-1:null==s?1:a-s}),E.current.panelDataArrayChanged=!0,N()},[N]),H=(0,r.useCallback)(e=>{let t=!1,a=f.current;return a&&"rtl"===window.getComputedStyle(a,null).getPropertyValue("direction")&&(t=!0),function(a){a.preventDefault();let s=f.current;if(!s)return()=>null;let{direction:n,dragState:r,id:i,keyboardResizeBy:l,onLayout:o}=I.current,{layout:d,panelDataArray:c}=E.current,{initialLayout:p}=null!=r?r:{},h=er(i,e,s),m=function(e,t,a,s,n,r){if(w(e)){let t="horizontal"===a,s=0;s=e.shiftKey?100:null!=n?n:10;let r=0;switch(e.key){case"ArrowDown":r=t?0:s;break;case"ArrowLeft":r=t?-s:0;break;case"ArrowRight":r=t?s:0;break;case"ArrowUp":r=t?0:-s;break;case"End":r=100;break;case"Home":r=-100}return r}return null==s?0:function(e,t,a,s,n){let r="horizontal"===a,i=el(t,n);Z(i,`No resize handle element found for id "${t}"`);let l=i.getAttribute(u.groupId);Z(l,"Resize handle element has no group id attribute");let{initialCursorPosition:o}=s,d=eo(a,e),c=ei(l,n);Z(c,`No group element found for id "${l}"`);let p=c.getBoundingClientRect();return(d-o)/(r?p.width:p.height)*100}(e,t,a,s,r)}(a,e,n,r,l,s),x="horizontal"===n;x&&t&&(m=-m);let g=ea({delta:m,initialLayout:null!=p?p:d,panelConstraints:c.map(e=>e.constraints),pivotIndices:h,prevLayout:d,trigger:w(a)?"keyboard":"mouse-or-touch"}),v=!ec(d,g);if((z(a)||S(a))&&$.current!=m){var y,j;($.current=m,v||0===m)?M.set(e,0):x?(y=m<0?O:P,M.set(e,y)):(j=m<0?T:R,M.set(e,j))}v&&(b(g),E.current.layout=g,o&&o(g),ed(c,g,C.current))}},[]),F=(0,r.useCallback)((e,t)=>{let{onLayout:a}=I.current,{layout:s,panelDataArray:n}=E.current,r=n.map(e=>e.constraints),{panelSize:i,pivotIndices:l}=ey(n,e,s);Z(null!=i,`Panel size not found for panel "${e.id}"`);let o=ea({delta:ev(n,e)===n.length-1?i-t:t-i,initialLayout:s,panelConstraints:r,pivotIndices:l,prevLayout:s,trigger:"imperative-api"});ec(s,o)||(b(o),E.current.layout=o,a&&a(o),ed(n,o,C.current))},[]),G=(0,r.useCallback)((e,t)=>{let{layout:a,panelDataArray:s}=E.current,{collapsedSize:n=0,collapsible:r}=t,{collapsedSize:i=0,collapsible:l,maxSize:o=100,minSize:d=0}=e.constraints,{panelSize:c}=ey(s,e,a);null!=c&&(r&&l&&Q(c,n)?Q(n,i)||F(e,i):c<d?F(e,d):c>o&&F(e,o))},[F]),V=(0,r.useCallback)((e,t)=>{let{direction:a}=I.current,{layout:s}=E.current;if(!f.current)return;let n=el(e,f.current);Z(n,`Drag handle element not found for id "${e}"`);let r=eo(a,t);y({dragHandleId:e,dragHandleRect:n.getBoundingClientRect(),initialCursorPosition:r,initialLayout:s})},[]),K=(0,r.useCallback)(()=>{y(null)},[]),q=(0,r.useCallback)(e=>{let{panelDataArray:t}=E.current,a=ev(t,e);a>=0&&(t.splice(a,1),delete C.current[e.id],E.current.panelDataArrayChanged=!0,N())},[N]),W=(0,r.useMemo)(()=>({collapsePanel:A,direction:s,dragState:v,expandPanel:L,getPanelSize:D,getPanelStyle:_,groupId:x,isPanelCollapsed:B,isPanelExpanded:J,reevaluatePanelConstraints:G,registerPanel:U,registerResizeHandle:H,resizePanel:F,startDragging:V,stopDragging:K,unregisterPanel:q,panelGroupElement:f.current}),[A,v,s,L,D,_,x,B,J,G,U,H,F,V,K,q]);return(0,r.createElement)(p.Provider,{value:W},(0,r.createElement)(h,{...m,children:t,className:a,id:i,ref:f,style:{display:"flex",flexDirection:"horizontal"===s?"row":"column",height:"100%",overflow:"hidden",width:"100%",...c},[u.group]:"",[u.groupDirection]:s,[u.groupId]:x}))}let ef=(0,r.forwardRef)((e,t)=>(0,r.createElement)(eg,{...e,forwardedRef:t}));function ev(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function ey(e,t,a){let s=ev(e,t),n=s===e.length-1,r=a[s];return{...t.constraints,panelSize:r,pivotIndices:n?[s-1,s]:[s,s+1]}}function ej({children:e=null,className:t="",disabled:a=!1,hitAreaMargins:s,id:n,onBlur:i,onClick:l,onDragging:o,onFocus:d,onPointerDown:c,onPointerUp:h,style:m={},tabIndex:x=0,tagName:f="div",...v}){var y,j;let b=(0,r.useRef)(null),N=(0,r.useRef)({onClick:l,onDragging:o,onPointerDown:c,onPointerUp:h});(0,r.useEffect)(()=>{N.current.onClick=l,N.current.onDragging=o,N.current.onPointerDown=c,N.current.onPointerUp=h});let w=(0,r.useContext)(p);if(null===w)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");let{direction:z,groupId:S,registerResizeHandle:C,startDragging:k,stopDragging:$,panelGroupElement:I}=w,E=g(n),[A,O]=(0,r.useState)("inactive"),[P,T]=(0,r.useState)(!1),[R,L]=(0,r.useState)(null),_=(0,r.useRef)({state:A});(0,r.useEffect)(()=>{if(a)L(null);else{let e=C(E);L(()=>e)}},[a,E,C]);let U=null!==(y=null==s?void 0:s.coarse)&&void 0!==y?y:15,H=null!==(j=null==s?void 0:s.fine)&&void 0!==j?j:5;return(0,r.useEffect)(()=>{if(a||null==R)return;let e=b.current;Z(e,"Element ref not attached");let t=!1;return function(e,t,a,s,n){var r;let{ownerDocument:i}=t,l={direction:a,element:t,hitAreaMargins:s,setResizeHandlerState:n},o=null!==(r=B.get(i))&&void 0!==r?r:0;return B.set(i,o+1),J.add(l),W(),function(){var t;M.delete(e),J.delete(l);let a=null!==(t=B.get(i))&&void 0!==t?t:1;if(B.set(i,a-1),W(),1===a&&B.delete(i),D.includes(l)){let e=D.indexOf(l);e>=0&&D.splice(e,1),K(),n("up",!0,null)}}}(E,e,z,{coarse:U,fine:H},(e,a,s)=>{if(!a){O("inactive");return}switch(e){case"down":{O("drag"),t=!1,Z(s,'Expected event to be defined for "down" action'),k(E,s);let{onDragging:e,onPointerDown:a}=N.current;null==e||e(!0),null==a||a();break}case"move":{let{state:e}=_.current;t=!0,"drag"!==e&&O("hover"),Z(s,'Expected event to be defined for "move" action'),R(s);break}case"up":{O("hover"),$();let{onClick:e,onDragging:a,onPointerUp:s}=N.current;null==a||a(!1),null==s||s(),t||null==e||e()}}})},[U,z,a,H,C,E,R,k,$]),function({disabled:e,handleId:t,resizeHandler:a,panelGroupElement:s}){(0,r.useEffect)(()=>{if(e||null==a||null==s)return;let n=el(t,s);if(null==n)return;let r=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":e.preventDefault(),a(e);break;case"F6":{e.preventDefault();let a=n.getAttribute(u.groupId);Z(a,`No group element found for id "${a}"`);let r=es(a,s),i=en(a,t,s);Z(null!==i,`No resize element found for id "${t}"`);let l=e.shiftKey?i>0?i-1:r.length-1:i+1<r.length?i+1:0;r[l].focus()}}};return n.addEventListener("keydown",r),()=>{n.removeEventListener("keydown",r)}},[s,e,t,a])}({disabled:a,handleId:E,resizeHandler:R,panelGroupElement:I}),(0,r.createElement)(f,{...v,children:e,className:t,id:n,onBlur:()=>{T(!1),null==i||i()},onFocus:()=>{T(!0),null==d||d()},ref:b,role:"separator",style:{touchAction:"none",userSelect:"none",...m},tabIndex:x,[u.groupDirection]:z,[u.groupId]:S,[u.resizeHandle]:"",[u.resizeHandleActive]:"drag"===A?"pointer":P?"keyboard":void 0,[u.resizeHandleEnabled]:!a,[u.resizeHandleId]:E,[u.resizeHandleState]:A})}eg.displayName="PanelGroup",ef.displayName="forwardRef(PanelGroup)",ej.displayName="PanelResizeHandle";var eb=a(1237);function eN({className:e,...t}){return(0,n.jsx)(ef,{"data-slot":"resizable-panel-group",className:(0,eb.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t})}function ew({...e}){return(0,n.jsx)(v,{"data-slot":"resizable-panel",...e})}function ez({withHandle:e,className:t,...a}){return(0,n.jsx)(ej,{"data-slot":"resizable-handle",className:(0,eb.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...a,children:e&&(0,n.jsx)("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:(0,n.jsx)(c.A,{className:"size-2.5"})})})}var eS=a(94732),eC=a(56970),ek=a(85768),e$=a(16585),eI=a(14618),eE=a(4544),eA=a(25040),eO=a(55373),eP=a(71160),eT=a(16117),eR=a(51404),eL=a(83073),eD=a(2027),e_=a(74073),eB=a(66053),eM=a(13120),eJ=a.n(eM);let eU={$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{schemaVersion:{type:"string"},app:{type:"object",properties:{appKey:{type:"string"},locale:{type:"string"},theme:{type:"string"},bottomNav:{type:"array",items:{type:"object",properties:{key:{type:"string"},label:{type:"string"},page:{type:"string"},route:{type:"string"},iconName:{type:"string"}},required:["key","label"]}}},required:["appKey","locale","theme","bottomNav"]},pages:{type:"object"},dataSources:{type:"object"},actions:{type:"object"}},required:["schemaVersion","app"]};var eH=a(64304),eF=a(90155),eG=a(53198),eV=a(19394),eK=a(79545),eq=a(66482),eW=a(87929);function eX({open:e,onOpenChange:t,lang:a,pages:s,value:i,onSave:o}){let[d]=(0,r.useState)("click"),[c,p]=(0,r.useState)("navigate"),[u,h]=(0,r.useState)("internal"),[m,x]=(0,r.useState)(s[0]||"home"),[g,f]=(0,r.useState)(""),[v,y]=(0,r.useState)(""),[j,b]=(0,r.useState)(void 0),[N,w]=(0,r.useState)("");return(0,n.jsx)(eG.lG,{open:e,onOpenChange:t,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[560px] w-[92vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===a?"事件配置":"Event Settings"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"事件类型":"Trigger"}),(0,n.jsx)(ek.p,{value:"zh"===a?"点击时":"On Click",readOnly:!0})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"执行动作":"Action"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"navigate"===c?"default":"outline",onClick:()=>p("navigate"),children:"zh"===a?"跳转新页面":"Navigate"}),(0,n.jsx)(l.$,{size:"sm",variant:"switchTab"===c?"default":"outline",onClick:()=>p("switchTab"),children:"zh"===a?"当前页面切换":"Switch Tab"})]})]})]}),"navigate"===c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"页面类型":"Destination"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"internal"===u?"default":"outline",onClick:()=>h("internal"),children:"zh"===a?"内部页面":"Internal"}),(0,n.jsx)(l.$,{size:"sm",variant:"external"===u?"default":"outline",onClick:()=>h("external"),children:"zh"===a?"外部链接":"External"})]})]}),"internal"===u?(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"选择页面":"Select Page"}),(0,n.jsx)("select",{className:"border rounded-md h-9 px-2",value:m,onChange:e=>x(e.target.value),children:s.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}):(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"外部链接":"External URL"}),(0,n.jsx)(ek.p,{placeholder:"https://",value:g,onChange:e=>f(e.target.value)})]})]}):(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"标签标识(可选)":"Tab Key (optional)"}),(0,n.jsx)(ek.p,{placeholder:"zh"===a?"例如: overview":"e.g. overview",value:v,onChange:e=>y(e.target.value)})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"标签索引(可选)":"Tab Index (optional)"}),(0,n.jsx)(ek.p,{type:"number",placeholder:"0",value:"number"==typeof j?String(j):"",onChange:e=>b(""===e.target.value?void 0:Number(e.target.value))})]})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===a?"页面入参 (JSON)":"Params (JSON)"}),(0,n.jsx)(eS.T,{rows:3,value:N,onChange:e=>w(e.target.value),placeholder:"zh"===a?'例如: {"tab":1}':'e.g. {"tab":1}'})]})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>t(!1),children:"zh"===a?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:()=>{o("navigate"===c?{trigger:d,action:c,pageType:u,page:"internal"===u?m:void 0,url:"external"===u?g:void 0,params:N?.trim()||void 0}:{trigger:d,action:c,tabKey:v||void 0,tabIndex:"number"==typeof j?j:void 0,params:N?.trim()||void 0}),t(!1)},children:"zh"===a?"确定":"Save"})]})]})})}let eZ=eJ()(async()=>{},{loadableGenerated:{modules:["app/app/[appId]/client-config/page.tsx -> @monaco-editor/react"]},ssr:!1}),eY={type:"object",additionalProperties:!0,properties:{title:{type:["string","object"],properties:{zh:{type:"string"},en:{type:"string"}}},subtitle:{type:["string","object"],properties:{zh:{type:"string"},en:{type:"string"}}},actions:{type:"array",items:{type:"object",properties:{key:{type:"string"},label:{type:"string"},icon:{type:"string"}}}},style:{type:"object",properties:{variant:{type:"string",enum:["plain","soft","elevated"]},radius:{type:"string",enum:["none","sm","md","lg","xl","full"]},elevation:{type:"number",minimum:0,maximum:24},padding:{type:"string",enum:["none","xs","sm","md","lg"]},gap:{type:"string",enum:["none","xs","sm","md","lg"]},colors:{type:"object",properties:{background:{type:"string"},text:{type:"string"},highlight:{type:"string"}}},typography:{type:"object",properties:{titleSize:{type:"string"},bodySize:{type:"string"}}}}},layout:{type:"object",properties:{type:{type:"string"},columns:{type:"number",minimum:1,maximum:4}}},display:{type:"object",properties:{mode:{type:"string",enum:["pick","filter","time","hot"]},limit:{type:["number","null"]},unlimited:{type:"boolean"},sort:{type:"object",properties:{by:{type:"string"},order:{type:"string",enum:["asc","desc"]}}}}},data:{type:"object",properties:{mode:{type:"string",enum:["dynamic","static"]},source:{type:"string"},static:{type:["array","object","null"]}}},render:{type:"object",properties:{item:{type:["object","string"]}}}}},eQ=()=>`{
  "title": "",
  "subtitle": "",
  "style": {
    "variant": "plain",
    "radius": "md",
    "elevation": 0,
    "padding": "md",
    "gap": "md",
    "colors": { "background": "", "text": "" },
    "typography": { "titleSize": "base", "bodySize": "sm" }
  },
  "layout": { "type": "list", "columns": 1 },
  "display": { "limit": 1, "mode": "time" },
  "data": { "mode": "dynamic" },
  "render": { "item": {} }
}`;function e0(){let e=(0,i.useParams)();(0,i.useRouter)();let{locale:t}=(0,e$.Y)(),{toast:a}=(0,eI.dj)(),s=function(){let[e,t]=r.useState(void 0);return r.useEffect(()=>{let e=window.matchMedia("(max-width: 767px)"),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}(),[p,u]=(0,r.useState)(s?"mobile":"pc"),[h,m]=(0,r.useState)("zh"===t?"zh":"en"),[x,g]=(0,r.useState)(""),[f,v]=(0,r.useState)("preview"),[y,j]=(0,r.useState)(""),[b,N]=(0,r.useState)(""),[w,z]=(0,r.useState)(!1),S=(0,r.useRef)(null);(0,r.useRef)(!1);let[C,k]=(0,r.useState)(!1),[$,I]=(0,r.useState)(!1),[E,A]=(0,r.useState)(!0),[O,P]=(0,r.useState)(!1),[T,R]=(0,r.useState)("manifest"),[L,D]=(0,r.useState)(!1),[_,B]=(0,r.useState)(""),[M,J]=(0,r.useState)({layoutVariant:"centered",showBackground:!0,backgroundImage:void 0,showLogo:!0,logoImage:void 0,showIntro:!0,introTitle:void 0,introText:void 0,providers:[{key:"phone",label:"zh"===t?"手机号登录":"Phone",enabled:!0},{key:"wechat",label:"zh"===t?"微信登录":"WeChat",enabled:!0},{key:"bytedance",label:"zh"===t?"字节登录":"ByteDance",enabled:!1},{key:"google",label:"zh"===t?"谷歌登录":"Google",enabled:!0},{key:"apple",label:"zh"===t?"苹果登录":"Apple",enabled:!0}]}),[U,H]=(0,r.useState)({schemaVersion:"1.0",app:{appKey:e.appId,locale:"zh"===h?"zh-CN":"en-US",defaultLanguage:"zh"===h?"zh":"en",theme:"default",bottomNav:[{key:"home",label:"zh"===h?"首页":"Home",route:"/preview"},{key:"me",label:"zh"===h?"我的":"Me",route:"/profile"}]},dataSources:{}}),[F,G]=(0,r.useState)("manifest"),[V,K]=(0,r.useState)("home"),[q,W]=(0,r.useState)(!1),[X,Z]=(0,r.useState)([]),[Y,Q]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(""),[ea,es]=(0,r.useState)(null),[en,er]=(0,r.useState)({}),[ei,el]=(0,r.useState)({});e.appId;let[eo,ed]=(0,r.useState)({}),[ec,ep]=(0,r.useState)({}),[eu,eh]=(0,r.useState)({}),[em,ex]=(0,r.useState)({});function eg(e){try{let t=[],a=e=>"String"===e||"Number"===e||"Boolean"===e||"Date"===e||"Time"===e||"Datetime"===e||"RichText"===e||"Image"===e||"Video"===e||"File"===e;return((e,s)=>{if(e&&"object"==typeof e){if(Array.isArray(e)){if(0===e.length)return;let n=e[0];if(a(n)){s&&t.push(`${s}[]`);return}if("object"==typeof n&&n){Object.keys(n).forEach(e=>{let r=n[e];a(r)?t.push(`${s}[].${e}`):Array.isArray(r)?t.push(`${s}[].${e}[]`):"object"==typeof r&&r?Object.keys(r).forEach(a=>{t.push(`${s}[].${e}.${a}`)}):t.push(`${s}[].${e}`)});return}s&&t.push(`${s}[]`);return}Object.keys(e).forEach(n=>{let r=e[n],i=s?`${s}.${n}`:n;if(a(r))t.push(i);else if(Array.isArray(r)){if(0===r.length)t.push(`${i}[]`);else{let e=r[0];a(e)?t.push(`${i}[]`):"object"==typeof e&&e?Object.keys(e).forEach(s=>{let n=e[s];a(n)?t.push(`${i}[].${s}`):Array.isArray(n)?t.push(`${i}[].${s}[]`):"object"==typeof n&&n?Object.keys(n).forEach(e=>{t.push(`${i}[].${s}.${e}`)}):t.push(`${i}[].${s}`)}):t.push(`${i}[]`)}}else if("object"==typeof r&&r){let e=Object.keys(r);0===e.length?t.push(i):e.forEach(e=>{let s=r[e];a(s)||"object"!=typeof s?t.push(`${i}.${e}`):Array.isArray(s)?0===s.length?t.push(`${i}.${e}[]`):a(s[0])?t.push(`${i}.${e}[]`):"object"==typeof s[0]&&s[0]&&Object.keys(s[0]).forEach(a=>{t.push(`${i}.${e}[].${a}`)}):Object.keys(s).forEach(a=>{t.push(`${i}.${e}.${a}`)})})}else t.push(i)})}})(e,""),Array.from(new Set(t))}catch{return[]}}function ef(e,t,a){eh(s=>{let n={...s[e]||{},[t]:a};return{...s,[e]:n}})}function ev(e){try{ed(t=>{let a={...t};return delete a[e],a}),eh(t=>{let a={...t};return delete a[e],a}),ex(t=>{let a={...t};return delete a[e],a})}catch{}}function ey(e,t){eh(a=>{let s={...a[e]||{}};return void 0!==s[t]&&delete s[t],{...a,[e]:s}})}let ej=(0,r.useMemo)(()=>{let e=ee.trim().toLowerCase();return e?X.filter(t=>t.name.toLowerCase().includes(e)||t.moduleName.toLowerCase().includes(e)):X},[X,ee]);async function eb(){if(!Y&&!(X.length>0)){Q(!0);try{let t=String(e.appId),a=await eH.api.applications.getApplicationModules(t),s=a.success&&a.data?a.data.modules:[],n=await Promise.all(s.map(async e=>{try{let a=await eH.api.directories.getDirectories({applicationId:t,moduleId:e.id});return(a.success&&a.data&&a.data.directories||[]).filter(e=>"table"===e.type).map(t=>({id:t.id,name:t.name,moduleName:e.name}))}catch{return[]}}));Z(n.flat())}finally{Q(!1)}}}let[eM,eJ]=(0,r.useState)(!1),[e0,e1]=(0,r.useState)(null),[e2,e4]=(0,r.useState)(""),[e3,e5]=(0,r.useState)(!1),[e7,e6]=(0,r.useState)("navigation"),[e9,e8]=(0,r.useState)("iconText"),[te,tt]=(0,r.useState)("grid-4"),[ta,ts]=(0,r.useState)([]),[tn,tr]=(0,r.useState)(!1),[ti,tl]=(0,r.useState)(null),[to,td]=(0,r.useState)(0),[tc,tp]=(0,r.useState)({}),[tu,th]=(0,r.useState)(""),[tm,tx]=(0,r.useState)(!1),[tg,tf]=(0,r.useState)(""),[tv,ty]=(0,r.useState)(""),[tj,tb]=(0,r.useState)('{\n  "title": "",\n  "subtitle": ""\n}'),[tN,tw]=(0,r.useState)({}),[tz,tS]=(0,r.useState)(""),[tC,tk]=(0,r.useState)(null),[t$,tI]=(0,r.useState)("json"),tE=(0,r.useRef)(!1),tA=(0,r.useRef)(null),[tO,tP]=(0,r.useState)(!1),[tT,tR]=(0,r.useState)(""),[tL,tD]=(0,r.useState)(""),[t_,tB]=(0,r.useState)("1"),[tM,tJ]=(0,r.useState)(!1),[tU,tH]=(0,r.useState)("time"),[tF,tG]=(0,r.useState)(""),[tV,tK]=(0,r.useState)(!1);function tq(e){let t=new Set,a=[];for(let s of Array.isArray(e)?e:[]){let e=String(s?.id||"")+"::"+String(s?.title||"");t.has(e)||(t.add(e),a.push({id:s?.id||`tab-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,title:s?.title||""}))}return a}let[tW,tX]=(0,r.useState)(!1),[tZ,tY]=(0,r.useState)(""),[tQ,t0]=(0,r.useState)(""),[t1,t2]=(0,r.useState)(""),[t4,t3]=(0,r.useState)(!1),[t5,t7]=(0,r.useState)([]),[t6,t9]=(0,r.useState)({}),t8=(0,r.useMemo)(()=>Object.entries(U.dataSources||{}).filter(([,e])=>e&&"table"===e.type).map(([e,t])=>({key:e,tableId:t.tableId,label:t.label||`${t.moduleName||""}/${t.tableName||""}`})),[U.dataSources]);function ae(){return[{id:"mock_category",key:"category",label:"zh"===h?"类别":"Category",type:"select",options:[{label:"zh"===h?"全部":"All",value:"all"},{label:"选项A",value:"a"},{label:"选项B",value:"b"}],optionsTree:[]},{id:"mock_region",key:"region",label:"zh"===h?"地区":"Region",type:"cascader",options:[],optionsTree:[{id:"cn",name:"zh"===h?"中国":"China",children:[{id:"bj",name:"zh"===h?"北京":"Beijing"},{id:"sh",name:"zh"===h?"上海":"Shanghai"}]},{id:"us",name:"USA",children:[{id:"ny",name:"New York"},{id:"sf",name:"San Francisco"}]}]}]}async function at(t){try{t3(!0);let a=(U.dataSources||{})[t];if(!a?.tableId){let e=ae();t7(e),t9(t=>{let a={...t};return e.forEach(e=>{a[e.key]||(a[e.key]={fieldId:e.key,type:e.type,label:e.label})}),a});return}let s=String(e.appId),n=await eH.api.directoryDefs.getOrCreateDirectoryDefByDirectoryId(a.tableId,s),r=n?.data?.id;if(!r){let e=ae();t7(e),t9(t=>{let a={...t};return e.forEach(e=>{a[e.key]||(a[e.key]={fieldId:e.key,type:e.type,label:e.label})}),a});return}let i=await eH.api.fields.getFields({directoryId:r,page:1,limit:200}),l=(Array.isArray(i?.data)?i.data:[]).map(e=>({id:e.id,key:e.key,label:e.schema?.label||e.key,type:e.type,options:e.schema?.options||[],optionsTree:e.schema?.cascaderOptions||[]})).filter(e=>"select"===e.type||"cascader"===e.type),o=l.length>0?l:ae();t7(o),t9(e=>{let t={...e};return o.forEach(e=>{t[e.key]||(t[e.key]={fieldId:e.key,type:e.type,label:e.label})}),t})}finally{t3(!1)}}async function aa(e){if(!ei[e]&&!en[e]){el(t=>({...t,[e]:!0}));try{let t=await eH.api.records.listRecords(e,{page:1,pageSize:100}),a=(t.success&&t.data?Array.isArray(t.data)?t.data:t.data.records||[]:[]).map(e=>({id:e.id,label:e.name||e.title||e.id,raw:e}));er(t=>({...t,[e]:a}))}catch{er(t=>({...t,[e]:[]}))}finally{el(t=>({...t,[e]:!1}))}}}function as(e){H(t=>{let a={...t},s={...a.dataSources||{}};return delete s[e],a.dataSources=s,a})}async function an(e,t,a,s=.8){let n=document.createElement("img"),r=await new Promise((t,a)=>{let s=new FileReader;s.onload=()=>t(String(s.result)),s.onerror=a,s.readAsDataURL(e)});await new Promise(e=>{n.onload=e,n.src=r});let i=document.createElement("canvas"),l=Math.min(t/n.width,a/n.height),o=Math.round(n.width*l),d=Math.round(n.height*l);return i.width=o,i.height=d,i.getContext("2d").drawImage(n,0,0,o,d),i.toDataURL("image/jpeg",s)}let[ar,ai]=(0,r.useState)(!1),[al,ao]=(0,r.useState)(!1),[ad,ac]=(0,r.useState)(!1),[ap,au]=(0,r.useState)(""),[ah,am]=(0,r.useState)(""),[ax,ag]=(0,r.useState)(""),[af,av]=(0,r.useState)("");async function ay(){try{let t=await fetch("http://47.94.52.142:3007/api/preview-manifests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:U})}),s=await t.json();if(!t.ok||!s?.success||!s?.data?.id)throw Error(s?.message||"create failed");let n=s.data.id;N(n);let r=encodeURIComponent(JSON.stringify(U?.dataSources||{})),i=`http://47.94.52.142:3005/${h}/preview?previewId=${n}&device=${p}&appId=${e.appId}&data=${r}`;j(i),v("preview"),a({description:"zh"===h?"预览已生成":"Preview created"})}catch(e){a({description:e?.message||("zh"===h?"创建预览失败":"Failed to create preview"),variant:"destructive"}),v("code")}}async function aj(t,s){try{if(!s)try{let e=JSON.parse(x||"{}");H(t=>{let a={...t};if("manifest"===F)Object.assign(a,e);else if("app"===F)a.app=e;else if("dataSources"===F)a.dataSources=e;else if("page"===F){if(tC&&tz)try{let t=tC.pageKey.replace(/^p-/,"");tz.endsWith(".json")?(window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:t,sectionKey:tC.sectionKey,cardType:tC.cardType,props:e},"*"),tw(t=>({...t,[tz]:JSON.stringify(e,null,2)}))):tz.endsWith(".tsx")&&(window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:t,sectionKey:tC.sectionKey,cardType:tC.cardType,jsx:x},"*"),tw(e=>({...e,[tz]:x})))}catch{}else a.pages=a.pages||{},a.pages[V]=e}return a})}catch(e){a({description:e?.message||("zh"===h?"JSON 无法解析":"JSON parse error"),variant:"destructive"});return}if(!b)return ay();let n=t??U,r=await fetch(`http://47.94.52.142:3007/api/preview-manifests/${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:n})}),i=await r.json().catch(()=>({}));if(!r.ok||i?.success===!1)throw Error(i?.message||"save failed");try{let t=new URL(y||`http://47.94.52.142:3005/${h}/preview?previewId=${b}&device=${p}&appId=${e.appId}`);t.searchParams.set("device",p),t.searchParams.set("appId",String(e.appId));let a=JSON.stringify(U?.dataSources||{});t.searchParams.set("data",encodeURIComponent(a)),j(t.toString())}catch{let t=encodeURIComponent(JSON.stringify(U?.dataSources||{})),a=`http://47.94.52.142:3005/${h}/preview?previewId=${b}&device=${p}&appId=${e.appId}&data=${t}`;j(a)}a({description:"zh"===h?"已保存并刷新预览":"Saved and refreshed preview"})}catch(e){a({description:e?.message||("zh"===h?"保存失败":"Save failed"),variant:"destructive"})}}async function ab(){if(!$){I(!0);try{let t={...function(e,t,a,s){let n={};try{n=JSON.parse(s||"{}")}catch(e){throw Error(e?.message||("zh"===h?"JSON 无法解析":"JSON parse error"))}let r={...e||{}};return"manifest"===t?Object.assign(r,n):"app"===t?r.app=n:"dataSources"===t?r.dataSources=n:"page"===t&&(r.pages=r.pages||{},r.pages[a]=n),r}(U,F,V,x),dataMappings:eu,incomingMappings:eo},s=String(e.appId),n={};try{let e=await eH.api.applications.getApplication(s);n=(e.success&&e.data?e.data.config:{})||{}}catch{n={}}let r={...n,clientManifest:t},i=await eH.api.applications.updateApplication(s,{config:r});if(!i.success)throw Error(i.error||("zh"===h?"保存到数据库失败":"Save to database failed"));if(H(t),b){let a=await fetch(`http://47.94.52.142:3007/api/preview-manifests/${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:t})}),s=await a.json().catch(()=>({}));if(!a.ok||s?.success===!1)throw Error(s?.message||"save failed");try{let a=new URL(y||`http://47.94.52.142:3005/${h}/preview?previewId=${b}&device=${p}&appId=${e.appId}`);a.searchParams.set("device",p),a.searchParams.set("appId",String(e.appId));let s=JSON.stringify(t?.dataSources||{});a.searchParams.set("data",encodeURIComponent(s)),j(a.toString())}catch{let a=encodeURIComponent(JSON.stringify(t?.dataSources||{})),s=`http://47.94.52.142:3005/${h}/preview?previewId=${b}&device=${p}&appId=${e.appId}&data=${a}`;j(s)}}else{let a=await fetch("http://47.94.52.142:3007/api/preview-manifests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest:t})}),s=await a.json();if(!a.ok||!s?.success||!s?.data?.id)throw Error(s?.message||"create failed");let n=s.data.id;N(n);let r=encodeURIComponent(JSON.stringify(t?.dataSources||{})),i=`http://47.94.52.142:3005/${h}/preview?previewId=${n}&device=${p}&appId=${e.appId}&data=${r}`;j(i)}a({description:"zh"===h?"已保存到数据库并刷新预览":"Saved to database and refreshed preview"}),v("preview")}catch(e){a({description:e?.message||("zh"===h?"保存失败":"Save failed"),variant:"destructive"})}finally{I(!1)}}}return(0,n.jsxs)("main",{className:"h-[100dvh] overflow-hidden bg-gradient-to-br from-white via-blue-50 to-green-50",children:[(0,n.jsx)("div",{className:"max-w-[100rem] mx-auto p-3 h-full",children:(0,n.jsx)(o.Zp,{className:"p-0 overflow-hidden h-full",children:(0,n.jsxs)(eN,{direction:"horizontal",className:"h-full",children:[(0,n.jsx)(ew,{defaultSize:22,minSize:18,className:"bg-white",children:(0,n.jsx)("div",{className:"h-full overflow-y-auto p-3 space-y-3",children:O||L?L?(0,n.jsxs)("div",{className:"h-full overflow-y-auto p-1 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>{D(!1),R("preview"),v("preview");try{let t=U.app?.defaultLanguage||"zh",a=encodeURIComponent(JSON.stringify(U?.dataSources||{})),s=`http://47.94.52.142:3005/${t}/preview?previewId=${b}&device=${p}&appId=${e.appId}&data=${a}`;j(s)}catch{}},children:[(0,n.jsx)(eR.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"返回":"Back"]}),(0,n.jsx)("div",{className:"text-sm font-semibold",children:"zh"===h?"页面配置":"Page Settings"}),_&&(0,n.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/pages/",_,".json"]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"页面名称":"Page Title"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)(ek.p,{placeholder:"zh"===h?"中文标题":"Title ZH",value:_&&U.pages?.[_]?.title?.zh||"",onChange:e=>H(t=>{let a={...t};a.pages=a.pages||{};let s=a.pages[_]||{};return s.title={...s.title||{},zh:e.target.value},a.pages[_]=s,a})}),(0,n.jsx)(ek.p,{placeholder:"zh"===h?"英文标题":"Title EN",value:_&&U.pages?.[_]?.title?.en||"",onChange:e=>H(t=>{let a={...t};a.pages=a.pages||{};let s=a.pages[_]||{};return s.title={...s.title||{},en:e.target.value},a.pages[_]=s,a})})]}),(0,n.jsx)("div",{className:"text-[10px] text-muted-foreground",children:"zh"===h?"保存后右侧预览页标题会跟随显示":"Title applies to header after save"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,n.jsx)("span",{children:"zh"===h?"开启 顶部栏":"Show Header"}),(0,n.jsx)(eV.d,{checked:!!(_&&U.pages?.[_]?.options?.showHeader!==!1),onCheckedChange:e=>H(t=>{let a={...t};a.pages=a.pages||{};let s=a.pages[_]||{};return s.options={...s.options||{},showHeader:!!e},a.pages[_]=s,a})})]}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,n.jsxs)("div",{className:"text-xs text-muted-foreground",children:["zh"===h?"顶部标签栏（开启顶部栏后可用）":"Top Tabs (requires header)"," "]}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-3",children:(0,n.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,n.jsx)("span",{children:"zh"===h?"开启 顶部标签栏":"Enable Top Tabs"}),(0,n.jsx)(eV.d,{checked:!!(_&&U.pages?.[_]?.topBar?.enabled),onCheckedChange:e=>H(t=>{let a={...t};a.pages=a.pages||{};let s=a.pages[_]||{};return s.topBar={...s.topBar||{},enabled:!!e,tabs:Array.isArray(s.topBar?.tabs)?s.topBar?.tabs:[]},a.pages[_]=s,a})})]})}),!!U.pages?.[_]?.topBar?.enabled&&(0,n.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,n.jsx)("div",{className:"flex items-center gap-8 overflow-x-auto flex-nowrap",children:tq(U.pages?.[_]?.topBar?.tabs||[]).map((e,t)=>(0,n.jsxs)("button",{className:`relative text-lg flex-shrink-0 ${to===t?"text-primary":"text-foreground"}`,onClick:()=>td(t),children:[e.title||`${"zh"===h?"标签栏":""}${t+1}`,to===t&&(0,n.jsx)("span",{className:"absolute left-0 right-0 -bottom-1 mx-auto block h-1 w-20 bg-primary rounded-full"})]},`tabkey-${e?.id||t}`))}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{tG(""),tK(!0)},children:"zh"===h?"增加/管理":"Add/Manage"})})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"内容导航配置":"Content Navigation"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:function(){try{let e;let t=U.pages&&U.pages[_]||{};if(t?.topBar?.enabled){let a=t.tabContent||{};e=a?.[to]?.contentNav||{}}else e=t?.contentNav||{};let a=e.style||("text"===e.type?"text":(e.type,"icon"));e6("status"===e.category?"status":"navigation"),e8("text"===a?"text":"iconText"),tt(e.layout||"grid-4"),ts(Array.isArray(e.items)?e.items:[]),e5(!0)}catch{e6("navigation"),e8("iconText"),tt("grid-4"),ts([]),e5(!0)}},children:"zh"===h?"配置内容导航":"Configure"}),_&&U.pages?.[_]?.contentNav&&(0,n.jsxs)("div",{className:"text-[11px] text-muted-foreground",children:[U.pages[_]?.contentNav?.type==="iconText"?"zh"===h?"图+文":"Icon+Text":"zh"===h?"文字":"Text"," \xb7 ",U.pages[_]?.contentNav?.layout||"-"," \xb7 ",Array.isArray(U.pages[_]?.contentNav?.items)?U.pages[_]?.contentNav?.items.length:0," ","zh"===h?"项":"items"]})]}),(()=>{try{let e=U.pages?.[_]||{},t=e?.topBar?.enabled?e?.tabContent?.[to]?.contentNav:e?.contentNav;return!!t&&"text"===t.style}catch{return!1}})()&&(0,n.jsx)("div",{className:"mt-2 px-1",children:(0,n.jsx)("div",{className:"flex items-center gap-6 overflow-x-auto scrollbar-hide",children:(U.pages[_]?.contentNav?.items||[]).map((e,t)=>(0,n.jsxs)("button",{className:`relative pb-1 text-sm ${to===t?"text-primary":"text-muted-foreground hover:text-foreground"}`,onClick:()=>{td(t);try{let e=U.pages?.[_]||{},a=String(y||`http://47.94.52.142:3005/${h}/p/${_.replace(/^p-/,"")}`);fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json().catch(()=>null)).then(e=>{let s=e&&(e.id||e.data?.id),n=new URL(a);s&&n.searchParams.set("cfgId",String(s)),n.searchParams.set("tab",String(t)),j(n.toString())}).catch(()=>{let e=new URL(a);e.searchParams.set("tab",String(t)),j(e.toString())}),v("preview")}catch{}},children:[e?.title||`${"zh"===h?"标签":"Tab"} ${t+1}`,to===t&&(0,n.jsx)("span",{className:"absolute left-1/2 -translate-x-1/2 -bottom-0.5 h-0.5 w-6 bg-primary rounded-full"})]},t))})}),(()=>{try{let e=U.pages?.[_]||{},t=e?.topBar?.enabled?e?.tabContent?.[to]?.contentNav:e?.contentNav;return!!t&&"icon"===t.style}catch{return!1}})()&&(0,n.jsxs)("div",{className:"mt-2 px-1",children:[(0,n.jsx)("div",{className:"text-[11px] text-muted-foreground mb-1",children:"zh"===h?"点击图标以切换配置的卡片区域":"Click icon to switch section being configured"}),(0,n.jsx)("div",{className:"flex items-center gap-5 overflow-x-auto scrollbar-hide py-2",children:(U.pages[_]?.contentNav?.items||[]).map((e,t)=>(0,n.jsxs)("button",{className:`flex flex-col items-center gap-1 ${to===t?"text-primary":"text-foreground"}`,onClick:()=>{td(t);try{let e=U.pages?.[_]||{},a=String(y||`http://47.94.52.142:3005/${h}/p/${_.replace(/^p-/,"")}`);fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json().catch(()=>null)).then(e=>{let s=e&&(e.id||e.data?.id),n=new URL(a);s&&n.searchParams.set("cfgId",String(s)),n.searchParams.set("tab",String(t)),j(n.toString())}).catch(()=>{let e=new URL(a);e.searchParams.set("tab",String(t)),j(e.toString())}),v("preview")}catch{}},children:[(0,n.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 border border-gray-200"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:e?.title||`Item ${t+1}`})]},t))})]})]}),(0,n.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"数据定义":"Data Sources"}),(0,n.jsxs)(l.$,{variant:"secondary",size:"sm",onClick:()=>W(!0),children:[(0,n.jsx)(eO.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"添加数据":"Add Data"]})]}),(0,n.jsxs)("div",{className:"space-y-1 max-h-40 overflow-auto pr-1",children:[0===Object.entries(U.dataSources||{}).length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===h?"尚未添加数据源":"No data sources yet"}),Object.entries(U.dataSources||{}).map(([e,t])=>(0,n.jsxs)("div",{className:"flex items-center gap-2 border rounded-md px-2 py-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,n.jsx)(eP.A,{className:"w-3.5 h-3.5"}),(0,n.jsx)("span",{className:"font-medium",children:t?.label||e})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-600",children:t?.type}),(0,n.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>as(e),children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]})]},e))]})]}),(0,n.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,n.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[(0,n.jsx)("span",{children:"zh"===h?"数据映射":"Field Mapping"}),(0,n.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"zh"===h?"将卡片入参字段映射到所选数据源表字段":"Map card input fields to table fields"})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[0===Object.entries(eo||{}).length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===h?"等待子页面选择数据源后将自动出现映射项":"Mappings will appear after selecting data source in preview"}),Object.entries(eo||{}).map(([e,t])=>{let a=eg(t.inputs||{}),s=em[e]||t.dataSourceKey||"",r=ec[s]||[],i=eu[e]||{};return(0,n.jsxs)("div",{className:"border rounded-md p-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsxs)("div",{className:"text-xs font-medium",children:[t.cardName||t.cardType," → ",(0,n.jsx)("span",{className:"text-muted-foreground",children:(U.dataSources||{})[s]?.label||t.dataSourceLabel||s||"-"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-[10px] text-muted-foreground",children:new Date(t.timestamp).toLocaleString()}),(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>ev(e),children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]})]}),0===a.length?(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"暂无卡片入参字段":"No input fields"}):(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2",children:a.map(t=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-xs w-40 truncate",title:t,children:t}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)(eq.l6,{disabled:0===r.length||!s,value:r.length>0?i[t]??void 0:void 0,onValueChange:a=>ef(e,t,a),children:[(0,n.jsx)(eq.bq,{className:"max-w-[80px] w-full truncate",children:(0,n.jsx)(eq.yv,{placeholder:"zh"===h?"选择字段":"Choose field"})}),(0,n.jsx)(eq.gC,{children:0===r.length?(0,n.jsx)(eq.eb,{disabled:!0,value:"__no_fields__",children:"zh"===h?"（无可用字段）":"(no fields)"}):r.map(e=>(0,n.jsx)(eq.eb,{value:String(e.key),children:e.label||String(e.key)},String(e.key)))})]})}),(0,n.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>ey(e,t),title:"zh"===h?"清除该字段映射":"Clear mapping",children:(0,n.jsx)(eT.A,{className:"w-4 h-4"})})]},`${e}::${t}`))})]},e)})]})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"主内容":"Main Content"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(tc[tu]||[]).map(e=>(0,n.jsxs)("div",{className:"px-3 py-2 rounded-xl border bg-white flex items-center justify-between",children:[(0,n.jsx)("span",{className:"truncate text-sm text-foreground",children:e.displayName||e.type}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{try{let t=U.pages?.[_]?.topBar,a=t?.enabled?`tab-${to}`:`icon-${to}`,s=`pages/${_}/cards/${a}/${e.type}.json`;window.frames[0]?.postMessage({type:"GET_OVERRIDE",pageId:_.replace(/^p-/,""),sectionKey:a,cardType:e.type},"*"),setTimeout(()=>{let t=tN[s]||eQ();g(t),G("page"),v("code"),tS(s),tk({pageKey:_,sectionKey:a,cardType:e.type}),tI("json")},100)}catch{}},children:"zh"===h?"配置":"Config"}),(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{tR(e.displayName||e.type),tD(e.type),tP(!0),tB("1"),tJ(!1),tH("time")},children:"zh"===h?"显示":"Display"}),(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{try{let t=U.pages?.[_]?.topBar,a=t?.enabled?`tab-${to}`:`icon-${to}`;tY(e.displayName||e.type),t0(e.type);let s=t8[0]?.key||"",n=t1||s;t2(n),at(n),window.frames[0]?.postMessage({type:"GET_OVERRIDE",pageId:_.replace(/^p-/,""),sectionKey:a,cardType:e.type},"*"),tX(!0)}catch{}},children:"zh"===h?"筛选":"Filter"}),(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{try{let t=U.pages?.[_]?.topBar,a=t?.enabled?`tab-${to}`:`icon-${to}`,s=U.pages?.[_]?.innerPages&&U.pages[_].innerPages[a]&&U.pages[_].innerPages[a][e.type];H(t=>{let n={...t};if(n.pages=n.pages||{},!s){let t=`p-${Date.now().toString(36)}`;s=t,n.pages[t]={title:{zh:`${e.displayName||e.type}内页`,en:`${e.displayName||e.type} Detail`},layout:"mobile",route:`/${t}`,options:{showBack:!0},cards:[]};let r=n.pages[_]||{};r.innerPages=r.innerPages||{},r.innerPages[a]=r.innerPages[a]||{},r.innerPages[a][e.type]=t,n.pages[_]=r}return n}),setTimeout(()=>{try{let t=U.pages&&U.pages[s]||{title:{zh:`${e.displayName||e.type}内页`,en:`${e.displayName||e.type} Detail`},layout:"mobile",route:`/${s}`},a={...t,options:{...t?.options||{},showBack:!0}};fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json().catch(()=>null)).then(e=>{let t=e&&(e.id||e.data?.id),a=new URL(`http://47.94.52.142:3005/${h}/p/${String(s).replace(/^p-/,"")}`);t&&a.searchParams.set("cfgId",String(t)),j(a.toString())}).catch(()=>{let e=new URL(`http://47.94.52.142:3005/${h}/p/${String(s).replace(/^p-/,"")}`);j(e.toString())}),B(String(s)),D(!0),v("preview")}catch{}},0)}catch{}},children:"zh"===h?"内页":"Inner"})]})]},e.type)),(!tc[tu]||0===tc[tu].length)&&(0,n.jsx)("div",{className:"text-xs opacity-60",children:"zh"===h?"右侧新增卡片后，将自动出现在这里以配置显示":"New cards added on the right will appear here for display config."})]}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"其他卡片":"Other Cards"})]}),(0,n.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,n.jsxs)("label",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,n.jsx)("span",{children:"zh"===h?"开启 全局底部导航":"Show Bottom Nav"}),(0,n.jsx)(eV.d,{checked:!!(_&&U.pages?.[_]?.options?.showBottomNav!==!1),onCheckedChange:e=>H(t=>{let a={...t};a.pages=a.pages||{};let s=a.pages[_]||{};return s.options={...s.options||{},showBottomNav:!!e},a.pages[_]=s,a})})]}),(0,n.jsx)(l.$,{size:"sm",className:"w-full",onClick:()=>{try{let e=U.pages?.[_]||{},t=String(y||`http://47.94.52.142:3005/${h}/p/${_.replace(/^p-/,"")}`);fetch("http://47.94.52.142:3007/api/page-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json().catch(()=>null)).then(e=>{let a=e&&(e.id||e.data?.id),s=new URL(t);a&&s.searchParams.set("cfgId",String(a)),j(s.toString())}).catch(()=>{let e=new URL(t);j(e.toString())}),v("preview")}catch{}},children:"zh"===h?"保留浏览":"Keep Preview"})]})]}):(0,n.jsxs)("div",{className:"h-full p-1 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>{P(!1),R("preview"),v("preview");try{let t=U.app?.defaultLanguage||"zh",a=encodeURIComponent(JSON.stringify(U?.dataSources||{})),s=`http://47.94.52.142:3005/${t}/preview?previewId=${b}&device=${p}&appId=${e.appId}&data=${a}`;j(s)}catch{}},children:[(0,n.jsx)(eR.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"返回":"Back"]}),(0,n.jsx)("div",{className:"text-sm font-semibold",children:"zh"===h?"登录配置":"Login Settings"})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"布局模式":"Layout"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"centered"===M.layoutVariant?"default":"outline",onClick:()=>J(e=>({...e,layoutVariant:"centered"})),children:"zh"===h?"居中":"Centered"}),(0,n.jsx)(l.$,{size:"sm",variant:"bottomDocked"===M.layoutVariant?"default":"outline",onClick:()=>J(e=>({...e,layoutVariant:"bottomDocked"})),children:"zh"===h?"底部承载":"Bottom"})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"显示元素":"Visibility"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,n.jsx)("span",{className:"mr-2",children:"zh"===h?"背景":"Background"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>ai(!0),disabled:!M.showBackground,children:"zh"===h?"上传":"Upload"}),(0,n.jsx)(eV.d,{checked:M.showBackground,onCheckedChange:e=>J(t=>({...t,showBackground:!!e}))})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2",children:[(0,n.jsx)("span",{className:"mr-2",children:"logo"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>ao(!0),disabled:!M.showLogo,children:"zh"===h?"上传":"Upload"}),(0,n.jsx)(eV.d,{checked:M.showLogo,onCheckedChange:e=>J(t=>({...t,showLogo:!!e}))})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2 col-span-2",children:[(0,n.jsx)("span",{className:"mr-2",children:"zh"===h?"介绍":"Intro"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{au(M.introTitle?.zh||M.introTitle?.en||""),am(M.introText?.zh||M.introText?.en||""),ag(M.introTitle?.en||""),av(M.introText?.en||""),ac(!0)},disabled:!M.showIntro,children:"zh"===h?"编辑":"Edit"}),(0,n.jsx)(eV.d,{checked:M.showIntro,onCheckedChange:e=>J(t=>({...t,showIntro:!!e}))})]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"文本设置":"Text Settings"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"标题颜色":"Title Color"}),(0,n.jsx)(ek.p,{type:"color",value:M.titleColor||"#111111",onChange:e=>J(t=>({...t,titleColor:e.target.value}))})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"内容颜色":"Body Color"}),(0,n.jsx)(ek.p,{type:"color",value:M.bodyColor||"#6b7280",onChange:e=>J(t=>({...t,bodyColor:e.target.value}))})]})]})]}),(0,n.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"登录方式":"Login Methods"}),(0,n.jsx)("div",{className:"space-y-2",children:M.providers.map((e,t)=>(0,n.jsxs)("div",{className:"grid grid-cols-[20px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",draggable:"phone"!==e.key,onDragStart:a=>{"phone"!==e.key&&a.dataTransfer.setData("text/plain",String(t))},onDragOver:t=>{"phone"!==e.key&&t.preventDefault()},onDrop:a=>{if("phone"===e.key)return;a.preventDefault();let s=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(s)||s===t||0===s||0===t||J(e=>{let a=[...e.providers],[n]=a.splice(s,1);return a.splice(t,0,n),{...e,providers:a}})},children:[(0,n.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center opacity-70",children:(0,n.jsx)(c.A,{className:"w-4 h-4"})}),(0,n.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,n.jsx)(eV.d,{checked:e.enabled,onCheckedChange:a=>J(s=>({...s,providers:s.providers.map((s,n)=>n===t?{...s,enabled:"phone"===e.key||!!a}:s)})),disabled:"phone"===e.key})]},e.key))})]})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:"zh"===h?"配置/构建":"Config/Build"}),(0,n.jsx)(d.tU,{value:"config",className:"-mr-2",children:(0,n.jsxs)(d.j7,{children:[(0,n.jsx)(d.Xi,{value:"config",children:"zh"===h?"配置":"Config"}),(0,n.jsx)(d.Xi,{value:"ai",disabled:!0,children:"zh"===h?"AI 对话（稍后）":"AI (later)"})]})})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"默认语言（应用）":"Default Language (App)"}),(0,n.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gray-50 rounded-md p-1 border",children:[(0,n.jsx)(l.$,{size:"sm",variant:"zh"===U.app.defaultLanguage?"default":"ghost",onClick:()=>{H(e=>({...e,app:{...e.app,defaultLanguage:"zh",locale:"zh-CN"}}))},children:"中文"}),(0,n.jsx)(l.$,{size:"sm",variant:"en"===U.app.defaultLanguage?"default":"ghost",onClick:()=>{H(e=>({...e,app:{...e.app,defaultLanguage:"en",locale:"en-US"}}))},children:"EN"})]})]}),!1,(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"底部导航（最多5项）":"Bottom Nav (max 5)"}),(0,n.jsxs)("div",{className:"space-y-2",children:[U.app.bottomNav.map((e,t)=>(0,n.jsxs)("div",{className:"grid grid-cols-[20px_1fr_auto_auto_auto] items-center gap-2",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",String(t))},onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();let a=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(a)||a===t||H(e=>{let s=[...e.app.bottomNav],[n]=s.splice(a,1);return s.splice(t,0,n),{...e,app:{...e.app,bottomNav:s}}})},children:[(0,n.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center",children:(0,n.jsx)(c.A,{className:"w-4 h-4"})}),(0,n.jsx)(ek.p,{value:e.label,onChange:e=>H(a=>({...a,app:{...a.app,bottomNav:a.app.bottomNav.map((a,s)=>s===t?{...a,label:e.target.value}:a)}})),placeholder:"zh"===h?"名称":"Label"}),(0,n.jsxs)(l.$,{variant:"secondary",size:"sm",onClick:()=>{let t=(e.route||"").replace(/^\//,"")||e.key;if(t){try{let a=e.route?.startsWith("/")?e.route:`/${t}`,s=new URL(`http://47.94.52.142:3005/${h}${a}`);j(s.toString())}catch{let a=e.route?.startsWith("/")?e.route:`/${t}`;j(`http://47.94.52.142:3005/${h}${a}`)}B(t),D(!0),v("preview")}else a({description:"zh"===h?"请先设置路由":"Set route first"})},children:[(0,n.jsx)(eE.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"配置":"Config"]}),(0,n.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>{H(e=>{let a={...e,app:{...e.app,bottomNav:e.app.bottomNav.filter((e,a)=>a!==t)}};return setTimeout(()=>{aj(a,!0)},0),a})},children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]},e.key)),U.app.bottomNav.length<5&&(0,n.jsx)(l.$,{variant:"secondary",onClick:()=>H(e=>{let t=`k${Date.now()}`,a=`/p-${t}`,s={...e};s.app={...s.app,bottomNav:[...s.app.bottomNav,{key:t,label:"zh"===h?"新项":"Item",route:a}]};let n=(a||"").replace(/^\//,"")||`p-${t}`;return s.pages=s.pages||{},s.pages[n]||(s.pages[n]={title:{zh:"新页面",en:"New Page"},layout:"mobile",route:a,cards:[]}),s}),children:"zh"===h?"添加项":"Add Item"})]})]}),(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(l.$,{className:"w-full justify-center",variant:"secondary",onClick:()=>{P(!0),R("auth-login"),v("preview");try{let e=U.app?.defaultLanguage||"zh",t={layoutVariant:M.layoutVariant||"centered",showBackground:!!M.showBackground,backgroundImage:M.backgroundImage||void 0,showLogo:!!M.showLogo,logoImage:M.logoImage||void 0,showIntro:!!M.showIntro,introTitle:M.introTitle||void 0,introText:M.introText||void 0,titleColor:M.titleColor||void 0,bodyColor:M.bodyColor||void 0,providers:(M.providers||[]).map(e=>({key:e.key,enabled:!!e.enabled}))},a=new URL(`http://47.94.52.142:3005/${e}/auth/login`);a.searchParams.set("authCfg",JSON.stringify(t)),a.searchParams.set("v",String(Date.now())),j(a.toString())}catch{}},children:"zh"===h?"登录配置":"Login Settings"})}),(0,n.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"数据定义":"Data Sources"}),(0,n.jsxs)(l.$,{variant:"secondary",size:"sm",onClick:()=>W(!0),children:[(0,n.jsx)(eO.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"添加数据":"Add Data"]})]}),(0,n.jsxs)("div",{className:"space-y-1 max-h-40 overflow-auto pr-1",children:[0===Object.entries(U.dataSources||{}).length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===h?"尚未添加数据源":"No data sources yet"}),Object.entries(U.dataSources||{}).map(([e,t])=>(0,n.jsxs)("div",{className:"flex items-center gap-2 border rounded-md px-2 py-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,n.jsx)(eP.A,{className:"w-3.5 h-3.5"}),(0,n.jsx)("span",{className:"font-medium",children:t?.label||e})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-600",children:t?.type}),(0,n.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>as(e),children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]})]},e))]})]}),(0,n.jsxs)("div",{className:"pt-2 space-y-2",children:[(0,n.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[(0,n.jsx)("span",{children:"zh"===h?"数据映射":"Field Mapping"}),(0,n.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"zh"===h?"将卡片入参字段映射到所选数据源表字段":"Map card input fields to table fields"})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[0===Object.entries(eo||{}).length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground px-1",children:"zh"===h?"等待子页面选择数据源后将自动出现映射项":"Mappings will appear after selecting data source in preview"}),Object.entries(eo||{}).map(([e,t])=>{let a=eg(t.inputs||{}),s=em[e]||t.dataSourceKey||"",r=ec[s]||[],i=eu[e]||{};return(0,n.jsxs)("div",{className:"border rounded-md p-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsxs)("div",{className:"text-xs font-medium",children:[t.cardName||t.cardType," → ",(0,n.jsx)("span",{className:"text-muted-foreground",children:(U.dataSources||{})[s]?.label||t.dataSourceLabel||s||"-"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-[10px] text-muted-foreground",children:new Date(t.timestamp).toLocaleString()}),(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>ev(e),children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]})]}),0===a.length?(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"暂无卡片入参字段":"No input fields"}):(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2",children:a.map(t=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-xs w-40 truncate",title:t,children:t}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)(eq.l6,{disabled:0===r.length||!s,value:r.length>0?i[t]??void 0:void 0,onValueChange:a=>ef(e,t,a),children:[(0,n.jsx)(eq.bq,{className:"max-w-[80px] w-full truncate",children:(0,n.jsx)(eq.yv,{placeholder:"zh"===h?"选择字段":"Choose field"})}),(0,n.jsx)(eq.gC,{children:0===r.length?(0,n.jsx)(eq.eb,{disabled:!0,value:"__no_fields__",children:"zh"===h?"（无可用字段）":"(no fields)"}):r.map(e=>(0,n.jsx)(eq.eb,{value:String(e.key),children:e.label||String(e.key)},String(e.key)))})]})}),(0,n.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>ey(e,t),title:"zh"===h?"清除该字段映射":"Clear mapping",children:(0,n.jsx)(eT.A,{className:"w-4 h-4"})})]},`${e}::${t}`))})]},e)})]})]})]})})}),(0,n.jsx)(eG.lG,{open:q,onOpenChange:W,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[880px] w-[95vw] max-h-[80vh] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"选择数据源":"Choose Data Source"})}),(0,n.jsxs)("div",{className:"p-0",children:[(0,n.jsx)("div",{className:"p-3 text-xs text-muted-foreground",children:"zh"===h?"可选择整张表作为数据源，或展开表选择某条记录作为数据源。":"Choose a whole table or expand to pick a specific record."}),(0,n.jsxs)("div",{className:"px-3 pb-3 flex items-center gap-3",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(ek.p,{placeholder:"zh"===h?"搜索表/模块":"Search tables/modules",value:ee,onChange:e=>et(e.target.value),className:"pl-8 w-64"}),(0,n.jsx)(eL.A,{className:"w-4 h-4 absolute left-2 top-2.5 text-gray-400"})]}),(0,n.jsx)(l.$,{variant:"outline",onClick:eb,disabled:Y,children:"zh"===h?"刷新":"Refresh"})]}),(0,n.jsx)("div",{className:"px-3 pb-3",children:(0,n.jsx)(eF.F,{className:"h-[52vh] border rounded-lg",children:(0,n.jsxs)("div",{className:"divide-y",children:[Y&&(0,n.jsx)("div",{className:"p-4 text-sm text-muted-foreground",children:"zh"===h?"加载中...":"Loading..."}),!Y&&0===ej.length&&(0,n.jsx)("div",{className:"p-4 text-sm text-muted-foreground",children:"zh"===h?"暂无数据表":"No tables found"}),ej.map(e=>{let t=ea===e.id,a=en[e.id],s=!!ei[e.id];return(0,n.jsxs)("div",{className:"p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{className:"p-1 rounded hover:bg-gray-100",onClick:async()=>{let a=t?null:e.id;es(a),a&&await aa(e.id)},"aria-label":t?"collapse":"expand",children:t?(0,n.jsx)(eD.A,{className:"w-4 h-4"}):(0,n.jsx)(e_.A,{className:"w-4 h-4"})}),(0,n.jsx)(eP.A,{className:"w-4 h-4 text-blue-600"}),(0,n.jsx)("div",{className:"font-medium",children:e.name}),(0,n.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/ ",e.moduleName]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",onClick:()=>(function(e){let t=`table_${e.id}`;H(a=>{let s={...a};return s.dataSources=s.dataSources||{},s.dataSources[t]={type:"table",tableId:e.id,tableName:e.name,moduleName:e.moduleName,label:`${e.moduleName}/${e.name}`},s}),W(!1)})(e),children:"zh"===h?"整表":"Whole Table"}),(0,n.jsx)(l.$,{variant:"secondary",size:"sm",onClick:async()=>{es(e.id),await aa(e.id)},children:"zh"===h?"选择记录":"Pick Record"})]})]}),t&&(0,n.jsxs)("div",{className:"mt-2 ml-7",children:[s&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground p-2",children:"zh"===h?"加载记录...":"Loading records..."}),!s&&(a&&a.length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a.map(t=>(0,n.jsxs)("div",{className:"border rounded-md px-2 py-1.5 flex items-center gap-2",children:[(0,n.jsx)(eB.A,{className:"w-3.5 h-3.5 text-gray-500"}),(0,n.jsx)("div",{className:"text-sm truncate",title:t.label,children:t.label}),(0,n.jsx)("div",{className:"ml-auto",children:(0,n.jsx)(l.$,{size:"sm",onClick:()=>(function(e,t){let a=`record_${e.id}_${t.id}`;H(s=>{let n={...s};return n.dataSources=n.dataSources||{},n.dataSources[a]={type:"record",tableId:e.id,tableName:e.name,moduleName:e.moduleName,recordId:t.id,label:`${e.moduleName}/${e.name}#${t.label}`},n}),W(!1)})(e,t),children:"zh"===h?"选择":"Select"})})]},t.id))}):(0,n.jsx)("div",{className:"text-xs text-muted-foreground p-2",children:"zh"===h?"暂无记录":"No records"}))]})]},e.id)})]})})})]}),(0,n.jsx)(eG.Es,{children:(0,n.jsx)(l.$,{variant:"outline",onClick:()=>W(!1),children:"zh"===h?"关闭":"Close"})})]})}),(0,n.jsx)(eX,{open:tn,onOpenChange:tr,lang:h,pages:Object.keys(U.pages||{home:{}}),value:(()=>{if(null==ti)return;let e=ta[ti];return e?.event})(),onSave:e=>{null!=ti&&ts(t=>t.map((t,a)=>a===ti?{...t,event:e}:t))}}),(0,n.jsx)(eG.lG,{open:e3,onOpenChange:e5,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[760px] w-[95vw] max-h-[85vh] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"内容导航配置":"Content Navigation"})}),(0,n.jsx)(eF.F,{className:"max-h-[62vh] pr-2",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"展示样式":"Display Type"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"iconText"===e9?"default":"outline",onClick:()=>e8("iconText"),children:"zh"===h?"图+文":"Icon+Text"}),(0,n.jsx)(l.$,{size:"sm",variant:"text"===e9?"default":"outline",onClick:()=>e8("text"),children:"zh"===h?"文字":"Text"})]})]}),"iconText"===e9&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"排版":"Layout"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{size:"sm",variant:"grid-4"===te?"default":"outline",onClick:()=>tt("grid-4"),children:"zh"===h?"每行4个":"4 per row"}),(0,n.jsx)(l.$,{size:"sm",variant:"grid-5"===te?"default":"outline",onClick:()=>tt("grid-5"),children:"zh"===h?"每行5个":"5 per row"}),(0,n.jsx)(l.$,{size:"sm",variant:"scroll"===te?"default":"outline",onClick:()=>tt("scroll"),children:"zh"===h?"横向滑动":"Horizontal scroll"})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"导航项":"Items"}),(0,n.jsxs)("div",{className:"space-y-2",children:[ta.map((e,t)=>(0,n.jsxs)("div",{className:"iconText"===e9?"grid grid-cols-[20px_56px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2":"grid grid-cols-[20px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",String(t))},onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let a=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(a)||a===t||ts(e=>{let s=[...e],[n]=s.splice(a,1);return s.splice(t,0,n),s})},children:[(0,n.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-muted-foreground flex items-center justify-center opacity-70",children:(0,n.jsx)(c.A,{className:"w-4 h-4"})}),"iconText"===e9&&(0,n.jsx)("div",{className:"flex items-center gap-2",children:e.image?(0,n.jsx)("img",{src:e.image,alt:"icon",className:"w-12 h-12 rounded border object-cover"}):(0,n.jsx)("div",{className:"w-12 h-12 rounded border bg-gray-50 text-[10px] flex items-center justify-center text-gray-400",children:"img"})}),(0,n.jsx)(ek.p,{placeholder:"zh"===h?"标题(中文/英文皆可)":"Title",value:e.title||"",onChange:e=>ts(a=>a.map((a,s)=>s===t?{...a,title:e.target.value}:a))}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["iconText"===e9&&(0,n.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>(function(e){try{let t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async t=>{try{let a=t.target.files?.[0];if(!a)return;let s=await an(a,256,256,.9);ts(t=>t.map((t,a)=>a===e?{...t,image:s}:t))}catch{}},t.click()}catch{}})(t),children:"zh"===h?"上传图片":"Upload"}),(0,n.jsx)(l.$,{size:"sm",variant:"secondary",onClick:()=>{tl(t),tr(!0)},children:"zh"===h?"事件":"Event"}),(0,n.jsx)(l.$,{size:"icon",variant:"ghost",onClick:()=>ts(e=>e.filter((e,a)=>a!==t)),children:(0,n.jsx)(eA.A,{className:"w-4 h-4"})})]})]},t)),(0,n.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>ts(e=>[...e,{title:""}]),children:[(0,n.jsx)(eO.A,{className:"w-4 h-4 mr-1"}),"zh"===h?"新增导航":"Add Item"]})]})]})]})}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>e5(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:function(){H(e=>{let t={...e};t.pages=t.pages||{};let a=t.pages[_]||{},s={category:e7,style:"text"===e9?"text":"icon",layout:"iconText"===e9?te:void 0,items:ta};if(a?.topBar?.enabled){let e=a.tabContent||{},t=e[to]||{};e[to]={...t,contentNav:s},a.tabContent=e}else a.contentNav=s;return t.pages[_]=a,t}),e5(!1)},children:"zh"===h?"保存":"Save"})]})]})}),(0,n.jsx)(ez,{withHandle:!0}),(0,n.jsx)(ew,{defaultSize:50,minSize:35,className:"bg-gray-50",children:(0,n.jsxs)("div",{className:"h-full p-3 flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(d.tU,{value:f,onValueChange:e=>(function(e){if("preview"===e){if("auth-login"===T){let e=U.app?.defaultLanguage||("zh"===h?"zh":"en");j(`http://47.94.52.142:3005/${e}/auth/login`),v("preview")}else if("home"===T){let e=U.app?.defaultLanguage||("zh"===h?"zh":"en");j(`http://47.94.52.142:3005/${e}/home`),v("preview")}else ay()}else v("code")})(e),children:(0,n.jsxs)(d.j7,{children:[(0,n.jsx)(d.Xi,{value:"preview",children:"zh"===h?"预览":"Preview"}),(0,n.jsx)(d.Xi,{value:"code",children:"zh"===h?"代码":"Code"})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(l.$,{variant:"default",onClick:ab,disabled:$,children:$?"zh"===h?"保存中...":"Saving...":"zh"===h?"保存":"Save"}),(0,n.jsx)(l.$,{onClick:ay,children:"zh"===h?y?"刷新预览":"生成预览":y?"Refresh":"Generate"}),(0,n.jsx)(l.$,{variant:"outline",disabled:!0,title:"zh"===h?"PC 预览稍后提供":"PC preview later",children:"PC"}),(0,n.jsx)(l.$,{variant:"mobile"===p?"default":"outline",onClick:()=>u("mobile"),children:"Mobile"}),(0,n.jsx)(l.$,{variant:"outline",onClick:()=>m("zh"===h?"en":"zh"),children:"zh"===h?"中/EN":"EN/中"}),(0,n.jsx)("a",{href:`http://47.94.52.142:3007/docs/apps/${e.appId}/swagger`,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(l.$,{variant:"secondary",children:"API"})})]})]}),"code"===f?(0,n.jsx)("div",{className:"flex-1 min-h-[520px]",children:(0,n.jsxs)(eN,{direction:"horizontal",className:"h-full",children:[(0,n.jsxs)(ew,{defaultSize:20,minSize:14,className:"bg-white border rounded-xl overflow-auto",children:[(0,n.jsx)("div",{className:"p-2 text-xs text-muted-foreground",children:"zh"===h?"文件":"Files"}),(0,n.jsxs)("div",{className:"px-2 pb-2 space-y-1",children:[(0,n.jsx)(l.$,{variant:"manifest"===F?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>G("manifest"),children:"manifest.json"}),(0,n.jsx)(l.$,{variant:"app"===F?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>G("app"),children:"app.json"}),(0,n.jsx)("div",{className:"pt-1 text-[10px] uppercase tracking-wide text-muted-foreground",children:"zh"===h?"页面":"Pages"}),(0,n.jsx)("div",{className:"space-y-1",children:Object.keys(U.pages||{}).map(e=>(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)(l.$,{variant:"page"!==F||V!==e||tz?"ghost":"default",className:"w-full justify-start text-xs",onClick:()=>{K(e),tS(""),tk(null),tI("json"),G("page")},children:["pages/",e,".json"]}),(()=>{let t=`pages/${e}/cards/`,a=Object.keys(tN).filter(e=>e.startsWith(t));return 0===a.length?null:(0,n.jsx)("div",{className:"ml-2 pl-2 border-l space-y-1",children:a.sort().map(a=>{let s=a.slice(t.length).split("/");if(s.length<2)return null;let r=s[0],i=s.slice(1).join("/");if(i.endsWith(".tsx"))return null;let o=tz===a;return(0,n.jsxs)(l.$,{variant:o?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>{try{let t=a.endsWith(".tsx")?"typescript":"json";K(e),tS(a);let s=i.replace(/\.tsx$|\.json$/,""),n=s.includes(".")?s.split(".")[0]:s;tk({pageKey:e,sectionKey:r,cardType:n}),tI(t),g(tN[a]||""),v("code"),G("page")}catch{}},children:["cards/",r,"/",i]},a)})})})()]},e))}),(0,n.jsx)("div",{className:"pt-1 text-[10px] uppercase tracking-wide text-muted-foreground",children:"data"}),(0,n.jsx)(l.$,{variant:"dataSources"===F?"default":"ghost",className:"w-full justify-start text-xs",onClick:()=>G("dataSources"),children:"data-sources.json"})]})]}),(0,n.jsx)(ez,{withHandle:!0}),(0,n.jsx)(ew,{defaultSize:80,minSize:40,children:(0,n.jsx)(eZ,{height:"100%",defaultLanguage:t$,language:t$,theme:"vs",value:x,onChange:e=>{let t=e||"";g(t),tz&&(tA.current&&clearTimeout(tA.current),tA.current=setTimeout(()=>{try{if(tw(e=>({...e,[tz]:t})),tC){let e=tC.pageKey.replace(/^p-/,"");if(tz.endsWith(".json")){if(tE.current){tE.current=!1;return}let a=JSON.parse(t||"{}");window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:e,sectionKey:tC.sectionKey,cardType:tC.cardType,props:a},"*")}else tz.endsWith(".tsx")&&window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:e,sectionKey:tC.sectionKey,cardType:tC.cardType,jsx:t},"*")}}catch{}},300))},options:{wordWrap:"on",minimap:{enabled:!1},formatOnPaste:!0,formatOnType:!0,tabSize:2},onMount:function(e,t){S.current=e;try{t.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!0,schemas:[{uri:"aino://manifest.schema.json",fileMatch:["*"],schema:eU},{uri:"aino://card.schema.json",fileMatch:["**/pages/*/cards/**/*.json"],schema:eY}]})}catch{}z(!0)}})})]})}):(0,n.jsx)("div",{className:"flex-1 border rounded-xl bg-white overflow-hidden",children:y?(0,n.jsx)("iframe",{id:"my-app-iframe",src:`${y}&isEdite=true`,className:"w-full h-full"}):(0,n.jsx)("div",{className:"h-full flex items-center justify-center text-xs text-muted-foreground",children:"zh"===h?"点击上方预览按钮生成预览":"Switch to Preview to generate"})})]})})]})})}),(0,n.jsx)(eW.O,{open:C,onOpenChange:k,appId:String(e.appId),lang:h}),(0,n.jsx)(eG.lG,{open:ar,onOpenChange:ai,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"上传背景图":"Upload Background"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"建议尺寸：1080\xd71920（9:16）":"Suggested: 1080\xd71920 (9:16)"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{let t=e.target.files?.[0];if(!t)return;let a=await an(t,1080,1920,.82);J(e=>({...e,backgroundImage:a,showBackground:!0})),ai(!1)}}),M.backgroundImage&&(0,n.jsx)("img",{src:M.backgroundImage,alt:"bg",className:"mt-2 rounded-md border max-h-64 object-cover"})]}),(0,n.jsx)(eG.Es,{children:(0,n.jsx)(l.$,{variant:"outline",onClick:()=>ai(!1),children:"zh"===h?"关闭":"Close"})})]})}),(0,n.jsx)(eG.lG,{open:tV,onOpenChange:tK,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[560px] w-[96vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"标签管理":"Manage Tabs"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-end gap-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"新增标签名称":"New Tab Title"}),(0,n.jsx)(ek.p,{value:tF,onChange:e=>tG(e.target.value),placeholder:"zh"===h?"例如：推荐":"e.g. Featured"})]}),(0,n.jsx)(l.$,{onClick:()=>{try{let e=(tF||"").trim();if(!e)return;let t=`tab-${Date.now()}-${Math.random().toString(36).slice(2,7)}`;H(a=>{let s={...a};s.pages=s.pages||{};let n=s.pages[_]||{},r=Array.isArray(n.topBar?.tabs)?n.topBar.tabs:[],i=tq([...Array.isArray(r)?r:[],{id:t,title:e}]);return n.topBar={...n.topBar||{enabled:!0},tabs:i},s.pages[_]=n,s}),tG("")}catch{}},children:"zh"===h?"新增":"Add"})]}),0===(U.pages?.[_]?.topBar?.tabs||[]).length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"暂无标签，请先新增":"No tabs yet. Add one first."}),tq(U.pages?.[_]?.topBar?.tabs||[]).map((e,t)=>(0,n.jsxs)("div",{className:"grid grid-cols-[24px_1fr_auto] items-center gap-2 border rounded-md px-2 py-2",children:[(0,n.jsx)("div",{className:"text-xs",children:t+1}),(0,n.jsx)(ek.p,{className:"h-8",value:e.title||"",onChange:e=>H(a=>{let s={...a};s.pages=s.pages||{};let n=s.pages[_]||{},r=tq(Array.isArray(n.topBar?.tabs)?n.topBar.tabs:[]);return r[t]={...r[t]||{},title:e.target.value,id:r[t]?.id||`tab-${Date.now()}-${Math.random().toString(36).slice(2,7)}`},n.topBar={...n.topBar||{enabled:!0},tabs:r},s.pages[_]=n,s})}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(l.$,{size:"icon",variant:"ghost",onClick:()=>H(e=>{let a={...e};a.pages=a.pages||{};let s=a.pages[_]||{},n=tq(Array.isArray(s.topBar?.tabs)?s.topBar.tabs:[]);if(t>0){let e=n[t-1];n[t-1]=n[t],n[t]=e}return s.topBar={...s.topBar||{enabled:!0},tabs:n},a.pages[_]=s,a}),children:"↑"}),(0,n.jsx)(l.$,{size:"icon",variant:"ghost",onClick:()=>H(e=>{let a={...e};a.pages=a.pages||{};let s=a.pages[_]||{},n=tq(Array.isArray(s.topBar?.tabs)?s.topBar.tabs:[]);if(t<n.length-1){let e=n[t+1];n[t+1]=n[t],n[t]=e}return s.topBar={...s.topBar||{enabled:!0},tabs:n},a.pages[_]=s,a}),children:"↓"}),(0,n.jsx)(l.$,{size:"icon",variant:"ghost",onClick:()=>H(e=>{let a={...e};a.pages=a.pages||{};let s=a.pages[_]||{},n=tq(Array.isArray(s.topBar?.tabs)?s.topBar.tabs:[]);return n.splice(t,1),s.topBar={...s.topBar||{enabled:!0},tabs:n},a.pages[_]=s,a}),children:"✕"})]})]},`mgr-${e.id||t}`))]}),(0,n.jsx)(eG.Es,{children:(0,n.jsx)(l.$,{onClick:()=>tK(!1),children:"zh"===h?"完成":"Done"})})]})}),(0,n.jsx)(eG.lG,{open:tW,onOpenChange:tX,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[880px] w-[96vw] max-h-[85vh] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?`筛选设置：${tZ}`:`Filters: ${tZ}`})}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"数据源（表）":"Data Source (Table)"}),(0,n.jsx)("div",{className:"w-80",children:(0,n.jsxs)(eq.l6,{value:t1,onValueChange:e=>{t2(e),at(e)},children:[(0,n.jsx)(eq.bq,{children:(0,n.jsx)(eq.yv,{placeholder:"zh"===h?"选择数据源":"Choose data source"})}),(0,n.jsx)(eq.gC,{children:t8.map(e=>(0,n.jsx)(eq.eb,{value:e.key,children:e.label||e.key},e.key))})]})}),0===t8.length&&(0,n.jsx)("div",{className:"text-[11px] text-muted-foreground",children:"zh"===h?"请先在左侧添加数据源（整表）。":"Add a table data source first on the left."})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"可作为筛选的字段（单选/级联）":"Filterable fields (select/cascader)"}),(0,n.jsx)(eF.F,{className:"max-h-[40vh] border rounded-md",children:(0,n.jsxs)("div",{className:"p-3 space-y-2",children:[t4&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"加载中...":"Loading..."}),!t4&&0===t5.length&&(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"无可用字段（请在字段管理中配置 select/cascader）。":"No fields available (configure select/cascader in Fields)."}),t5.map(e=>{let t=!!t6[e.key]?.__checked;return(0,n.jsxs)("div",{className:"grid grid-cols-[20px_1fr] items-center gap-2 border rounded-md px-2 py-2",children:[(0,n.jsx)(eK.S,{checked:t,onCheckedChange:t=>t9(a=>({...a,[e.key]:{...a[e.key]||{fieldId:e.key,type:e.type,label:e.label},__checked:!!t}}))}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,n.jsx)("span",{className:"text-[10px] text-muted-foreground",children:e.type})]})]},e.key)})]})}),(0,n.jsx)("div",{className:"text-[11px] text-muted-foreground",children:"zh"===h?"多选字段，仅用于决定出现哪些筛选标签，不在此输入默认值。":"Multi-select fields to show as filter tags; no defaults here."})]})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>tX(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:()=>{try{let e=U.pages?.[_]?.topBar,t=e?.enabled?`tab-${to}`:`icon-${to}`,a=t5.filter(e=>t6[e.key]?.__checked).map(e=>({fieldId:e.key,type:e.type,label:e.label,options:"select"===e.type?Array.isArray(e.options)?e.options:[]:void 0,optionsTree:"cascader"===e.type?Array.isArray(e.optionsTree)?e.optionsTree:[]:void 0})),s={enabled:!0,dataSourceKey:t1||void 0,fields:a},n=tQ||"";window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:_.replace(/^p-/,""),sectionKey:t,cardType:n,filters:s},"*");let r=`pages/${_}/cards/${t}/${n}.json`,i=tN[r];if(i)try{let e={...JSON.parse(i||"{}"),filters:s},t=JSON.stringify(e,null,2);tw(e=>({...e,[r]:t})),tz===r&&(tE.current=!0,g(t))}catch{}tX(!1)}catch{}},children:"zh"===h?"保存":"Save"})]})]})}),(0,n.jsx)(eG.lG,{open:tO,onOpenChange:tP,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[720px] w-[96vw] bg-white/70 backdrop-blur-md rounded-2xl shadow-xl",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{className:"text-base font-semibold",children:"zh"===h?`显示设置：${tT}`:`Display: ${tT}`})}),(0,n.jsxs)("div",{className:"space-y-5",children:[(0,n.jsxs)("div",{className:"rounded-xl border p-4 bg-white/60",children:[(0,n.jsx)("div",{className:"text-sm font-medium mb-3",children:"zh"===h?"显示数量":"Limit"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(ek.p,{type:"number",min:1,value:t_,onChange:e=>tB(e.target.value),className:"w-28"}),(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(eV.d,{checked:tM,onCheckedChange:e=>tJ(!!e)}),(0,n.jsx)("span",{children:"zh"===h?"无限显示":"Unlimited"})]})]}),(0,n.jsx)("div",{className:"text-[11px] text-muted-foreground mt-2",children:"zh"===h?"数量越大渲染越多，可能影响性能":"Larger limits may affect performance"})]}),(0,n.jsxs)("div",{className:"rounded-xl border p-4 bg-white/60",children:[(0,n.jsx)("div",{className:"text-sm font-medium mb-3",children:"zh"===h?"展示来源":"Source"}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,n.jsx)(l.$,{size:"sm",variant:"pick"===tU?"default":"outline",onClick:()=>tH("pick"),children:"zh"===h?"指定内容":"Pick"}),(0,n.jsx)(l.$,{size:"sm",variant:"filter"===tU?"default":"outline",onClick:()=>tH("filter"),children:"zh"===h?"按过滤":"Filter"}),(0,n.jsx)(l.$,{size:"sm",variant:"time"===tU?"default":"outline",onClick:()=>tH("time"),children:"zh"===h?"按时间":"Time"}),(0,n.jsx)(l.$,{size:"sm",variant:"hot"===tU?"default":"outline",onClick:()=>tH("hot"),children:"zh"===h?"按热度":"Hot"})]}),"pick"===tU&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"zh"===h?"选择具体内容（占位，后续接数据选择器）":"Pick specific items (placeholder)"}),"filter"===tU&&(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,n.jsx)(ek.p,{placeholder:"zh"===h?"关键字":"Keyword"}),(0,n.jsx)(ek.p,{placeholder:"zh"===h?"类别（占位）":"Category (placeholder)"}),(0,n.jsx)(ek.p,{placeholder:"zh"===h?"标签（占位）":"Tags (placeholder)"})]}),"time"===tU&&(0,n.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(0,n.jsx)("div",{className:"text-muted-foreground",children:"zh"===h?"按时间降序":"Newest first"})}),"hot"===tU&&(0,n.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(0,n.jsx)("div",{className:"text-muted-foreground",children:"zh"===h?"按热度降序":"Hotness desc"})})]})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>tP(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:()=>{try{let e=U.pages?.[_]?.topBar,t=e?.enabled?`tab-${to}`:`icon-${to}`,a=tM?void 0:Math.max(1,parseInt(t_||"1",10)),s={mode:tU,limit:a,unlimited:!!tM},n=tL||"";window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:_.replace(/^p-/,""),sectionKey:t,cardType:n,display:s},"*");let r=`pages/${_}/cards/${t}/${n}.json`,i=tN[r];if(i)try{let e={...JSON.parse(i||"{}"),display:s},t=JSON.stringify(e,null,2);tw(e=>({...e,[r]:t})),tz===r&&(tE.current=!0,g(t))}catch{}}catch{}tP(!1)},children:"zh"===h?"保存":"Save"})]})]})}),(0,n.jsx)(eG.lG,{open:tm,onOpenChange:tx,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[820px] w-[96vw] max-h-[85vh] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?`配置：${tv}`:`Config: ${tv}`})}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"JSON 属性（保存后立即应用到右侧预览）":"JSON props (applies to preview on save)"}),(0,n.jsx)(eS.T,{value:tj,onChange:e=>tb(e.target.value),rows:16,className:"font-mono text-xs"})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>tx(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:()=>{try{let e=U.pages?.[_]?.topBar,t=e?.enabled?`tab-${to}`:`icon-${to}`,a=JSON.parse(tj||"{}");window.frames[0]?.postMessage({type:"SET_OVERRIDE",pageId:_.replace(/^p-/,""),sectionKey:t,cardType:tg,props:a},"*"),tx(!1)}catch(e){a({description:e?.message||("zh"===h?"JSON 无法解析":"Invalid JSON"),variant:"destructive"})}},children:"zh"===h?"保存":"Save"})]})]})}),(0,n.jsx)(eG.lG,{open:al,onOpenChange:ao,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"Logo"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"建议：正方形 PNG，至少 256\xd7256":"Square PNG, ≥256\xd7256"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{let t=e.target.files?.[0];if(!t)return;let a=await an(t,512,512,.9);J(e=>({...e,logoImage:a,showLogo:!0})),ao(!1)}}),M.logoImage&&(0,n.jsx)("img",{src:M.logoImage,alt:"logo",className:"mt-2 rounded-md border size-24 object-cover"})]}),(0,n.jsx)(eG.Es,{children:(0,n.jsx)(l.$,{variant:"outline",onClick:()=>ao(!1),children:"zh"===h?"关闭":"Close"})})]})}),(0,n.jsx)(eG.lG,{open:ad,onOpenChange:ac,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[560px] w-[95vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"编辑介绍":"Edit Intro"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"标题（中文）":"Title (ZH)"}),(0,n.jsx)(ek.p,{value:ap,onChange:e=>au(e.target.value),maxLength:30,placeholder:"zh"===h?"中文标题":"ZH Title"}),(0,n.jsx)(eC.J,{className:"mt-2 block",children:"zh"===h?"标题（英文）":"Title (EN)"}),(0,n.jsx)(ek.p,{value:ax,onChange:e=>ag(e.target.value),maxLength:60,placeholder:"zh"===h?"英文标题":"EN Title"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"介绍（中文，最多3行）":"Intro ZH (max 3 lines)"}),(0,n.jsx)(eS.T,{value:ah,onChange:e=>am(e.target.value),rows:3,maxLength:180,placeholder:"zh"===h?"中文介绍":"ZH Intro"}),(0,n.jsx)(eC.J,{className:"mt-2 block",children:"zh"===h?"介绍（英文，最多3行）":"Intro EN (max 3 lines)"}),(0,n.jsx)(eS.T,{value:af,onChange:e=>av(e.target.value),rows:3,maxLength:300,placeholder:"zh"===h?"英文介绍":"EN Intro"}),(0,n.jsx)("div",{className:"text-[10px] text-muted-foreground",children:"zh"===h?"建议每行约60字以内":"~60 chars per line suggested"})]})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>ac(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:()=>{J(e=>({...e,introTitle:{zh:ap.trim(),en:ax.trim()},introText:{zh:ah.trim(),en:af.trim()},showIntro:!0})),ac(!1)},children:"zh"===h?"确定":"OK"})]})]})}),(0,n.jsx)(eG.lG,{open:eM,onOpenChange:eJ,children:(0,n.jsxs)(eG.Cf,{className:"max-w-[520px] w-[92vw] bg-white",children:[(0,n.jsx)(eG.c7,{children:(0,n.jsx)(eG.L3,{children:"zh"===h?"设置路由":"Set Route"})}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eC.J,{children:"zh"===h?"路由":"Route"}),(0,n.jsx)(ek.p,{value:e2,onChange:e=>e4(e.target.value),placeholder:"/p-kxxxxxxxx or /home"}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"zh"===h?"建议页面使用 /p- 开头的短链接；必须以 / 开头。":"Recommend using short links starting with /p-; must start with /."})]}),(0,n.jsxs)(eG.Es,{children:[(0,n.jsx)(l.$,{variant:"outline",onClick:()=>eJ(!1),children:"zh"===h?"取消":"Cancel"}),(0,n.jsx)(l.$,{onClick:function(){let e=(e2||"").trim();if(!/^\/[A-Za-z0-9_\-/]*$/.test(e)||e.length<2){a({description:"zh"===h?"路由格式不正确，应以 / 开头，可包含字母数字-_/":"Invalid route. Must start with / and contain letters, numbers, - or _.",variant:"destructive"});return}H(t=>{let a={...t},s=[...a.app.bottomNav];if(null!=e0&&s[e0]){s[e0]={...s[e0],route:e},a.app.bottomNav=s;let t=(e||"").replace(/^\//,"");a.pages=a.pages||{},a.pages[t]||(a.pages[t]={title:{zh:"新页面",en:"New Page"},layout:"mobile",route:e,cards:[]})}return a}),eJ(!1)},children:"zh"===h?"保存":"Save"})]})]})})]})}},59757:(e,t,a)=>{Promise.resolve().then(a.bind(a,3017))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79545:(e,t,a)=>{"use strict";a.d(t,{S:()=>l});var s=a(33752);a(82153);var n=a(55108),r=a(55529),i=a(1237);function l({className:e,...t}){return(0,s.jsx)(n.bL,{"data-slot":"checkbox",className:(0,i.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,s.jsx)(n.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(r.A,{className:"size-3.5"})})})}},80886:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>r.default,__next_app__:()=>c,pages:()=>d,routeModule:()=>p,tree:()=>o});var s=a(50842),n=a(13725),r=a(82416),i=a(70122),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);a.d(t,l);let o={children:["",{children:["app",{children:["[appId]",{children:["client-config",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3017)),"/Users/wemo/new-flow/AINO/AINO-studio/app/app/[appId]/client-config/page.tsx"]}]},{}]},{error:[()=>Promise.resolve().then(a.bind(a,87033)),"/Users/wemo/new-flow/AINO/AINO-studio/app/app/[appId]/error.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,72330)),"/Users/wemo/new-flow/AINO/AINO-studio/app/layout.tsx"],error:[()=>Promise.resolve().then(a.bind(a,9556)),"/Users/wemo/new-flow/AINO/AINO-studio/app/error.tsx"],"global-error":[()=>Promise.resolve().then(a.bind(a,82416)),"/Users/wemo/new-flow/AINO/AINO-studio/app/global-error.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,31435,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,11622,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,5887,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/wemo/new-flow/AINO/AINO-studio/app/app/[appId]/client-config/page.tsx"],c={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/app/[appId]/client-config/page",pathname:"/app/[appId]/client-config",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},83073:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(74112).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},86312:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let s=a(33752),n=a(82153),r=a(34715),i=a(46006);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,n.lazy)(()=>t.loader().then(l)),d=t.loading;function c(e){let l=d?(0,s.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,c=o?n.Suspense:n.Fragment,p=t.ssr?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.PreloadChunks,{moduleIds:t.modules}),(0,s.jsx)(a,{...e})]}):(0,s.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(c,{...o?{fallback:l}:{},children:p})}return c.displayName="LoadableComponent",c}},94732:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var s=a(33752);a(82153);var n=a(1237);function r({className:e,...t}){return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,n.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[424,639,195,445,4,217,298,840,58],()=>a(80886));module.exports=s})();