"use strict";exports.id=58,exports.ids=[58],exports.modules={19394:(e,t,a)=>{a.d(t,{d:()=>l});var r=a(33752);a(82153);var s=a(70896),i=a(1237);function l({className:e,...t}){return(0,r.jsx)(s.bL,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,r.jsx)(s.zi,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},87929:(e,t,a)=>{a.d(t,{O:()=>M});var r=a(33752),s=a(82153),i=a(12042),l=a(1237);function n({...e}){return(0,r.jsx)(i._s.Root,{"data-slot":"drawer",...e})}function o({...e}){return(0,r.jsx)(i._s.Portal,{"data-slot":"drawer-portal",...e})}function d({className:e,...t}){return(0,r.jsx)(i._s.Overlay,{"data-slot":"drawer-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function c({className:e,children:t,...a}){return(0,r.jsxs)(o,{"data-slot":"drawer-portal",children:[(0,r.jsx)(d,{}),(0,r.jsxs)(i._s.Content,{"data-slot":"drawer-content",className:(0,l.cn)("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",e),...a,children:[(0,r.jsx)("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),t]})]})}function u({className:e,...t}){return(0,r.jsx)("div",{"data-slot":"drawer-header",className:(0,l.cn)("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",e),...t})}function p({className:e,...t}){return(0,r.jsx)(i._s.Title,{"data-slot":"drawer-title",className:(0,l.cn)("text-foreground font-semibold",e),...t})}function h({className:e,...t}){return(0,r.jsx)(i._s.Description,{"data-slot":"drawer-description",className:(0,l.cn)("text-muted-foreground text-sm",e),...t})}var m=a(90155),x=a(51322),g=a(85768),f=a(94732),y=a(56970),b=a(66482);let v=0,j=new Map,w=e=>{if(j.has(e))return;let t=setTimeout(()=>{j.delete(e),$({type:"REMOVE_TOAST",toastId:e})},1e6);j.set(e,t)},k=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?w(a):e.toasts.forEach(e=>{w(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},N=[],S={toasts:[]};function $(e){S=k(S,e),N.forEach(e=>{e(S)})}function A({...e}){let t=(v=(v+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>$({type:"DISMISS_TOAST",toastId:t});return $({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>$({type:"UPDATE_TOAST",toast:{...e,id:t}})}}var C=a(69123);let O=e=>Object.prototype.toString.call(e).split(" ")[1].split("]")[0],T=(e,t)=>{let a=e.split("."),r=t;for(let e=0;e<a.length;e++)if("Array"===O(r=r[a[e]]))return[r,a[e+1]];return[r]};function M({open:e,onOpenChange:t,appId:a,lang:i="zh",dirId:l,dirName:o,dirFields:d}){let{toast:v}=function(){let[e,t]=s.useState(S);return s.useEffect(()=>(N.push(t),()=>{let e=N.indexOf(t);e>-1&&N.splice(e,1)}),[e]),{...e,toast:A,dismiss:e=>$({type:"DISMISS_TOAST",toastId:e})}}(),[j,w]=(0,s.useState)("firecrawl"),[k,M]=(0,s.useState)(""),[E,I]=(0,s.useState)(""),[K,z]=(0,s.useState)(""),[D,F]=(0,s.useState)("weekdays"),[P,L]=(0,s.useState)("06:00"),[_,U]=(0,s.useState)(["Mon","Tue","Wed","Thu","Fri"]),[R,B]=(0,s.useState)(Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Shanghai"),[q,J]=(0,s.useState)(""),[G,W]=(0,s.useState)("url"),[V,H]=(0,s.useState)(!1),[X,Z]=(0,s.useState)(!1),[Q,Y]=(0,s.useState)(!1),[ee,et]=(0,s.useState)("1"),[ea,er]=(0,s.useState)(""),es=(e,t)=>"zh"===i?e:t,ei=(0,s.useMemo)(()=>({items:Array.from({length:6}).map((e,t)=>({title:`Senior Frontend Engineer ${t+1}`,desc:`React/Next.js \xb7 TypeScript \xb7 UI/UX`,salary:2e4+1e3*t,city:["åŒ—äº¬","ä¸Šæµ·","æ·±åœ³"][t%3],company:["AINO","Axis","Nova"][t%3],link:`https://jobs.example.com/${t+1}`,posted_at:"2025-09-01"})),data:[{name:"fallback"}],results:[]}),[]),[el,en]=(0,s.useState)("$.items"),[eo,ed]=(0,s.useState)(null),ec=(0,s.useMemo)(()=>eo||("$.items"===el?ei.items:"$.data"===el?ei.data:"$.results"===el?ei.results:[]),[el,ei,eo]),[eu,ep]=(0,s.useState)(""),[eh,em]=(0,s.useState)(""),[ex,eg]=(0,s.useState)({}),[ef,ey]=(0,s.useState)(""),[eb,ev]=(0,s.useState)(!1),[ej,ew]=(0,s.useState)({total:0,done:0,ok:0,fail:0}),ek=(0,s.useMemo)(()=>{if(Array.isArray(d)&&d.length>0){let e=[];return d.map(t=>{if("meta_items"===t.type)t.metaItemsConfig.fields.map(a=>{e.push({parentKey:t.key,key:`${t.key}::${a.id}`,label:`${t.label||t.key}-${a.label}`,originLabel:a.label,type:a.type,required:!!a.required})});else{let a={key:t.key,label:t.label||t.key,type:t.type||"text",required:!!t.required};e.push(a)}}),e}return[{key:"title",label:es("æ ‡é¢˜","Title"),type:"text",required:!0},{key:"description",label:es("æè¿°","Description"),type:"text"},{key:"salary",label:es("è–ªèµ„","Salary"),type:"number"},{key:"city",label:es("åŸŽå¸‚","City"),type:"text"},{key:"company",label:es("å…¬å¸","Company"),type:"text"},{key:"url",label:"URL",type:"url"}]},[d,i]),[eN,eS]=(0,s.useState)(1),e$=Math.max(1,Math.ceil(ek.length/10)),eA=(0,s.useMemo)(()=>ek.slice((eN-1)*10,10*eN),[ek,eN]),[eC,eO]=(0,s.useState)({}),[eT,eM]=(0,s.useState)({}),[eE,eI]=(0,s.useState)({}),[eK,ez]=(0,s.useState)([]),[eD,eF]=(0,s.useState)(""),[eP,eL]=(0,s.useState)(""),[e_,eU]=(0,s.useState)(""),eR=[{value:"none",label:es("æ— ","None")},{value:"trim",label:"trim"},{value:"toNumber",label:"toNumber"},{value:"parseDate",label:"parseDate"},{value:"splitTags",label:"splitTags"}];function eB(e,t){return"number"===e?"number"==typeof t?"none":"toNumber":"date"===e?"parseDate":"tags"===e||"multiselect"===e?Array.isArray(t)?"none":"splitTags":"text"===e?"trim":"none"}let eq=(0,s.useMemo)(()=>{try{let e=function e(t,a="",r=0,s=[]){if(!t||r>2)return s;if(Array.isArray(t))return t.length>0&&e(t[0],a,r+1,s),s;if("object"==typeof t)for(let i of Object.keys(t)){let l=a?`${a}.${i}`:i;s.push(l),"object"==typeof t[i]&&e(t[i],l,r+1,s)}return s}(ec?.[0]??{});return Array.from(new Set([...e,...eK])).sort()}catch{return eK}},[ec]);function eJ(e){let t=eK.length>0?eK:eq;if(!t||0===t.length)return[];let a=t.map(t=>({k:t,s:function(e,t){let a=e.toLowerCase(),r=t.toLowerCase();if(a===r)return 100;if(r.includes(a))return 80;if(a.includes(r))return 70;let s=0;for(let e of a.split(/[_-]/))r.includes(e)&&(s+=10);return s}(e.key,t)})).sort((e,t)=>t.s-e.s).map(e=>e.k);return(eD?a.filter(e=>e.toLowerCase().includes(eD.toLowerCase())):a).slice(0,15)}function eG(e,t){if(!e||!t)return;console.log(`ðŸ” getByPath è¾“å…¥:`,{obj:e,path:t,arrayPath:el});let a=t.replace(/^\$\.?/,""),r=(el?el.startsWith("$.")||"$"===el?el:el.startsWith("$")?`$.${el.slice(1)}`:`$.${el}`:el).replace(/^\$\.?/,"");r&&a.startsWith(r)&&(a=a.slice(r.length)).startsWith(".")&&(a=a.slice(1)),console.log(`ðŸ” å¤„ç†åŽçš„è·¯å¾„:`,a);let s=a.split(".").filter(Boolean),i=e;for(let e of s)if(console.log(`ðŸ” è®¿é—®è·¯å¾„éƒ¨åˆ†: ${e}, å½“å‰å€¼:`,i),i&&"object"==typeof i)console.log(`ðŸ” èŽ·å–åˆ°å€¼:`,i=i[e]);else{console.log(`ðŸ” è·¯å¾„ä¸­æ–­ï¼Œè¿”å›ž undefined`);return}return console.log(`ðŸ” æœ€ç»ˆç»“æžœ:`,i),i}function eW(e){if("number"==typeof e)return e;if("string"==typeof e){let t=e.match(/([0-9]+(?:\.[0-9]+)?)/);if(t)return Number(t[1])}return Number(e)||0}async function eV(){try{if(!l){v({description:es("ç¼ºå°‘ç›®å½•IDï¼Œæ— æ³•å…¥åº“","Missing directory id"),variant:"destructive"});return}if(!ec||0===ec.length){v({description:es("æš‚æ— æ ·ä¾‹ï¼Œè¯·å…ˆæŠ“å–æˆ–çˆ¬å–ã€‚","No samples yet. Scrape/crawl first."),variant:"destructive"});return}let e=(()=>{let e;console.log("\uD83D\uDD0D å¼€å§‹æå–æ•°ç»„æ•°æ®:",{arrayPath:el,sampleRecords:ec});let t=[];"$.items"===el&&ec&&ec.length>0&&(e=ec[0]);let a=function(e){let t={};for(let[a,r]of Object.entries(e)){let e=r.split(".");for(let r=1;r<=e.length;r++){let s=e.slice(0,r).join(".");t[s]||(t[s]=[]),t[s].push(a)}}let a={};for(let[e,r]of Object.entries(t))r.length>1&&(a[e]=r);let r={},s=new Set;for(let e of Object.keys(a).sort((e,t)=>t.length-e.length)){let t=a[e].filter(e=>!s.has(e));t.length>1&&(t.forEach(e=>s.add(e)),r[e]=t)}return r}(eC);for(let e in eC)eC[e].indexOf("$.items.")>-1&&(eC[e]=eC[e].replace("$.items.",""));for(let e in Object.keys(a).map(e=>{a[e.replace("$.items.","")]=a[e]}),a)e.indexOf("$.items.")>-1&&delete a[e];for(let e in a)a[e].forEach((t,r)=>{eC[t]&&(a[e][r]={[t]:eC[t].replace(`${e}.`,"")})});for(let r in a){let s=a[r],[i,l]=T(r,e);if(i instanceof Array)i.forEach((e,a)=>{let r={};s.forEach(t=>{Object.keys(t).forEach((a,s)=>{let[i,n]=a.split("::");n?(r[i]||(r[i]=[{images:[],label:`é¡¹ 1`,numbers:[],texts:[]}]),r[i][0].texts.push({id:n,value:e[l||t[a]],fieldId:n})):r[a]=e[l||t[a]]})}),t[a]={...t[a],...r}});else if("Object"===O(i)){let e={};Object.keys(currentMapping).forEach(t=>{e[t]=i[currentMapping[t]]}),t.push(e)}else{let e={};Object.keys(currentMapping).forEach(t=>{e[t]=i}),t.push(e)}}return t})();if(0===e.length){v({description:es("æœªæ‰¾åˆ°å¯å…¥åº“çš„æ•°æ®æ•°ç»„","No array data to upsert"),variant:"destructive"});return}let t=null;t="test-token",ev(!0),ew({total:e.length,done:0,ok:0,fail:0}),ey(es("æ­£åœ¨å…¥åº“â€¦","Upsertingâ€¦"));let a=eH(),r=0,s=0,i=0;for(let n of e)try{let e=await fetch(`${a}/api/records/${encodeURIComponent(String(l))}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({props:n})});if(!e.ok)throw Error(await e.text().catch(()=>"create failed"));r+=1}catch(e){console.error("Upsert failed:",e),s+=1}finally{i+=1,ew({total:e.length,done:i,ok:r,fail:s})}let n=es(`å…¥åº“å®Œæˆï¼šæˆåŠŸ ${r}ï¼Œå¤±è´¥ ${s}`,`Upsert done: ok ${r}, fail ${s}`);v({description:n}),ey(n)}finally{ev(!1)}}function eH(){return"http://47.94.52.142::3007"}async function eX(){let{firecrawlKey:e}=function(){let e={}[a]||{};return{openaiEndpoint:e.openaiEndpoint||e.fastgptEndpoint,openaiKey:e.openaiKey||e.fastgptKey,firecrawlKey:e.firecrawlKey}}();if(!e){v({description:es("è¯·å…ˆåœ¨æŽˆæƒç®¡ç†é…ç½® ScrapeGraphAI API Key","Please configure ScrapeGraphAI API Key in Authorization"),variant:"destructive"});return}let t=k.split(/\n+/).map(e=>e.trim()).filter(Boolean)[0]||E||"";if(!t){v({description:es("è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ª URL æˆ–åŸŸå","Please enter at least one URL or domain"),variant:"destructive"});return}try{eg(e=>({...e,scrape:!0})),ey(es("æ­£åœ¨æŠ“å–æ ·ä¾‹â€¦","Scraping sampleâ€¦"));let a=null;a="test-token";let r=await fetch(`${eH()}/api/crawl/scrape`,{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,"x-aino-firecrawl-key":e},body:JSON.stringify({url:t,domain:E,nlRule:K,options:{formats:["markdown","html"]}})}),s=await r.json().catch(()=>({}));if(!r.ok||s?.success===!1)throw Error(s?.message||"scrape failed");let i=Array.isArray(s?.data?.data)?s.data.data:[s?.data];ed(i||[]),v({description:es("å·²æŠ“å–æ ·ä¾‹ï¼Œå·²å›žå¡«åˆ°é¢„è§ˆ","Scraped sample filled into preview")}),ey(es("æŠ“å–å®Œæˆ","Scrape done"))}catch(e){console.error(e),v({description:es("æŠ“å–å¤±è´¥","Scrape failed"),variant:"destructive"}),ey(es("æŠ“å–å¤±è´¥","Scrape failed"))}finally{eg(e=>({...e,scrape:!1}))}}async function eZ(){H(!0);let e=null;e="test-token";let t=await fetch(`${eH()}/api/crawler/tanzhi/jobs`,{method:"GET",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),a=await t.json().catch(()=>({}));if(!t.ok||a?.success===!1)throw Error(a?.message||"batch start failed");ed([{result:{jobs:a.data}}]),H(!1)}return(0,s.useMemo)(()=>{let e=parseInt(q||"0",10);if(!Number.isNaN(e)&&e>0)return`0 */${e} * * * (${R})`;let[t,a]=(P||"06:00").split(":"),r={Sun:"0",Mon:"1",Tue:"2",Wed:"3",Thu:"4",Fri:"5",Sat:"6"};if(Q){let e=ea?new Date(ea).toLocaleDateString():"?";return`ONCE ${e} ${P} (${R})`}if("daily"===D)return`${a} ${t} * * * (${R})`;if("weekdays"===D)return`${a} ${t} * * 1-5 (${R})`;if("weekend"===D)return`${a} ${t} * * 6,0 (${R})`;if("monthly"===D)return`${a} ${t} ${ee} * * (${R})`;let s=_.map(e=>r[e]??"").filter(Boolean).join(",")||"1-5";return`${a} ${t} * * ${s} (${R})`},[D,P,_,R,q,Q,ee,ea]),(0,r.jsx)(n,{open:e,onOpenChange:t,children:(0,r.jsx)(c,{className:"border-none",children:(0,r.jsx)("div",{className:"mx-auto w-full max-w-6xl px-4 py-3",children:(0,r.jsxs)("div",{className:"rounded-2xl border border-white/40 bg-white/60 dark:bg-neutral-900/50 backdrop-blur-xl shadow-lg ring-1 ring-black/5",children:[(0,r.jsxs)(u,{className:"pb-2 bg-gradient-to-r from-transparent to-white/10 dark:to-neutral-900/10 rounded-t-2xl",children:[(0,r.jsx)(p,{children:es("AI è¿è¥ï¼ˆé‡‡é›†/æŠ½å–/å…¥åº“ï¼‰","AI Ops (Crawl/Extract/Upsert)")}),(0,r.jsx)(h,{children:es("é…ç½®æ•°æ®æºã€è§„åˆ™ã€ç›®æ ‡ä¸Žè°ƒåº¦ï¼›æ”¯æŒ Dry-run é¢„è§ˆåŽå†è½åº“ã€‚","Configure sources, rules, target and schedule; Dry-run before upsert.")})]}),(0,r.jsxs)("div",{className:"px-4 pb-4",children:[(0,r.jsxs)(m.F,{className:"h-[68vh] pr-2",children:[(0,r.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:es("æŒ‰æ¨¡æ¿æŠ“å–","Capture according to template")}),(0,r.jsx)("div",{className:"rounded-xl border bg-white/60 dark:bg-neutral-900/50 backdrop-blur p-2 max-h-[160px] overflow-auto text-xs",children:(0,r.jsx)(x.$,{size:"sm",className:"cursor-pointer",onClick:eZ,disabled:!!V,children:V?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"size-4 mr-1 animate-spin"}),es("æŠ“å–ä¸­","Scraping")]}):es("è°ˆèŒå²—ä½ä¿¡æ¯","Start scrape")})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:es("æ•°æ®æº","Source")}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(y.J,{children:es("URL åˆ—è¡¨(æ¯è¡Œä¸€ä¸ª)","URL list (one per line)")}),(0,r.jsx)(f.T,{value:k,onChange:e=>M(e.target.value),placeholder:es("https://...","https://..."),className:"min-h-[110px]"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(y.J,{children:es("è‡ªç„¶è¯­è¨€è§„åˆ™","Natural language rule")}),(0,r.jsx)(f.T,{value:K,onChange:e=>z(e.target.value),placeholder:es("ä¾‹å¦‚ï¼šæˆ‘æƒ³è¦ä»»ä½•æ•°æ® / åªè¦æµ·æ·€åŒºçš„ / åŸŽå¸‚=åŒ—äº¬ï¼Œå²—ä½=å‰ç«¯ï¼Œè–ªèµ„>20k","e.g. I want any data / Only Haidian district / city=Beijing, role=frontend, salary>20k"),className:"min-h-[80px]"}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,r.jsx)("div",{children:es("æ”¯æŒå¤šç§è¡¨è¾¾æ–¹å¼ï¼š","Supports various expressions:")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-1 text-[10px]",children:[(0,r.jsxs)("div",{children:["â€¢ ",es("é€šç”¨é‡‡é›†ï¼šæˆ‘æƒ³è¦ä»»ä½•æ•°æ®ã€å…¨éƒ¨éƒ½è¦ã€éƒ½å¯ä»¥","General: I want any data, all data, anything")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("åŸŽå¸‚ç­›é€‰ï¼šåªè¦æµ·æ·€åŒºã€åŸŽå¸‚=åŒ—äº¬ã€åœ¨æµ·æ·€åŒº","City: Only Haidian, city=Beijing, in Haidian")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("å²—ä½ç­›é€‰ï¼šåªè¦å‰ç«¯å¼€å‘ã€å²—ä½=å‰ç«¯ã€éœ€è¦å‰ç«¯å·¥ç¨‹å¸ˆ","Role: Only frontend dev, role=frontend, need frontend engineer")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("è–ªèµ„ç­›é€‰ï¼š10kä»¥ä¸Šã€è–ªèµ„>20kã€æœ€ä½Ž15k","Salary: Above 10k, salary>20k, minimum 15k")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("å…¬å¸ç­›é€‰ï¼šåªè¦è…¾è®¯çš„ã€å…¬å¸=è…¾è®¯ã€åœ¨è…¾è®¯å·¥ä½œ","Company: Only Tencent, company=Tencent, work at Tencent")]})]})]})]})]}),(0,r.jsxs)("section",{className:"space-y-3 lg:col-span-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:es("æŠ½å–æ ·ä¾‹","Extracted Samples")}),(0,r.jsx)("div",{className:"rounded-xl border bg-white/60 dark:bg-neutral-900/50 backdrop-blur p-2 max-h-[160px] overflow-auto text-xs",children:0===ec.length?(0,r.jsx)("div",{className:"text-muted-foreground",children:es("æš‚æ— æ ·ä¾‹ï¼Œè¯·å…ˆæŠ“å–æˆ–çˆ¬å–ã€‚","No samples yet. Scrape/crawl first.")}):(0,r.jsx)("pre",{className:"whitespace-pre-wrap break-all",children:JSON.stringify(ec.slice(0,3),null,2)})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:es("å­—æ®µæ˜ å°„","Field Mapping")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.$,{variant:"secondary",size:"sm",onClick:function(){let e={},t={title:["title","name","job_title","position","èŒä½","å²—ä½","åç§°"],description:["description","desc","content","detail","æè¿°","å†…å®¹","è¯¦æƒ…","ä»‹ç»"],salary:["salary","pay","wage","è–ªèµ„","å·¥èµ„","å¾…é‡","æŠ¥é…¬"],city:["city","location","address","åŸŽå¸‚","åœ°ç‚¹","åœ°å€","ä½ç½®"],company:["company","employer","corp","å…¬å¸","ä¼ä¸š","é›‡ä¸»"],url:["url","link","href","é“¾æŽ¥","ç½‘å€"],date:["date","time","created","posted","æ—¥æœŸ","æ—¶é—´","å‘å¸ƒæ—¶é—´"],experience:["experience","exp","years","ç»éªŒ","å¹´é™"],education:["education","degree","å­¦åŽ†","å­¦ä½"],type:["type","category","kind","ç±»åž‹","åˆ†ç±»"],level:["level","grade","çº§åˆ«","ç­‰çº§"],skills:["skills","requirements","æŠ€èƒ½","è¦æ±‚","è¦æ±‚æŠ€èƒ½"],benefits:["benefits","perks","ç¦åˆ©","å¾…é‡"]};for(let a of ek){let r=eK.find(e=>t[a.key]?.some(t=>e.toLowerCase().includes(t.toLowerCase())));if(r){e[a.key]=r;continue}let s=eK.find(e=>e.toLowerCase().includes(a.key.toLowerCase().slice(0,4))||a.key.toLowerCase().includes(e.toLowerCase().slice(0,4)));s&&(e[a.key]=s)}eO(e),v({description:es("å·²è‡ªåŠ¨åŒ¹é…ç›¸è¿‘å­—æ®µ","Auto matched similar fields")})},children:es("è‡ªåŠ¨åŒ¹é…","Auto match")}),(0,r.jsx)(x.$,{variant:"outline",size:"sm",onClick:function(){eO({})},children:es("æ¸…ç©º","Clear")})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-blue-900 mb-2",children:es("å­—æ®µæ˜ å°„è¯´æ˜Ž","Field Mapping Guide")}),(0,r.jsxs)("div",{className:"text-xs text-blue-800 space-y-1",children:[(0,r.jsxs)("div",{children:["â€¢ ",es("é‡‡é›†æ•°æ® â†’ æ˜ å°„å­—æ®µ â†’ æ ¼å¼åŒ–å­˜å‚¨","Scraped Data â†’ Map Fields â†’ Format & Store")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("ä¾‹å¦‚ï¼šé‡‡é›†åˆ°'èŒä½åç§°' â†’ æ˜ å°„åˆ°'title'å­—æ®µ â†’ å­˜å‚¨ä¸ºæ–‡æœ¬æ ¼å¼","e.g. 'Job Title' â†’ map to 'title' field â†’ store as text")]}),(0,r.jsxs)("div",{children:["â€¢ ",es("ä¾‹å¦‚ï¼šé‡‡é›†åˆ°'è–ªèµ„15k' â†’ æ˜ å°„åˆ°'salary'å­—æ®µ â†’ è½¬æ¢ä¸ºæ•°å­—15000","e.g. 'Salary 15k' â†’ map to 'salary' field â†’ convert to number 15000")]})]})]}),eK.length>0&&(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-green-900 mb-2",children:[es("é‡‡é›†æ•°æ®å­—æ®µ","Scraped Data Fields")," (",eK.length,")"]}),(0,r.jsxs)("div",{className:"text-xs text-green-800",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:eK.map(e=>(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 rounded text-green-700",children:e},e))}),(0,r.jsx)("div",{className:"mt-2 text-green-600",children:es("ç³»ç»Ÿå·²è‡ªåŠ¨åˆ†æžé‡‡é›†æ•°æ®ç»“æž„ï¼Œå¹¶å°è¯•åŒ¹é…åˆ°æ‚¨çš„å­—æ®µ","System has analyzed scraped data structure and attempted to match to your fields")})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(x.$,{variant:"outline",size:"sm",onClick:eX,disabled:!!ex.scrape,children:ex.scrape?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"size-4 mr-1 animate-spin"}),es("æŠ“å–ä¸­","Scraping")]}):es("å¼€å§‹æŠ“å–","Start scrape")})})]}),(0,r.jsxs)("div",{className:"rounded-xl border bg-white/60 dark:bg-neutral-900/50 backdrop-blur p-0",children:[ef&&(0,r.jsxs)("div",{className:"px-3 py-2 text-xs text-muted-foreground border-b bg-white/50 dark:bg-neutral-900/40 flex items-center gap-2",children:[(0,r.jsx)(C.A,{className:`size-3 ${Object.values(ex).some(Boolean)?"animate-spin":""}`}),(0,r.jsx)("span",{children:ef})]}),(0,r.jsx)("div",{className:"max-h-[240px] overflow-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{className:"sticky top-0 bg-white/70 dark:bg-neutral-900/70 backdrop-blur",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left px-3 py-2 w-[26%]",children:es("å­—æ®µ","Field")}),(0,r.jsxs)("th",{className:"text-left px-3 py-2 w-[30%]",children:[es("æ¥æºé”®","Source key"),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(g.p,{value:eD,onChange:e=>eF(e.target.value),placeholder:es("æœç´¢é”®","Search keys"),className:"h-7"})})]}),(0,r.jsx)("th",{className:"text-left px-3 py-2 w-[22%]",children:es("è½¬æ¢","Transform")}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:es("ç¤ºä¾‹","Sample")})]})}),(0,r.jsx)("tbody",{children:eA.map(e=>(0,r.jsxs)("tr",{className:"border-t",children:[(0,r.jsxs)("td",{className:"px-3 py-2",children:[(0,r.jsx)("div",{className:"font-medium",children:e.label}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:e.key})]}),(0,r.jsx)("td",{className:"px-3 py-2 space-y-1",children:"progress"===e.key?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)(g.p,{value:eE[e.key]?.arrayPath||"$.progress",onChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{aggregation:"weightedAverage"},arrayPath:t.target.value}})),placeholder:es("æ•°ç»„è·¯å¾„ å¦‚ $.progress","Array path e.g. $.progress")}),(0,r.jsxs)(b.l6,{value:eE[e.key]?.aggregation||"weightedAverage",onValueChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{},aggregation:t}})),children:[(0,r.jsx)(b.bq,{children:(0,r.jsx)(b.yv,{})}),(0,r.jsxs)(b.gC,{children:[(0,r.jsx)(b.eb,{value:"weightedAverage",children:"weightedAverage"}),(0,r.jsx)(b.eb,{value:"max",children:"max"}),(0,r.jsx)(b.eb,{value:"min",children:"min"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[(0,r.jsx)(g.p,{value:eE[e.key]?.labelKey||"label",onChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{aggregation:"weightedAverage"},labelKey:t.target.value}})),placeholder:es("æ ‡ç­¾é”® label","label key")}),(0,r.jsx)(g.p,{value:eE[e.key]?.valueKey||"value",onChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{aggregation:"weightedAverage"},valueKey:t.target.value}})),placeholder:es("æ•°å€¼é”® value","value key")}),(0,r.jsx)(g.p,{value:eE[e.key]?.statusKey||"status",onChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{aggregation:"weightedAverage"},statusKey:t.target.value}})),placeholder:es("çŠ¶æ€é”® status","status key")}),(0,r.jsx)(g.p,{value:eE[e.key]?.weightKey||"weight",onChange:t=>eI(a=>({...a,[e.key]:{...a[e.key]||{aggregation:"weightedAverage"},weightKey:t.target.value}})),placeholder:es("æƒé‡é”® weight","weight key")})]}),(0,r.jsx)("div",{className:"text-[10px] text-muted-foreground",children:es("æ ·ä¾‹: [{label,value,status,weight}] å°†æŒ‰èšåˆè§„åˆ™å±•ç¤º","Sample: [{label,value,status,weight}] aggregated by rule")})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.p,{value:eC[e.key]||"",onChange:t=>eO(a=>({...a,[e.key]:t.target.value})),placeholder:es("å¦‚ title/desc/link","e.g. title/desc/link")}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[eJ(e).map(t=>(0,r.jsx)("button",{type:"button",onClick:()=>eO(a=>({...a,[e.key]:t})),className:`text-[10px] px-1.5 py-0.5 rounded border whitespace-nowrap ${eC[e.key]===t?"bg-blue-600 text-white border-blue-600":"bg-white/70 hover:bg-gray-100"}`,title:t,children:t},t)),0===eJ(e).length&&(0,r.jsx)("span",{className:"text-[10px] text-gray-500",children:es("æ— å¯ç”¨å­—æ®µ","No available fields")}),e.required&&!eC[e.key]&&(0,r.jsx)("span",{className:"text-[10px] text-red-600 ml-1",children:es("å¿…å¡«","Required")})]})]})}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsxs)(b.l6,{value:eT[e.key]||eB(e.type,(ec?.[0]??{})[eC[e.key]||""]),onValueChange:t=>eM(a=>({...a,[e.key]:t})),children:[(0,r.jsx)(b.bq,{children:(0,r.jsx)(b.yv,{})}),(0,r.jsx)(b.gC,{children:eR.map(e=>(0,r.jsx)(b.eb,{value:e.value,children:e.label},e.value))})]})}),(0,r.jsx)("td",{className:"px-3 py-2 text-xs text-muted-foreground truncate",children:String(ec?.[0]?.[eC[e.key]||""])||"â€”"})]},e.key))})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 text-xs text-muted-foreground",children:[(0,r.jsxs)("div",{children:[es("ç¬¬","Page")," ",eN,"/",e$]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.$,{variant:"outline",size:"sm",disabled:eN<=1,onClick:()=>eS(e=>Math.max(1,e-1)),children:"Prev"}),(0,r.jsx)(x.$,{variant:"outline",size:"sm",disabled:eN>=e$,onClick:()=>eS(e=>Math.min(e$,e+1)),children:"Next"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:es("é¢„è§ˆ","Preview")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.$,{variant:"outline",size:"sm",onClick:function(){if(!ec||0===ec.length){v({description:es("æš‚æ— æ ·ä¾‹ï¼Œè¯·å…ˆæŠ“å–æˆ–çˆ¬å–ã€‚","No samples yet. Scrape/crawl first."),variant:"destructive"});return}let e=ec[0],t={};for(let a of ek){if("progress"===a.key)continue;let r=eC[a.key];if(!r)continue;let s=eG(e,r),i=function(e,t){switch(t){case"trim":return"string"==typeof e?e.trim():e;case"toNumber":return eW(e);case"parseDate":default:return e;case"splitTags":return"string"==typeof e?e.split(/[ï¼Œ,\s]+/).filter(Boolean):Array.isArray(e)?e:[]}}(s,eT[a.key]||eB(a.type,s));t[a.key]=i}let a=eE.progress||{arrayPath:"$.progress",labelKey:"label",valueKey:"value",statusKey:"status",weightKey:"weight",aggregation:"weightedAverage"},r=eG(e,a.arrayPath),s=[];Array.isArray(r)?s=r.map((e,t)=>({id:String(t+1),key:String(e[a.labelKey]||`p${t+1}`),label:String(e[a.labelKey]||`Progress ${t+1}`),value:Math.max(0,Math.min(100,eW(e[a.valueKey]))),status:e[a.statusKey||"status"]||void 0,weight:void 0!==e[a.weightKey||"weight"]?eW(e[a.weightKey||"weight"]):1})):eC.progress&&(s=[{id:"1",key:"progress",label:"Progress",value:Math.max(0,Math.min(100,eW(eG(e,eC.progress)))),weight:1}]),t.progress={items:s,aggregated:function(e,t="weightedAverage"){let a=e.map(e=>({v:Number(e.value??0),w:Number(e.weight??1)}));if("max"===t)return Math.max(0,...a.map(e=>e.v));if("min"===t)return Math.min(100,...a.map(e=>e.v));let r=a.reduce((e,t)=>e+(isFinite(t.w)?t.w:0),0)||1;return Math.max(0,Math.min(100,Math.round(a.reduce((e,t)=>e+(isFinite(t.v)?t.v:0)*(isFinite(t.w)?t.w:0),0)/r)))}(s,a.aggregation)},eU(JSON.stringify({original:e,mapped:t},null,2))},children:es("æœ¬åœ°é¢„è§ˆ","Local preview")}),(0,r.jsx)(x.$,{size:"sm",onClick:eV,disabled:eb||!l,children:eb?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"size-4 mr-1 animate-spin"}),es("å…¥åº“ä¸­â€¦","Upsertingâ€¦")]}):es("å…¥åº“","Upsert")})]})]}),(0,r.jsx)("div",{className:"rounded-xl border bg-white/60 dark:bg-neutral-900/50 backdrop-blur p-3 text-xs text-muted-foreground min-h-[120px]",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap break-all",children:e_||es("Dry-run åŽå°†åœ¨æ­¤æ˜¾ç¤ºï¼šåŽŸå§‹â†’è§„èŒƒåŒ–â†’å­—æ®µæ˜ å°„å¯¹ç…§ã€‚","After dry-run, original â†’ normalized â†’ field mapping diffs will appear here.")})})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-3",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:es("æ¥æºä¸Žå˜æ›´å°†è¢«å®¡è®¡è®°å½•ï¼Œæ”¯æŒå›žæº¯ã€‚","Source & changes are audited for traceability.")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.$,{variant:"outline",onClick:()=>t(!1),children:es("å–æ¶ˆ","Cancel")}),(0,r.jsx)(x.$,{variant:"secondary",onClick:function(){let e={}[a]||{},t=e.openaiEndpoint||e.fastgptEndpoint,r=e.openaiKey||e.fastgptKey;if(!t||!r){v({description:es("è¯·å…ˆåœ¨è®¾ç½®/æŽˆæƒç®¡ç†ä¸­é…ç½® OpenAI Endpoint ä¸Ž Key","Please configure OpenAI Endpoint & Key in Settings/Authorization first"),variant:"destructive"});return}v({description:es("å·²æäº¤ Dry-runï¼Œè¯·ç¨ç­‰â€¦","Dry-run submitted, please waitâ€¦")}),fetch("http://47.94.52.142::3007/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json","x-aino-openai-endpoint":t,"x-aino-openai-key":r},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"user",content:"ping"}]})}).then(async e=>{if(!e.ok)throw Error(await e.text());v({description:es("AI ç½‘å…³å·²å“åº”","AI gateway responded")})}).catch(e=>{console.error(e),v({description:es("AI ç½‘å…³è°ƒç”¨å¤±è´¥","AI gateway call failed"),variant:"destructive"})})},children:es("Dry-run é¢„è§ˆ","Dry-run")}),(0,r.jsx)(x.$,{variant:"outline",onClick:function(){v({description:es("å·²å¼€å§‹è¿è¡Œï¼ŒåŽå°æ‰§è¡Œä¸­","Run started in background")})},children:es("ç«‹å³è¿è¡Œ","Run now")}),(0,r.jsx)(x.$,{onClick:eV,disabled:eb||!l,children:eb?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"size-4 mr-1 animate-spin"}),es("å…¥åº“ä¸­â€¦","Upsertingâ€¦")]}):es("å…¥åº“","Upsert")})]})]}),eb&&(0,r.jsxs)("div",{className:"pt-2 text-xs text-muted-foreground",children:[es("è¿›åº¦","Progress"),": ",ej.done,"/",ej.total," ",es("æˆåŠŸ","OK"),": ",ej.ok," ",es("å¤±è´¥","Fail"),": ",ej.fail]})]})]})})})})}},90155:(e,t,a)=>{a.d(t,{F:()=>l});var r=a(33752);a(82153);var s=a(93669),i=a(1237);function l({className:e,children:t,...a}){return(0,r.jsxs)(s.bL,{"data-slot":"scroll-area",className:(0,i.cn)("relative",e),...a,children:[(0,r.jsx)(s.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,r.jsx)(n,{}),(0,r.jsx)(s.OK,{})]})}function n({className:e,orientation:t="vertical",...a}){return(0,r.jsx)(s.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,i.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...a,children:(0,r.jsx)(s.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}}};