# ğŸ³ AINO Docker ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ“‹ Docker ç¯å¢ƒè¯´æ˜

å½“æ‚¨çš„æ•°æ®åº“è¿è¡Œåœ¨ Docker å®¹å™¨ä¸­æ—¶ï¼Œéœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„éƒ¨ç½²æ–¹å¼ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨ Docker ç¯å¢ƒä¸­æ­£ç¡®éƒ¨ç½² AINO é¡¹ç›®ã€‚

## ğŸ³ Docker æ•°æ®åº“ä¿¡æ¯

æ ¹æ®æ‚¨æä¾›çš„ä¿¡æ¯ï¼š
- **å®¹å™¨åç§°**: `aino-postgres`
- **é•œåƒ**: `postgres:16`
- **ç«¯å£æ˜ å°„**: `0.0.0.0:5433->5432/tcp`
- **çŠ¶æ€**: `Up About an hour (healthy)`

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¿®æ”¹åçš„éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd AINO/AINO-server

# 2. è¿è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆå·²é€‚é…Dockerï¼‰
./deploy.sh
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆä½¿ç”¨ä¿®æ”¹åçš„è„šæœ¬ï¼‰
./scripts/setup-database.sh

# 3. å¯åŠ¨æœåŠ¡
npm start
```

### æ–¹æ³•ä¸‰ï¼šç›´æ¥ä½¿ç”¨ Node.js è„šæœ¬

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. ç›´æ¥è¿è¡Œåˆå§‹åŒ–è„šæœ¬
node scripts/init-database.js

# 3. å¯åŠ¨æœåŠ¡
npm start
```

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿è®¾ç½®æ­£ç¡®çš„ç¯å¢ƒå˜é‡ï¼š

```bash
# Docker ç¯å¢ƒé…ç½®
export DB_HOST=localhost
export DB_PORT=5433
export DB_USER=aino
export DB_PASSWORD=pass
export DB_NAME=aino
```

## ğŸ” æ•…éšœæ’é™¤

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥ Docker å®¹å™¨çŠ¶æ€ï¼š**
```bash
docker ps | grep postgres
```

**æ£€æŸ¥ç«¯å£æ˜ å°„ï¼š**
```bash
docker port aino-postgres
```

**æ£€æŸ¥å®¹å™¨æ—¥å¿—ï¼š**
```bash
docker logs aino-postgres
```

### 2. æƒé™é—®é¢˜

**æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·æƒé™ï¼š**
```bash
# è¿›å…¥å®¹å™¨
docker exec -it aino-postgres psql -U aino -d aino

# æ£€æŸ¥ç”¨æˆ·æƒé™
\du
```

### 3. ç½‘ç»œé—®é¢˜

**æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼š**
```bash
# æµ‹è¯•ç«¯å£è¿é€šæ€§
telnet localhost 5433

# æˆ–è€…ä½¿ç”¨ nc
nc -zv localhost 5433
```

## ğŸ“Š Docker ç¯å¢ƒç‰¹ç‚¹

### ä¼˜åŠ¿
- âœ… **éš”ç¦»æ€§**: æ•°æ®åº“è¿è¡Œåœ¨ç‹¬ç«‹å®¹å™¨ä¸­
- âœ… **å¯ç§»æ¤æ€§**: æ˜“äºåœ¨ä¸åŒç¯å¢ƒé—´è¿ç§»
- âœ… **ç‰ˆæœ¬æ§åˆ¶**: å¯ä»¥å›ºå®š PostgreSQL ç‰ˆæœ¬
- âœ… **èµ„æºç®¡ç†**: å¯ä»¥é™åˆ¶å®¹å™¨èµ„æºä½¿ç”¨

### æ³¨æ„äº‹é¡¹
- âš ï¸ **ç«¯å£æ˜ å°„**: ç¡®ä¿ç«¯å£æ˜ å°„æ­£ç¡®
- âš ï¸ **æ•°æ®æŒä¹…åŒ–**: ç¡®ä¿æ•°æ®å·æ­£ç¡®æŒ‚è½½
- âš ï¸ **ç½‘ç»œé…ç½®**: ç¡®ä¿å®¹å™¨ç½‘ç»œé…ç½®æ­£ç¡®
- âš ï¸ **æƒé™è®¾ç½®**: ç¡®ä¿æ•°æ®åº“ç”¨æˆ·æƒé™è¶³å¤Ÿ

## ğŸ› ï¸ Docker å‘½ä»¤å‚è€ƒ

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
docker ps

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker ps -a

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs aino-postgres

# è¿›å…¥å®¹å™¨
docker exec -it aino-postgres bash

# é‡å¯å®¹å™¨
docker restart aino-postgres

# åœæ­¢å®¹å™¨
docker stop aino-postgres

# å¯åŠ¨å®¹å™¨
docker start aino-postgres
```

### æ•°æ®åº“æ“ä½œ
```bash
# è¿›å…¥ PostgreSQL
docker exec -it aino-postgres psql -U aino -d aino

# æ‰§è¡Œ SQL æ–‡ä»¶
docker exec -i aino-postgres psql -U aino -d aino < init.sql

# å¤‡ä»½æ•°æ®åº“
docker exec aino-postgres pg_dump -U aino aino > backup.sql

# æ¢å¤æ•°æ®åº“
docker exec -i aino-postgres psql -U aino -d aino < backup.sql
```

## ğŸ¯ éƒ¨ç½²éªŒè¯

éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯ä»¥ä¸‹å†…å®¹ï¼š

1. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿èƒ½å¤Ÿè¿æ¥åˆ° Docker ä¸­çš„æ•°æ®åº“
2. **è¡¨åˆ›å»º**: ç¡®ä¿æ‰€æœ‰è¡¨éƒ½æ­£ç¡®åˆ›å»º
3. **æœåŠ¡å¯åŠ¨**: ç¡®ä¿ AINO æœåŠ¡æ­£å¸¸å¯åŠ¨
4. **API æµ‹è¯•**: ç¡®ä¿ API æ¥å£æ­£å¸¸å·¥ä½œ

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:3007/health

# åº”è¯¥è¿”å›: ok
```

## ğŸ“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆéœ€è¦ä¿®æ”¹è„šæœ¬ï¼Ÿ
A: åŸå§‹è„šæœ¬ä½¿ç”¨ `psql` å‘½ä»¤ï¼Œä½†åœ¨ Docker ç¯å¢ƒä¸­ï¼ŒPostgreSQL å®¢æˆ·ç«¯å¯èƒ½æ²¡æœ‰å®‰è£…åœ¨ä¸»æœºä¸Šã€‚ä¿®æ”¹åçš„è„šæœ¬ä½¿ç”¨ Node.js è¿›è¡Œæ•°æ®åº“è¿æ¥ï¼Œæ›´åŠ çµæ´»ã€‚

### Q: ç«¯å£æ˜ å°„æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ
A: ç¡®ä¿ Docker å®¹å™¨çš„ 5432 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 5433 ç«¯å£ï¼Œè¿™æ · AINO æœåŠ¡æ‰èƒ½è¿æ¥åˆ°æ•°æ®åº“ã€‚

### Q: å¦‚ä½•å¤‡ä»½ Docker æ•°æ®åº“ï¼Ÿ
A: ä½¿ç”¨ `docker exec` å‘½ä»¤æ‰§è¡Œ `pg_dump` è¿›è¡Œå¤‡ä»½ï¼Œæˆ–è€…å¤‡ä»½æ•´ä¸ªæ•°æ®å·ã€‚

---

**ğŸ‰ ç°åœ¨æ‚¨å¯ä»¥åœ¨ Docker ç¯å¢ƒä¸­æˆåŠŸéƒ¨ç½² AINO é¡¹ç›®äº†ï¼**
